<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="最新の技術トレンド、プログラミング、ソフトウェア開発、ツールのレビュー、プロジェクト管理等についての考察をお届け"/><meta property="og:url" content="https://blog.raisex.jp/articles/r7kw0wbuvv697hh5u5cbvsw3"/><meta property="og:title" content="レイズクロスTechBlog | さいたま市大宮区システム会社raisex運営"/><meta property="og:description" content="最新の技術トレンド、プログラミング、ソフトウェア開発、ツールのレビュー、プロジェクト管理等についての考察をお届け"/><meta property="og:image" content="https://blog.raisex.jphttps://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_25_68f5cc6f84.png"/><meta property="og:type" content="article"/><meta name="twitter:card" content="summary_large_image"/><title>【データモデリング】論理テーブル設計のチュートリアル<!-- --> | レイズクロス Tech Blog</title><meta name="next-head-count" content="11"/><link rel="preload" href="/_next/static/css/7d757bdfdfb985a7.css" as="style"/><link rel="stylesheet" href="/_next/static/css/7d757bdfdfb985a7.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-2c547fd4592db0a6.js" defer=""></script><script src="/_next/static/chunks/framework-e952fed463eb8e34.js" defer=""></script><script src="/_next/static/chunks/main-72cf801a60c05482.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b6737859a806843a.js" defer=""></script><script src="/_next/static/chunks/a2bf56a3-f921f321ae1e0e8d.js" defer=""></script><script src="/_next/static/chunks/61-43a5fb199f2ef164.js" defer=""></script><script src="/_next/static/chunks/257-c12ad0b16790f4c5.js" defer=""></script><script src="/_next/static/chunks/pages/articles/%5Bid%5D-c5730984a51dce88.js" defer=""></script><script src="/_next/static/QFbkZlg1wljFeRkEGmC7O/_buildManifest.js" defer=""></script><script src="/_next/static/QFbkZlg1wljFeRkEGmC7O/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="max-w-[1024px] mx-auto px-4"><header class="sticky top-0 z-20 bg-white border-b border-gray-200 h-12 flex items-center justify-between px-4"><a class="text-blue-600 no-underline hover:text-gray-600 text-lg font-bold" href="/">📋 レイズクロス Tech Blog</a><div class="flex gap-3"><a href="https://twitter.com/share" target="_blank" rel="noopener noreferrer"><img src="/icons/x.svg" alt="Share on X" class="h-7 w-7"/></a><a href="https://www.facebook.com/sharer/sharer.php" target="_blank" rel="noopener noreferrer"><img src="/icons/facebook.svg" alt="Share on Facebook" class="h-7 w-7"/></a><a href="https://social-plugins.line.me/lineit/share" target="_blank" rel="noopener noreferrer"><img src="/icons/line.svg" alt="Share on LINE" class="h-7 w-7"/></a></div></header><article class="prose prose-slate max-w-none pt-6"><h1 class="text-3xl font-bold border-b pb-2">【データモデリング】論理テーブル設計のチュートリアル</h1><div class="text-sm text-gray-500 mb-4">投稿更新日: <!-- -->2025/6/6 9:02:21</div><div class="flex flex-wrap gap-2 mb-4"><span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded-full">#<!-- -->Database</span><span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded-full">#<!-- -->Tutorial</span></div><div class="w-full flex justify-center mb-6"><img src="https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_25_68f5cc6f84.png" alt="サムネイル" class="w-full max-w-[800px] h-auto rounded"/></div><p>データモデリングにおいて、エンティティ抽出とER図の作成が完了したら、次のステップとして論理テーブル設計を行います。本記事では、ECサイトを題材にして論理テーブル設計の手順を詳しく解説します。</p>
<h2>1. シナリオの確認</h2>
<p>ECサイトにおける主要な機能を整理します。</p>
<ul>
<li><strong>商品一覧の表示</strong></li>
<li><strong>カートへの追加・削除</strong></li>
<li><strong>注文処理</strong></li>
<li><strong>決済処理</strong></li>
</ul>
<p>この機能をもとに、エンティティ抽出とER図を作成しました。これを基に論理テーブル設計を進めます。</p>
<h2>2. 論理テーブル設計の手順</h2>
<h3>2.1 テーブル定義（エンティティ → テーブル化）</h3>
<p>エンティティをそのままテーブルとして定義し、データの構造を明確にします。多対多の関係がある場合は、中間テーブルを作成します。</p>
<h3>2.2 主キー・外部キー・制約の設定</h3>
<ul>
<li><strong>主キー（Primary Key, PK）</strong>
<ul>
<li>サロゲートキー（自動採番IDなど）またはナチュラルキー（業務上意味を持つID）を選択</li>
</ul>
</li>
<li><strong>外部キー（Foreign Key, FK）</strong>
<ul>
<li>リレーションの参照整合性を担保</li>
</ul>
</li>
<li><strong>制約（Constraints）</strong>
<ul>
<li><code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">UNIQUE</code>, <code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">CHECK</code>, <code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">NOT NULL</code> などの制約を適用</li>
</ul>
</li>
</ul>
<h3>2.3 正規化の徹底と非正規化判断</h3>
<ul>
<li>基本は <strong>第3正規形</strong>（3NF）を適用</li>
<li><strong>性能要件</strong> に応じて部分的に非正規化</li>
<li><strong>正規化のステップ</strong>
<ul>
<li><strong>第1正規形（1NF）</strong>: 繰り返し要素を排除し、各列に単一値のみを格納</li>
<li><strong>第2正規形（2NF）</strong>: 1NFを満たし、部分関数従属を排除（主キーに完全依存する）</li>
<li><strong>第3正規形（3NF）</strong>: 2NFを満たし、推移的関数従属を排除（主キー以外の列が他の非キー属性に依存しない）</li>
</ul>
</li>
</ul>
<h3>2.4 論理レベルでのデータ型選定</h3>
<ul>
<li>製品依存を避け、抽象的なデータ型を選択
<ul>
<li><code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">VARCHAR</code>, <code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">INTEGER</code>, <code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">DATE</code>, <code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">DECIMAL</code> など</li>
</ul>
</li>
</ul>
<h2>3. 論理テーブル定義の例</h2>
<h3>3.1 User（ユーザー）</h3>



































<table class="border border-gray-400 w-full text-sm my-4 whitespace-pre-wrap table-fixed"><thead class="bg-cyan-100 text-black"><tr><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">カラム名</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">データ型</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">制約</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">説明</th></tr></thead><tbody><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">user_id</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">INTEGER</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">PK, 自動採番</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">ユーザーの一意識別子</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">username</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">VARCHAR(255)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">NOT NULL</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">ユーザー名</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">email</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">VARCHAR(255)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">UNIQUE, NOT NULL</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">メールアドレス（ナチュラルキー）</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">password</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">VARCHAR(255)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">NOT NULL</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">パスワード</td></tr></tbody></table>
<h3>3.2 Product（商品）</h3>









































<table class="border border-gray-400 w-full text-sm my-4 whitespace-pre-wrap table-fixed"><thead class="bg-cyan-100 text-black"><tr><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">カラム名</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">データ型</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">制約</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">説明</th></tr></thead><tbody><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">product_id</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">INTEGER</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">PK, 自動採番</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">商品の一意識別子</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">product_code</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">VARCHAR(100)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">UNIQUE, NOT NULL</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">商品コード（ナチュラルキー）</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">name</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">VARCHAR(255)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">NOT NULL</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">商品名</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">price</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">DECIMAL(10,2)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">NOT NULL</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">価格</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">stock</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">INTEGER</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">NOT NULL</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">在庫数</td></tr></tbody></table>
<h3>3.3 Cart（カート）</h3>





























<table class="border border-gray-400 w-full text-sm my-4 whitespace-pre-wrap table-fixed"><thead class="bg-cyan-100 text-black"><tr><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">カラム名</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">データ型</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">制約</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">説明</th></tr></thead><tbody><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">cart_id</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">INTEGER</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">PK, 自動採番</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">カートの一意識別子</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">user_id</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">INTEGER</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">FK (User)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">カート所有者</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">created_at</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">DATE</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">NOT NULL</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">カート作成日時</td></tr></tbody></table>
<h3>3.4 CartItem（カート内商品）</h3>





























<table class="border border-gray-400 w-full text-sm my-4 whitespace-pre-wrap table-fixed"><thead class="bg-cyan-100 text-black"><tr><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">カラム名</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">データ型</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">制約</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">説明</th></tr></thead><tbody><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">cart_id</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">INTEGER</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">PK, FK (Cart)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">カートの識別子</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">product_id</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">INTEGER</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">PK, FK (Product)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">カート内の商品</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">quantity</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">INTEGER</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">NOT NULL</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">商品の個数</td></tr></tbody></table>
<h3>3.5 Order（注文）</h3>









































<table class="border border-gray-400 w-full text-sm my-4 whitespace-pre-wrap table-fixed"><thead class="bg-cyan-100 text-black"><tr><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">カラム名</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">データ型</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">制約</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">説明</th></tr></thead><tbody><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">order_id</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">INTEGER</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">PK, 自動採番</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">注文の一意識別子</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">user_id</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">INTEGER</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">FK (User)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">注文したユーザー</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">total_price</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">DECIMAL(10,2)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">NOT NULL</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">合計金額</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">status</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">VARCHAR(50)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">NOT NULL</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">注文ステータス（例: 確定, 発送済み）</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">order_date</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">DATE</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">NOT NULL</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">注文日時</td></tr></tbody></table>
<h3>3.6 OrderItem（注文内商品）</h3>





























<table class="border border-gray-400 w-full text-sm my-4 whitespace-pre-wrap table-fixed"><thead class="bg-cyan-100 text-black"><tr><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">カラム名</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">データ型</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">制約</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">説明</th></tr></thead><tbody><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">order_id</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">INTEGER</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">PK, FK (Order)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">注文の識別子</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">product_id</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">INTEGER</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">PK, FK (Product)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">注文内の商品</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">quantity</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">INTEGER</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">NOT NULL</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">商品の個数</td></tr></tbody></table>
<h3>3.7 Payment（決済）</h3>









































<table class="border border-gray-400 w-full text-sm my-4 whitespace-pre-wrap table-fixed"><thead class="bg-cyan-100 text-black"><tr><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">カラム名</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">データ型</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">制約</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">説明</th></tr></thead><tbody><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">payment_id</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">INTEGER</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">PK, 自動採番</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">決済の一意識別子</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">order_id</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">INTEGER</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">FK (Order)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">関連する注文</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">method</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">VARCHAR(50)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">NOT NULL</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">決済方法（クレジットカード, 銀行振込など）</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">status</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">VARCHAR(50)</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">NOT NULL</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">決済ステータス（成功, 失敗など）</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">payment_date</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">DATE</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">NOT NULL</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">決済日時</td></tr></tbody></table>
<h2>3. 論理テーブル設計後のER図</h2>
<p>以下のER図は、論理テーブル設計を反映したものです。</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-mermaid" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(286, 60%, 67%)">erDiagram</span><span>
</span><span>  User </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span>    INTEGER user_id
<!-- -->    VARCHAR username
<!-- -->    VARCHAR email
<!-- -->    VARCHAR password
<span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span>  Product </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span>    INTEGER product_id
<!-- -->    VARCHAR product_code
<!-- -->    VARCHAR name
<!-- -->    DECIMAL price
<!-- -->    INTEGER stock
<span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span>  Cart </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span>    INTEGER cart_id
<!-- -->    INTEGER user_id
<!-- -->    DATE created_at
<span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span>  CartItem </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span>    INTEGER cart_id
<!-- -->    INTEGER product_id
<!-- -->    INTEGER quantity
<span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span>  Order </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span>    INTEGER order_id
<!-- -->    INTEGER user_id
<!-- -->    DECIMAL total_price
<!-- -->    VARCHAR status
<!-- -->    DATE order_date
<span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span>  OrderItem </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span>    INTEGER order_id
<!-- -->    INTEGER product_id
<!-- -->    INTEGER quantity
<span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span>  Payment </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span>    INTEGER payment_id
<!-- -->    INTEGER order_id
<!-- -->    VARCHAR method
<!-- -->    VARCHAR status
<!-- -->    DATE payment_date
<span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span>
<span>  User </span><span class="token arrow" style="color:hsl(207, 82%, 66%)">||--o{</span><span> Cart </span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> owns
</span><span>  User </span><span class="token arrow" style="color:hsl(207, 82%, 66%)">||--o{</span><span> Order </span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> places
</span><span>  Cart </span><span class="token arrow" style="color:hsl(207, 82%, 66%)">||--o{</span><span> CartItem </span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> contains
</span><span>  CartItem </span><span class="token arrow" style="color:hsl(207, 82%, 66%)">||--||</span><span> Product </span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> includes
</span><span>  Order </span><span class="token arrow" style="color:hsl(207, 82%, 66%)">||--o{</span><span> OrderItem </span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> contains
</span><span>  OrderItem </span><span class="token arrow" style="color:hsl(207, 82%, 66%)">||--||</span><span> Product </span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> includes
</span><span>  Order </span><span class="token arrow" style="color:hsl(207, 82%, 66%)">||--o{</span><span> Payment </span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> processes</span></code></pre></div></pre>
<h2>4. まとめ</h2>
<p>本記事では、ECサイトを題材に論理テーブル設計の手順を解説しました。</p>
<ol>
<li>エンティティをテーブル化し、リレーションを定義</li>
<li>主キー・外部キー・制約を適切に設定</li>
<li>第3正規形を基本にしつつ、性能要件に応じて非正規化を検討</li>
<li>正規化の基本概念（1NF, 2NF, 3NF）を説明</li>
<li>抽象的なデータ型を選定し、製品依存を避ける</li>
<li>ER図で論理テーブルの構造を視覚化</li>
</ol>
<p>この設計をもとに、次は物理データベース設計を進め、最適なインデックスやパーティショニングの適用を検討していきましょう！</p>
<hr/><div class="text-center mt-8"><a class="inline-block bg-gray-800 text-white no-underline px-4 py-2 rounded hover:bg-gray-700" href="/">← 記事一覧に戻る</a></div><div class="my-12 text-center"><p class="font-bold text-gray-800">合同会社raisexでは一緒に働く仲間を募集中です。</p><p class="text-sm text-gray-600 mb-4">ご興味のある方は以下の採用情報をご確認ください。</p><div class="flex justify-center"><div class="engage-recruit-widget" data-height="300" data-width="500" data-url="https://en-gage.net/raisex_jobs/widget/?banner=1"></div></div></div></article></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"id":273,"documentId":"r7kw0wbuvv697hh5u5cbvsw3","title":"【データモデリング】論理テーブル設計のチュートリアル","content":"データモデリングにおいて、エンティティ抽出とER図の作成が完了したら、次のステップとして論理テーブル設計を行います。本記事では、ECサイトを題材にして論理テーブル設計の手順を詳しく解説します。\n\n## 1. シナリオの確認\n\nECサイトにおける主要な機能を整理します。\n\n- **商品一覧の表示**\n- **カートへの追加・削除**\n- **注文処理**\n- **決済処理**\n\nこの機能をもとに、エンティティ抽出とER図を作成しました。これを基に論理テーブル設計を進めます。\n\n## 2. 論理テーブル設計の手順\n\n### 2.1 テーブル定義（エンティティ → テーブル化）\n\nエンティティをそのままテーブルとして定義し、データの構造を明確にします。多対多の関係がある場合は、中間テーブルを作成します。\n\n### 2.2 主キー・外部キー・制約の設定\n\n- **主キー（Primary Key, PK）**\n    - サロゲートキー（自動採番IDなど）またはナチュラルキー（業務上意味を持つID）を選択\n- **外部キー（Foreign Key, FK）**\n    - リレーションの参照整合性を担保\n- **制約（Constraints）**\n    - `UNIQUE`, `CHECK`, `NOT NULL` などの制約を適用\n\n### 2.3 正規化の徹底と非正規化判断\n\n- 基本は **第3正規形**（3NF）を適用\n- **性能要件** に応じて部分的に非正規化\n- **正規化のステップ**\n    - **第1正規形（1NF）**: 繰り返し要素を排除し、各列に単一値のみを格納\n    - **第2正規形（2NF）**: 1NFを満たし、部分関数従属を排除（主キーに完全依存する）\n    - **第3正規形（3NF）**: 2NFを満たし、推移的関数従属を排除（主キー以外の列が他の非キー属性に依存しない）\n\n### 2.4 論理レベルでのデータ型選定\n\n- 製品依存を避け、抽象的なデータ型を選択\n    - `VARCHAR`, `INTEGER`, `DATE`, `DECIMAL` など\n\n## 3. 論理テーブル定義の例\n\n### 3.1 User（ユーザー）\n\n| カラム名 | データ型 | 制約 | 説明 |\n| --- | --- | --- | --- |\n| user_id | INTEGER | PK, 自動採番 | ユーザーの一意識別子 |\n| username | VARCHAR(255) | NOT NULL | ユーザー名 |\n| email | VARCHAR(255) | UNIQUE, NOT NULL | メールアドレス（ナチュラルキー） |\n| password | VARCHAR(255) | NOT NULL | パスワード |\n\n### 3.2 Product（商品）\n\n| カラム名 | データ型 | 制約 | 説明 |\n| --- | --- | --- | --- |\n| product_id | INTEGER | PK, 自動採番 | 商品の一意識別子 |\n| product_code | VARCHAR(100) | UNIQUE, NOT NULL | 商品コード（ナチュラルキー） |\n| name | VARCHAR(255) | NOT NULL | 商品名 |\n| price | DECIMAL(10,2) | NOT NULL | 価格 |\n| stock | INTEGER | NOT NULL | 在庫数 |\n\n### 3.3 Cart（カート）\n\n| カラム名 | データ型 | 制約 | 説明 |\n| --- | --- | --- | --- |\n| cart_id | INTEGER | PK, 自動採番 | カートの一意識別子 |\n| user_id | INTEGER | FK (User) | カート所有者 |\n| created_at | DATE | NOT NULL | カート作成日時 |\n\n### 3.4 CartItem（カート内商品）\n\n| カラム名 | データ型 | 制約 | 説明 |\n| --- | --- | --- | --- |\n| cart_id | INTEGER | PK, FK (Cart) | カートの識別子 |\n| product_id | INTEGER | PK, FK (Product) | カート内の商品 |\n| quantity | INTEGER | NOT NULL | 商品の個数 |\n\n### 3.5 Order（注文）\n\n| カラム名 | データ型 | 制約 | 説明 |\n| --- | --- | --- | --- |\n| order_id | INTEGER | PK, 自動採番 | 注文の一意識別子 |\n| user_id | INTEGER | FK (User) | 注文したユーザー |\n| total_price | DECIMAL(10,2) | NOT NULL | 合計金額 |\n| status | VARCHAR(50) | NOT NULL | 注文ステータス（例: 確定, 発送済み） |\n| order_date | DATE | NOT NULL | 注文日時 |\n\n### 3.6 OrderItem（注文内商品）\n\n| カラム名 | データ型 | 制約 | 説明 |\n| --- | --- | --- | --- |\n| order_id | INTEGER | PK, FK (Order) | 注文の識別子 |\n| product_id | INTEGER | PK, FK (Product) | 注文内の商品 |\n| quantity | INTEGER | NOT NULL | 商品の個数 |\n\n### 3.7 Payment（決済）\n\n| カラム名 | データ型 | 制約 | 説明 |\n| --- | --- | --- | --- |\n| payment_id | INTEGER | PK, 自動採番 | 決済の一意識別子 |\n| order_id | INTEGER | FK (Order) | 関連する注文 |\n| method | VARCHAR(50) | NOT NULL | 決済方法（クレジットカード, 銀行振込など） |\n| status | VARCHAR(50) | NOT NULL | 決済ステータス（成功, 失敗など） |\n| payment_date | DATE | NOT NULL | 決済日時 |\n\n## 3. 論理テーブル設計後のER図\n\n以下のER図は、論理テーブル設計を反映したものです。\n\n```mermaid\nerDiagram\n  User {\n    INTEGER user_id\n    VARCHAR username\n    VARCHAR email\n    VARCHAR password\n  }\n  Product {\n    INTEGER product_id\n    VARCHAR product_code\n    VARCHAR name\n    DECIMAL price\n    INTEGER stock\n  }\n  Cart {\n    INTEGER cart_id\n    INTEGER user_id\n    DATE created_at\n  }\n  CartItem {\n    INTEGER cart_id\n    INTEGER product_id\n    INTEGER quantity\n  }\n  Order {\n    INTEGER order_id\n    INTEGER user_id\n    DECIMAL total_price\n    VARCHAR status\n    DATE order_date\n  }\n  OrderItem {\n    INTEGER order_id\n    INTEGER product_id\n    INTEGER quantity\n  }\n  Payment {\n    INTEGER payment_id\n    INTEGER order_id\n    VARCHAR method\n    VARCHAR status\n    DATE payment_date\n  }\n\n  User ||--o{ Cart : owns\n  User ||--o{ Order : places\n  Cart ||--o{ CartItem : contains\n  CartItem ||--|| Product : includes\n  Order ||--o{ OrderItem : contains\n  OrderItem ||--|| Product : includes\n  Order ||--o{ Payment : processes\n```\n\n## 4. まとめ\n\n本記事では、ECサイトを題材に論理テーブル設計の手順を解説しました。\n\n1. エンティティをテーブル化し、リレーションを定義\n2. 主キー・外部キー・制約を適切に設定\n3. 第3正規形を基本にしつつ、性能要件に応じて非正規化を検討\n4. 正規化の基本概念（1NF, 2NF, 3NF）を説明\n5. 抽象的なデータ型を選定し、製品依存を避ける\n6. ER図で論理テーブルの構造を視覚化\n\nこの設計をもとに、次は物理データベース設計を進め、最適なインデックスやパーティショニングの適用を検討していきましょう！\n\n---\n\n","createdAt":"2025-05-19T08:50:58.558Z","updatedAt":"2025-06-06T00:02:21.907Z","publishedAt":"2025-06-06T00:02:21.915Z","docId":"and3z1mk64o9z87wvqv7t3u4","tags":[{"id":6,"documentId":"bnetm5oe2jokv3u2ib1nibia","createdAt":"2025-05-19T09:45:00.761Z","updatedAt":"2025-05-19T09:45:00.761Z","publishedAt":"2025-05-19T09:45:00.769Z","name":"Database"},{"id":4,"documentId":"zc573y83cxbfql2umdwbhot9","createdAt":"2025-05-19T09:44:33.028Z","updatedAt":"2025-05-19T09:44:33.028Z","publishedAt":"2025-05-19T09:44:33.035Z","name":"Tutorial"}],"thumbnail":[{"id":29,"documentId":"hzayd21g8ituh08aqguk86f0","name":"20250513-25.png","alternativeText":null,"caption":null,"width":1503,"height":844,"formats":{"thumbnail":{"name":"thumbnail_20250513-25.png","hash":"thumbnail_20250513_25_68f5cc6f84","ext":".png","mime":"image/png","path":null,"width":245,"height":138,"size":12.73,"sizeInBytes":12733,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/thumbnail_20250513_25_68f5cc6f84.png"},"medium":{"name":"medium_20250513-25.png","hash":"medium_20250513_25_68f5cc6f84","ext":".png","mime":"image/png","path":null,"width":750,"height":421,"size":47.88,"sizeInBytes":47876,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_25_68f5cc6f84.png"},"small":{"name":"small_20250513-25.png","hash":"small_20250513_25_68f5cc6f84","ext":".png","mime":"image/png","path":null,"width":500,"height":281,"size":28.81,"sizeInBytes":28809,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/small_20250513_25_68f5cc6f84.png"},"large":{"name":"large_20250513-25.png","hash":"large_20250513_25_68f5cc6f84","ext":".png","mime":"image/png","path":null,"width":1000,"height":562,"size":65.65,"sizeInBytes":65654,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/large_20250513_25_68f5cc6f84.png"}},"hash":"20250513_25_68f5cc6f84","ext":".png","mime":"image/png","size":19.21,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/20250513_25_68f5cc6f84.png","previewUrl":null,"provider":"@strapi/provider-upload-aws-s3","provider_metadata":null,"createdAt":"2025-05-20T07:54:49.087Z","updatedAt":"2025-05-20T07:54:49.087Z","publishedAt":"2025-05-20T07:54:49.088Z"}]}},"__N_SSG":true},"page":"/articles/[id]","query":{"id":"r7kw0wbuvv697hh5u5cbvsw3"},"buildId":"QFbkZlg1wljFeRkEGmC7O","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>