<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>【PDF操作比較】PyMuPDFでPDFからテキストも表も簡単抽出<!-- --> | レイズクロス Tech Blog</title><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/7d757bdfdfb985a7.css" as="style"/><link rel="stylesheet" href="/_next/static/css/7d757bdfdfb985a7.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-2c547fd4592db0a6.js" defer=""></script><script src="/_next/static/chunks/framework-e952fed463eb8e34.js" defer=""></script><script src="/_next/static/chunks/main-db60732262e3da6e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b6737859a806843a.js" defer=""></script><script src="/_next/static/chunks/a2bf56a3-f921f321ae1e0e8d.js" defer=""></script><script src="/_next/static/chunks/61-92d26e53a2a7fcf5.js" defer=""></script><script src="/_next/static/chunks/257-c12ad0b16790f4c5.js" defer=""></script><script src="/_next/static/chunks/pages/articles/%5Bid%5D-7cfc7284c2566c9d.js" defer=""></script><script src="/_next/static/QTcQf_D8J2NMGF1e92-0w/_buildManifest.js" defer=""></script><script src="/_next/static/QTcQf_D8J2NMGF1e92-0w/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="max-w-[1024px] mx-auto px-4"><header class="sticky top-0 z-20 bg-white border-b border-gray-200 h-12 flex items-center justify-between px-4"><a class="text-blue-600 no-underline hover:text-gray-600 text-lg font-bold" href="/">📋 レイズクロス Tech Blog</a><div class="flex gap-3"><a href="https://twitter.com/share" target="_blank" rel="noopener noreferrer"><img src="/icons/x.svg" alt="Share on X" class="h-7 w-7"/></a><a href="https://www.facebook.com/sharer/sharer.php" target="_blank" rel="noopener noreferrer"><img src="/icons/facebook.svg" alt="Share on Facebook" class="h-7 w-7"/></a><a href="https://social-plugins.line.me/lineit/share" target="_blank" rel="noopener noreferrer"><img src="/icons/line.svg" alt="Share on LINE" class="h-7 w-7"/></a></div></header><article class="prose prose-slate max-w-none pt-6"><h1 class="text-3xl font-bold border-b pb-2">【PDF操作比較】PyMuPDFでPDFからテキストも表も簡単抽出</h1><div class="text-sm text-gray-500 mb-4">投稿更新日: <!-- -->2025/6/2 11:49:26</div><div class="flex flex-wrap gap-2 mb-4"><span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded-full">#<!-- -->LLM</span><span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded-full">#<!-- -->Python</span><span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded-full">#<!-- -->RAG</span></div><div class="w-full flex justify-center mb-6"><img src="https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_19_a28071974b.png" alt="サムネイル" class="w-full max-w-[800px] h-auto rounded"/></div><p>PDF操作ライブラリの比較検討記事の続きです。</p>
<p>前回までの記事はこちら</p>
<ul>
<li><a href="https://my-blog-frontend-jectjhrfq-raisex-hyamasakis-projects.vercel.app/articles/i402h46inwv9yzy1mgah101z" target="_self" class="text-blue-600 underline">【PDF操作比較】pypdfでPDFからテキスト抽出を行う方法</a></li>
<li><a href="https://my-blog-frontend-jectjhrfq-raisex-hyamasakis-projects.vercel.app/articles/g8z0fn5ap0si8r1iheg2iwd7" target="_self" class="text-blue-600 underline">【PDF操作比較】pdfplumberでPDFからテキストも表も簡単抽出</a></li>
</ul>
<p>PDFデータの前処理において、<strong>テキスト抽出</strong>と<strong>表形式データの抽出</strong>は非常に重要な作業です。今回紹介するのは、Pythonライブラリの<strong>PyMuPDF</strong>を活用したPDFデータの抽出方法です。PyMuPDFは、速度と柔軟性に優れたPDF操作ライブラリで、シンプルなAPI設計が特徴です。</p>
<hr/>
<h1>PyMuPDFの特徴</h1>
<ul>
<li><strong>軽量で高速</strong>: 大量のPDFファイルでも効率よく処理できます。</li>
<li><strong>多機能</strong>: テキスト抽出だけでなく、表や画像の抽出、PDF編集も可能。</li>
<li><strong>RAGやLLMに最適</strong>: 抽出結果を後続処理に簡単に利用できます。</li>
</ul>
<p>今回は、基本的なテキスト抽出と表抽出にフォーカスして解説します。</p>
<hr/>
<h1>PyMuPDFを使ったテキスト抽出</h1>
<h2>PyMuPDFのインストール</h2>
<p>以下のコマンドを実行してインストールします：</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-bash" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>pip </span><span class="token" style="color:hsl(207, 82%, 66%)">install</span><span> PyMuPDF</span></code></pre></div></pre>
<h2>サンプルコード</h2>
<p>以下のコードは、PDFからテキストを抽出し、ファイルに保存するシンプルな例です。</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> os
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> pymupdf
</span>
<span>input_pdf_path </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;./docs/読み取りテスト文書.pdf&quot;</span><span>
</span><span>output_txt_path </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;./output/text_extract.txt&quot;</span><span>
</span>
<span></span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">extract_text_with_pymupdf</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>input_path</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> output_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">try</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>        doc </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> pymupdf</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token" style="color:hsl(95, 38%, 62%)">open</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>input_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>        extracted_text </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;&quot;</span><span>
</span>
<span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">for</span><span> page </span><span class="token" style="color:hsl(286, 60%, 67%)">in</span><span> doc</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>            extracted_text </span><span class="token" style="color:hsl(207, 82%, 66%)">+=</span><span> page</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>get_text</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>        output_dir </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> os</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>path</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>dirname</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">not</span><span> os</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>path</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>exists</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_dir</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>            os</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>makedirs</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_dir</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">with</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">open</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_path</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;w&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> encoding</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;utf-8&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> f</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>            f</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>write</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>extracted_text</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token string-interpolation" style="color:hsl(95, 38%, 62%)">f&quot;テキストが正常に抽出され、以下のファイルに保存されました: </span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">{</span><span class="token string-interpolation interpolation">output_path</span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">}</span><span class="token string-interpolation" style="color:hsl(95, 38%, 62%)">&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">except</span><span> Exception </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> e</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token string-interpolation" style="color:hsl(95, 38%, 62%)">f&quot;エラーが発生しました: </span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">}</span><span class="token string-interpolation" style="color:hsl(95, 38%, 62%)">&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># 実行</span><span>
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> __name__ </span><span class="token" style="color:hsl(207, 82%, 66%)">==</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;__main__&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>    extract_text_with_pymupdf</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>input_pdf_path</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> output_txt_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre></div></pre>
<h2>実行方法</h2>
<p>上記コードを <code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">text_extract.py</code> として保存し、以下のコマンドで実行します：</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-bash" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>python3 text_extract.py</span></code></pre></div></pre>
<h2>結果</h2>
<p>実行すると、PDFのテキストが抽出され、以下のような結果が得られます：</p>
<pre><code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit"> 
 
1 
 
文書のタイトル 
見出し1 
 
見出し1-1 
ここには見出し1-1 の本文が入ります。ここには見出し1-1 の本文が入ります。ここには見
出し1-1 の本文が入ります。ここには見出し1-1 の本文が入ります。ここには見出し1-1 の
本文が入ります。ここには見出し1-1 の本文が入ります。ここには見出し1-1 の本文が入り
ます。ここには見出し1-1 の本文が入ります。ここには見出し1-1 の本文が入ります。ここ
には見出し1-1 の本文が入ります。ここには見出し1-1 の本文が入ります。 
 
見出し1-2 
ここには見出し1-2 の本文が入ります。ここには見出し1-2 の本文が入ります。ここには見
出し1-2 の本文が入ります。ここには見出し1-2 の本文が入ります。ここには見出し1-2 の
本文が入ります。ここには見出し1-2 の本文が入ります。ここには見出し1-2 の本文が入り
ます。 
ここには見出し1-2 の本文が入ります。ここには見出し1-2 の本文が入ります。 
 
 
2 
 
ここには見出し1-2 の本文が入ります。ここには見出し1-2 の本文が入ります。 
 
見出し1-3 
ここには見出し1-3 の本文が入ります。ここには見出し1-3 の本文が入ります。 
ここには見出し1-3 の本文が入ります。ここには見出し1-3 の本文が入ります。ここには見
出し1-3 の本文が入ります。ここには見出し1-3 の本文が入ります。ここには見出し1-3 の
本文が入ります。ここには見出し1-3 の本文が入ります。 
 
 
 
 
3 
 
列1 
列2 
列3 
列4 
行1 列1 の本文が入
ります。 
行1 列2 の本文が入
ります。 
行1 列3 の本文が入
ります。 
行1 列4 の本文が入
ります。 
行2 列1 の本文が入
ります。 
行2 列2 の本文が入
ります。 
行2 列3 の本文が入
ります。 
行2 列4 の本文が入
ります。 
行3 列1 の本文が入
ります。 
行3 列2 の本文が入
ります。 
行3 列3 の本文が入
ります。 
行3 列4 の本文が入
ります。 
表1. 表1 の名前が入ります。 
 
列1 
列2 
列3 
列4 
行1 列1 の本文が
入ります。 
行1 列2 の本文が
入ります。 
行1 列3 の本文が
入ります。 
行1 列4 の本文が
入ります。 
行2 列1 の本文が
入ります。 
行2 列2 の本文が
入ります。 
行2 列3 の本文が
入ります。 
行2 列4 の本文が
入ります。 
表2. 表2 の名前が入ります。 
見出し1-4 
ここには見出し1-4 の本文が入ります。ここには見出し1-4 の本文が入ります。ここには見
 
 
4 
 
出し1-4 の本文が入ります。ここには見出し1-4 の本文が入ります。ここには見出し1-4 の
本文が入ります。ここには見出し1-4 の本文が入ります。ここには見出し1-4 の本文が入り
ます。ここには見出し1-4 の本文が入ります。ここには見出し1-4 の本文が入ります。ここ
には見出し1-4 の本文が入ります。 
 
 
 
 
5 
 
見出し2 
 
(項目名が入ります) 
見出し2-1 ここには見出し2-1 の本文が入ります。ここには見出し2-1 の本文が入り
ます。ここには見出し2-1 の本文が入ります。ここには見出し2-1 の本文が入ります。ここ
には見出し2-1 の本文が入ります。ここには見出し2-1 の本文が入ります。ここには見出し
2-1 の本文が入ります。ここには見出し2-1 の本文が入ります。 
 
(項目名が入ります) 
見出し2-2 ここには見出し2-2 の本文が入ります。ここには見出し2-2 の本文が入り
ます。ここには見出し2-2 の本文が入ります。ここには見出し2-2 の本文が入ります。ここ
には見出し2-2 の本文が入ります。ここには見出し2-2 の本文が入ります。ここには見出し
2-2 の本文が入ります。 
ここには見出し2-2 の本文が入ります。 
 
以上 
 
 

</code></pre>
<hr/>
<h1>PyMuPDFを使った表抽出</h1>
<p>PyMuPDFでは、PDF内の表をリスト形式で抽出することができます。</p>
<h2>サンプルコード</h2>
<p>以下は、表を抽出してMarkdown形式で保存する例です：</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> pymupdf
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> os
</span>
<span>input_pdf_path </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;./docs/読み取りテスト文書.pdf&quot;</span><span>
</span><span>output_txt_path </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;./output/table_extract.txt&quot;</span><span>
</span>
<span></span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">extract_tables_with_pymupdf</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>input_path</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> output_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>    doc </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> pymupdf</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token" style="color:hsl(95, 38%, 62%)">open</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>input_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">for</span><span> i</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> page </span><span class="token" style="color:hsl(286, 60%, 67%)">in</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">enumerate</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>doc</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> start</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>        tabs </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> page</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>find_tables</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token string-interpolation" style="color:hsl(95, 38%, 62%)">f&quot;</span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">{</span><span class="token string-interpolation interpolation" style="color:hsl(95, 38%, 62%)">len</span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string-interpolation interpolation">tabs</span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">.</span><span class="token string-interpolation interpolation">tables</span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">)</span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">}</span><span class="token string-interpolation" style="color:hsl(95, 38%, 62%)"> found on </span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">{</span><span class="token string-interpolation interpolation">page</span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">}</span><span class="token string-interpolation" style="color:hsl(95, 38%, 62%)">&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> tabs</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>tables</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>            </span><span class="token" style="color:hsl(286, 60%, 67%)">for</span><span> table </span><span class="token" style="color:hsl(286, 60%, 67%)">in</span><span> tabs</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>tables</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>                extracted_text </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> table</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>to_markdown</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>                output_dir </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> os</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>path</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>dirname</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>                </span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">not</span><span> os</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>path</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>exists</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_dir</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>                    os</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>makedirs</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_dir</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>                </span><span class="token" style="color:hsl(286, 60%, 67%)">with</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">open</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_path</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;w&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> encoding</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;utf-8&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> f</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>                    f</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>write</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>extracted_text</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span></span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> __name__ </span><span class="token" style="color:hsl(207, 82%, 66%)">==</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;__main__&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>    extract_tables_with_pymupdf</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>input_pdf_path</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> output_txt_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre></div></pre>
<h2>実行方法</h2>
<p>コードを <code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">table_extract.py</code> として保存し、以下のコマンドで実行します：</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-bash" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>python3 table_extract.py</span></code></pre></div></pre>
<h2>結果</h2>
<p>以下のようなMarkdown形式のテーブルが出力されます：</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-markdown" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token table table-header-row" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-header-row table-header" style="color:hsl(355, 65%, 65%)">列1</span><span class="token table table-header-row" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-header-row table-header" style="color:hsl(355, 65%, 65%)">列2</span><span class="token table table-header-row" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-header-row table-header" style="color:hsl(355, 65%, 65%)">列3</span><span class="token table table-header-row" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-header-row table-header" style="color:hsl(355, 65%, 65%)">列4</span><span class="token table table-header-row" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-header-row">
</span><span class="token table table-header-row"></span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">---</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">---</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">---</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">---</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-line">
</span><span class="token table table-line"></span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行 1 列 1 の本文が 入ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行1 列 2 の本文が 入ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行1 列 3 の本文が 入ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行1 列 4 の本文が 入ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows">
</span><span class="token table table-data-rows"></span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行 2 列 1 の本文が 入ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行2 列 2 の本文が 入ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行2 列 3 の本文が 入ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行2 列 4 の本文が 入ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows">
</span><span class="token table table-data-rows"></span></code></pre></div></pre>
<hr/>
<h1>PyMuPDF4LLMで効率化</h1>
<p>LLMやRAG向けに特化したPyMuPDFの派生ライブラリ<strong>PyMuPDF4LLM</strong>も非常に便利です。これを使えば、PDF全体をMarkdown形式で抽出できます。</p>
<h2>インストール</h2>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-bash" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>pip </span><span class="token" style="color:hsl(207, 82%, 66%)">install</span><span> pymupdf4llm</span></code></pre></div></pre>
<h2>サンプルコード</h2>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> pymupdf4llm
</span>
<span>input_pdf_path </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;./docs/読み取りテスト文書.pdf&quot;</span><span>
</span><span>output_txt_path </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;./output/md_extract.md&quot;</span><span>
</span>
<span></span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">extract_md_with_pymupdf4llm</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>input_path</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> output_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>    md_text </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> pymupdf4llm</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>to_markdown</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>input_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">with</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">open</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_path</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;w&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> encoding</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;utf-8&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> f</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>        f</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>write</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>md_text</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span></span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> __name__ </span><span class="token" style="color:hsl(207, 82%, 66%)">==</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;__main__&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>    extract_md_with_pymupdf4llm</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>input_pdf_path</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> output_txt_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span></code></pre></div></pre>
<h2>実行方法</h2>
<p>以下のコマンドで実行します：</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-bash" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>python3 md_extract.py</span></code></pre></div></pre>
<h2>結果</h2>
<p>PDFの内容が見出しやテーブル付きでMarkdown形式に変換されます：</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-markdown" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(220, 14%, 71%)">#</span><span class="token" style="color:hsl(355, 65%, 65%)"> 文書のタイトル</span><span>
</span>
<span></span><span class="token" style="color:hsl(220, 14%, 71%)">##</span><span class="token" style="color:hsl(355, 65%, 65%)"> 見出し1</span><span>
</span>
<span></span><span class="token" style="color:hsl(220, 14%, 71%)">###</span><span class="token" style="color:hsl(355, 65%, 65%)"> 見出し1-1</span><span>
</span>
<!-- -->ここには見出し1-1 の本文が入ります。ここには見出し1-1 の本文が入ります。ここには見
<!-- -->
<!-- -->出し1-1 の本文が入ります。ここには見出し1-1 の本文が入ります。ここには見出し1-1 の
<!-- -->
<!-- -->本文が入ります。ここには見出し1-1 の本文が入ります。ここには見出し1-1 の本文が入り
<!-- -->
<!-- -->ます。ここには見出し1-1 の本文が入ります。ここには見出し1-1 の本文が入ります。ここ
<!-- -->
<!-- -->には見出し1-1 の本文が入ります。ここには見出し1-1 の本文が入ります。
<!-- -->
<span></span><span class="token" style="color:hsl(220, 14%, 71%)">###</span><span class="token" style="color:hsl(355, 65%, 65%)"> 見出し1-2</span><span>
</span>
<!-- -->ここには見出し1-2 の本文が入ります。ここには見出し1-2 の本文が入ります。ここには見
<!-- -->
<!-- -->出し1-2 の本文が入ります。ここには見出し1-2 の本文が入ります。ここには見出し1-2 の
<!-- -->
<!-- -->本文が入ります。ここには見出し1-2 の本文が入ります。ここには見出し1-2 の本文が入り
<!-- -->
<!-- -->ます。
<!-- -->
<!-- -->ここには見出し1-2 の本文が入ります。ここには見出し1-2 の本文が入ります。
<!-- -->
<!-- -->1
<!-- -->
<span></span><span class="token" style="color:hsl(220, 14%, 71%)">-----</span><span>
</span>
<!-- -->ここには見出し1-2 の本文が入ります。ここには見出し1-2 の本文が入ります。
<!-- -->
<span></span><span class="token" style="color:hsl(220, 14%, 71%)">###</span><span class="token" style="color:hsl(355, 65%, 65%)"> 見出し1-3</span><span>
</span>
<!-- -->ここには見出し1-3 の本文が入ります。ここには見出し1-3 の本文が入ります。
<!-- -->
<!-- -->ここには見出し1-3 の本文が入ります。ここには見出し1-3 の本文が入ります。ここには見
<!-- -->
<!-- -->出し1-3 の本文が入ります。ここには見出し1-3 の本文が入ります。ここには見出し1-3 の
<!-- -->
<!-- -->本文が入ります。ここには見出し1-3 の本文が入ります。
<!-- -->
<!-- -->2
<!-- -->
<span></span><span class="token" style="color:hsl(220, 14%, 71%)">-----</span><span>
</span>
<span></span><span class="token table table-header-row" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-header-row table-header" style="color:hsl(355, 65%, 65%)">列1</span><span class="token table table-header-row" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-header-row table-header" style="color:hsl(355, 65%, 65%)">列2</span><span class="token table table-header-row" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-header-row table-header" style="color:hsl(355, 65%, 65%)">列3</span><span class="token table table-header-row" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-header-row table-header" style="color:hsl(355, 65%, 65%)">列4</span><span class="token table table-header-row" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-header-row">
</span><span class="token table table-header-row"></span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">---</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">---</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">---</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">---</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-line">
</span><span class="token table table-line"></span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行1 列1 の本文が入 ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行1 列2 の本文が入 ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行1 列3 の本文が入 ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行1 列4 の本文が入 ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows">
</span><span class="token table table-data-rows"></span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行2 列1 の本文が入 ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行2 列2 の本文が入 ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行2 列3 の本文が入 ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行2 列4 の本文が入 ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows">
</span><span class="token table table-data-rows"></span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行3 列1 の本文が入 ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行3 列2 の本文が入 ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行3 列3 の本文が入 ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行3 列4 の本文が入 ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows">
</span><span class="token table table-data-rows"></span><span>
</span>表1. 表1 の名前が入ります。
<!-- -->
<!-- -->列1 列2 列3 列4
<!-- -->
<!-- -->行1 列1 の本文が 行1 列2 の本文が 行1 列3 の本文が 行1 列4 の本文が
<!-- -->
<!-- -->入ります。 入ります。 入ります。 入ります。
<!-- -->
<!-- -->行2 列1 の本文が 行2 列2 の本文が 行2 列3 の本文が 行2 列4 の本文が
<!-- -->
<!-- -->入ります。 入ります。 入ります。 入ります。
<!-- -->
<!-- -->表2. 表2 の名前が入ります。
<!-- -->
<span></span><span class="token" style="color:hsl(220, 14%, 71%)">###</span><span class="token" style="color:hsl(355, 65%, 65%)"> 見出し1-4</span><span>
</span>
<!-- -->ここには見出し1-4 の本文が入ります。ここには見出し1-4 の本文が入ります。ここには見
<!-- -->
<!-- -->3
<!-- -->
<span></span><span class="token table table-header-row" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-header-row table-header" style="color:hsl(355, 65%, 65%)">列1</span><span class="token table table-header-row" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-header-row table-header" style="color:hsl(355, 65%, 65%)">列2</span><span class="token table table-header-row" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-header-row table-header" style="color:hsl(355, 65%, 65%)">列3</span><span class="token table table-header-row" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-header-row table-header" style="color:hsl(355, 65%, 65%)">列4</span><span class="token table table-header-row" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-header-row">
</span><span class="token table table-header-row"></span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">---</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">---</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">---</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">---</span><span class="token table table-line" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-line">
</span><span class="token table table-line"></span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行 1 列 1 の本文が 入ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行1 列 2 の本文が 入ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行1 列 3 の本文が 入ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行1 列 4 の本文が 入ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows">
</span><span class="token table table-data-rows"></span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行 2 列 1 の本文が 入ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行2 列 2 の本文が 入ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行2 列 3 の本文が 入ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows table-data">行2 列 4 の本文が 入ります。</span><span class="token table table-data-rows" style="color:hsl(220, 14%, 71%)">|</span><span class="token table table-data-rows">
</span><span class="token table table-data-rows"></span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">-----</span><span>
</span>
<!-- -->出し1-4 の本文が入ります。ここには見出し1-4 の本文が入ります。ここには見出し1-4 の
<!-- -->
<!-- -->本文が入ります。ここには見出し1-4 の本文が入ります。ここには見出し1-4 の本文が入り
<!-- -->
<!-- -->ます。ここには見出し1-4 の本文が入ります。ここには見出し1-4 の本文が入ります。ここ
<!-- -->
<!-- -->には見出し1-4 の本文が入ります。
<!-- -->
<!-- -->4
<!-- -->
<span></span><span class="token" style="color:hsl(220, 14%, 71%)">-----</span><span>
</span>
<span></span><span class="token" style="color:hsl(220, 14%, 71%)">##</span><span class="token" style="color:hsl(355, 65%, 65%)"> 見出し2</span><span>
</span>
<!-- -->(項目名が入ります)
<!-- -->
<span></span><span class="token" style="color:hsl(220, 14%, 71%)">###</span><span class="token" style="color:hsl(355, 65%, 65%)"> 見出し2-1 ここには見出し2-1 の本文が入ります。ここには見出し2-1 の本文が入り</span><span>
</span>
<!-- -->ます。ここには見出し2-1 の本文が入ります。ここには見出し2-1 の本文が入ります。ここ
<!-- -->
<!-- -->には見出し2-1 の本文が入ります。ここには見出し2-1 の本文が入ります。ここには見出し
<!-- -->
<!-- -->2-1 の本文が入ります。ここには見出し2-1 の本文が入ります。
<!-- -->
<!-- -->(項目名が入ります)
<!-- -->
<span></span><span class="token" style="color:hsl(220, 14%, 71%)">###</span><span class="token" style="color:hsl(355, 65%, 65%)"> 見出し2-2 ここには見出し2-2 の本文が入ります。ここには見出し2-2 の本文が入り</span><span>
</span>
<!-- -->ます。ここには見出し2-2 の本文が入ります。ここには見出し2-2 の本文が入ります。ここ
<!-- -->
<!-- -->には見出し2-2 の本文が入ります。ここには見出し2-2 の本文が入ります。ここには見出し
<!-- -->
<!-- -->2-2 の本文が入ります。
<!-- -->
<!-- -->ここには見出し2-2 の本文が入ります。
<!-- -->
<!-- -->以上
<!-- -->
<!-- -->5
<!-- -->
<span></span><span class="token" style="color:hsl(220, 14%, 71%)">-----</span><span>
</span></code></pre></div></pre>
<hr/>
<h2>PyMuPDFのメリットと活用方法</h2>
<ul>
<li><strong>テキストと表を統合的に扱える</strong>。</li>
<li><strong>高速かつ効率的</strong>に処理可能。</li>
<li><strong>Markdown形式での出力</strong>に対応しており、RAGやLLMに最適。</li>
</ul>
<p>PyMuPDFを活用して、PDFデータの前処理を効率化し、プロジェクトの生産性を向上させましょう！</p>
<hr/><div class="text-center mt-8"><a class="inline-block bg-gray-800 text-white no-underline px-4 py-2 rounded hover:bg-gray-700" href="/">← 記事一覧に戻る</a></div><div class="my-12 text-center"><p class="font-bold text-gray-800">合同会社raisexでは一緒に働く仲間を募集中です。</p><p class="text-sm text-gray-600 mb-4">ご興味のある方は以下の採用情報をご確認ください。</p><div class="flex justify-center"><div class="engage-recruit-widget" data-height="300" data-width="500" data-url="https://en-gage.net/raisex_jobs/widget/?banner=1"></div></div></div></article></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"id":208,"documentId":"zpf2m4dks36ri1sxzpkhq91u","title":"【PDF操作比較】PyMuPDFでPDFからテキストも表も簡単抽出","content":"PDF操作ライブラリの比較検討記事の続きです。\n\n前回までの記事はこちら\n\n- [【PDF操作比較】pypdfでPDFからテキスト抽出を行う方法](https://my-blog-frontend-jectjhrfq-raisex-hyamasakis-projects.vercel.app/articles/i402h46inwv9yzy1mgah101z)\n- [【PDF操作比較】pdfplumberでPDFからテキストも表も簡単抽出](https://my-blog-frontend-jectjhrfq-raisex-hyamasakis-projects.vercel.app/articles/g8z0fn5ap0si8r1iheg2iwd7)\n\nPDFデータの前処理において、**テキスト抽出**と**表形式データの抽出**は非常に重要な作業です。今回紹介するのは、Pythonライブラリの**PyMuPDF**を活用したPDFデータの抽出方法です。PyMuPDFは、速度と柔軟性に優れたPDF操作ライブラリで、シンプルなAPI設計が特徴です。\n\n---\n\n# PyMuPDFの特徴\n\n- **軽量で高速**: 大量のPDFファイルでも効率よく処理できます。\n- **多機能**: テキスト抽出だけでなく、表や画像の抽出、PDF編集も可能。\n- **RAGやLLMに最適**: 抽出結果を後続処理に簡単に利用できます。\n\n今回は、基本的なテキスト抽出と表抽出にフォーカスして解説します。\n\n---\n\n# PyMuPDFを使ったテキスト抽出\n\n## PyMuPDFのインストール\n\n以下のコマンドを実行してインストールします：\n\n```bash\npip install PyMuPDF\n```\n\n## サンプルコード\n\n以下のコードは、PDFからテキストを抽出し、ファイルに保存するシンプルな例です。\n\n```python\nimport os\nimport pymupdf\n\ninput_pdf_path = \"./docs/読み取りテスト文書.pdf\"\noutput_txt_path = \"./output/text_extract.txt\"\n\ndef extract_text_with_pymupdf(input_path, output_path):\n    try:\n        doc = pymupdf.open(input_path)\n        extracted_text = \"\"\n\n        for page in doc:\n            extracted_text += page.get_text()\n\n        output_dir = os.path.dirname(output_path)\n        if not os.path.exists(output_dir):\n            os.makedirs(output_dir)\n\n        with open(output_path, \"w\", encoding=\"utf-8\") as f:\n            f.write(extracted_text)\n\n        print(f\"テキストが正常に抽出され、以下のファイルに保存されました: {output_path}\")\n    except Exception as e:\n        print(f\"エラーが発生しました: {e}\")\n\n# 実行\nif __name__ == \"__main__\":\n    extract_text_with_pymupdf(input_pdf_path, output_txt_path)\n```\n\n## 実行方法\n\n上記コードを `text_extract.py` として保存し、以下のコマンドで実行します：\n\n```bash\npython3 text_extract.py\n```\n\n## 結果\n\n実行すると、PDFのテキストが抽出され、以下のような結果が得られます：\n\n```\n \n \n1 \n \n文書のタイトル \n見出し1 \n \n見出し1-1 \nここには見出し1-1 の本文が入ります。ここには見出し1-1 の本文が入ります。ここには見\n出し1-1 の本文が入ります。ここには見出し1-1 の本文が入ります。ここには見出し1-1 の\n本文が入ります。ここには見出し1-1 の本文が入ります。ここには見出し1-1 の本文が入り\nます。ここには見出し1-1 の本文が入ります。ここには見出し1-1 の本文が入ります。ここ\nには見出し1-1 の本文が入ります。ここには見出し1-1 の本文が入ります。 \n \n見出し1-2 \nここには見出し1-2 の本文が入ります。ここには見出し1-2 の本文が入ります。ここには見\n出し1-2 の本文が入ります。ここには見出し1-2 の本文が入ります。ここには見出し1-2 の\n本文が入ります。ここには見出し1-2 の本文が入ります。ここには見出し1-2 の本文が入り\nます。 \nここには見出し1-2 の本文が入ります。ここには見出し1-2 の本文が入ります。 \n \n \n2 \n \nここには見出し1-2 の本文が入ります。ここには見出し1-2 の本文が入ります。 \n \n見出し1-3 \nここには見出し1-3 の本文が入ります。ここには見出し1-3 の本文が入ります。 \nここには見出し1-3 の本文が入ります。ここには見出し1-3 の本文が入ります。ここには見\n出し1-3 の本文が入ります。ここには見出し1-3 の本文が入ります。ここには見出し1-3 の\n本文が入ります。ここには見出し1-3 の本文が入ります。 \n \n \n \n \n3 \n \n列1 \n列2 \n列3 \n列4 \n行1 列1 の本文が入\nります。 \n行1 列2 の本文が入\nります。 \n行1 列3 の本文が入\nります。 \n行1 列4 の本文が入\nります。 \n行2 列1 の本文が入\nります。 \n行2 列2 の本文が入\nります。 \n行2 列3 の本文が入\nります。 \n行2 列4 の本文が入\nります。 \n行3 列1 の本文が入\nります。 \n行3 列2 の本文が入\nります。 \n行3 列3 の本文が入\nります。 \n行3 列4 の本文が入\nります。 \n表1. 表1 の名前が入ります。 \n \n列1 \n列2 \n列3 \n列4 \n行1 列1 の本文が\n入ります。 \n行1 列2 の本文が\n入ります。 \n行1 列3 の本文が\n入ります。 \n行1 列4 の本文が\n入ります。 \n行2 列1 の本文が\n入ります。 \n行2 列2 の本文が\n入ります。 \n行2 列3 の本文が\n入ります。 \n行2 列4 の本文が\n入ります。 \n表2. 表2 の名前が入ります。 \n見出し1-4 \nここには見出し1-4 の本文が入ります。ここには見出し1-4 の本文が入ります。ここには見\n \n \n4 \n \n出し1-4 の本文が入ります。ここには見出し1-4 の本文が入ります。ここには見出し1-4 の\n本文が入ります。ここには見出し1-4 の本文が入ります。ここには見出し1-4 の本文が入り\nます。ここには見出し1-4 の本文が入ります。ここには見出し1-4 の本文が入ります。ここ\nには見出し1-4 の本文が入ります。 \n \n \n \n \n5 \n \n見出し2 \n \n(項目名が入ります) \n見出し2-1 ここには見出し2-1 の本文が入ります。ここには見出し2-1 の本文が入り\nます。ここには見出し2-1 の本文が入ります。ここには見出し2-1 の本文が入ります。ここ\nには見出し2-1 の本文が入ります。ここには見出し2-1 の本文が入ります。ここには見出し\n2-1 の本文が入ります。ここには見出し2-1 の本文が入ります。 \n \n(項目名が入ります) \n見出し2-2 ここには見出し2-2 の本文が入ります。ここには見出し2-2 の本文が入り\nます。ここには見出し2-2 の本文が入ります。ここには見出し2-2 の本文が入ります。ここ\nには見出し2-2 の本文が入ります。ここには見出し2-2 の本文が入ります。ここには見出し\n2-2 の本文が入ります。 \nここには見出し2-2 の本文が入ります。 \n \n以上 \n \n \n\n```\n\n---\n\n# PyMuPDFを使った表抽出\n\nPyMuPDFでは、PDF内の表をリスト形式で抽出することができます。\n\n## サンプルコード\n\n以下は、表を抽出してMarkdown形式で保存する例です：\n\n```python\nimport pymupdf\nimport os\n\ninput_pdf_path = \"./docs/読み取りテスト文書.pdf\"\noutput_txt_path = \"./output/table_extract.txt\"\n\ndef extract_tables_with_pymupdf(input_path, output_path):\n    doc = pymupdf.open(input_path)\n    for i, page in enumerate(doc, start=1):\n        tabs = page.find_tables()\n        print(f\"{len(tabs.tables)} found on {page}\")\n        if tabs.tables:\n            for table in tabs.tables:\n                extracted_text = table.to_markdown()\n\n                output_dir = os.path.dirname(output_path)\n                if not os.path.exists(output_dir):\n                    os.makedirs(output_dir)\n\n                with open(output_path, \"w\", encoding=\"utf-8\") as f:\n                    f.write(extracted_text)\n\nif __name__ == \"__main__\":\n    extract_tables_with_pymupdf(input_pdf_path, output_txt_path)\n```\n\n## 実行方法\n\nコードを `table_extract.py` として保存し、以下のコマンドで実行します：\n\n```bash\npython3 table_extract.py\n```\n\n## 結果\n\n以下のようなMarkdown形式のテーブルが出力されます：\n\n```markdown\n|列1|列2|列3|列4|\n|---|---|---|---|\n|行 1 列 1 の本文が 入ります。|行1 列 2 の本文が 入ります。|行1 列 3 の本文が 入ります。|行1 列 4 の本文が 入ります。|\n|行 2 列 1 の本文が 入ります。|行2 列 2 の本文が 入ります。|行2 列 3 の本文が 入ります。|行2 列 4 の本文が 入ります。|\n\n```\n\n---\n\n# PyMuPDF4LLMで効率化\n\nLLMやRAG向けに特化したPyMuPDFの派生ライブラリ**PyMuPDF4LLM**も非常に便利です。これを使えば、PDF全体をMarkdown形式で抽出できます。\n\n## インストール\n\n```bash\npip install pymupdf4llm\n```\n\n## サンプルコード\n\n```python\nimport pymupdf4llm\n\ninput_pdf_path = \"./docs/読み取りテスト文書.pdf\"\noutput_txt_path = \"./output/md_extract.md\"\n\ndef extract_md_with_pymupdf4llm(input_path, output_path):\n    md_text = pymupdf4llm.to_markdown(input_path)\n    with open(output_path, \"w\", encoding=\"utf-8\") as f:\n        f.write(md_text)\n\nif __name__ == \"__main__\":\n    extract_md_with_pymupdf4llm(input_pdf_path, output_txt_path)\n\n```\n\n## 実行方法\n\n以下のコマンドで実行します：\n\n```bash\npython3 md_extract.py\n```\n\n## 結果\n\nPDFの内容が見出しやテーブル付きでMarkdown形式に変換されます：\n\n```markdown\n# 文書のタイトル\n\n## 見出し1\n\n### 見出し1-1\n\nここには見出し1-1 の本文が入ります。ここには見出し1-1 の本文が入ります。ここには見\n\n出し1-1 の本文が入ります。ここには見出し1-1 の本文が入ります。ここには見出し1-1 の\n\n本文が入ります。ここには見出し1-1 の本文が入ります。ここには見出し1-1 の本文が入り\n\nます。ここには見出し1-1 の本文が入ります。ここには見出し1-1 の本文が入ります。ここ\n\nには見出し1-1 の本文が入ります。ここには見出し1-1 の本文が入ります。\n\n### 見出し1-2\n\nここには見出し1-2 の本文が入ります。ここには見出し1-2 の本文が入ります。ここには見\n\n出し1-2 の本文が入ります。ここには見出し1-2 の本文が入ります。ここには見出し1-2 の\n\n本文が入ります。ここには見出し1-2 の本文が入ります。ここには見出し1-2 の本文が入り\n\nます。\n\nここには見出し1-2 の本文が入ります。ここには見出し1-2 の本文が入ります。\n\n1\n\n-----\n\nここには見出し1-2 の本文が入ります。ここには見出し1-2 の本文が入ります。\n\n### 見出し1-3\n\nここには見出し1-3 の本文が入ります。ここには見出し1-3 の本文が入ります。\n\nここには見出し1-3 の本文が入ります。ここには見出し1-3 の本文が入ります。ここには見\n\n出し1-3 の本文が入ります。ここには見出し1-3 の本文が入ります。ここには見出し1-3 の\n\n本文が入ります。ここには見出し1-3 の本文が入ります。\n\n2\n\n-----\n\n|列1|列2|列3|列4|\n|---|---|---|---|\n|行1 列1 の本文が入 ります。|行1 列2 の本文が入 ります。|行1 列3 の本文が入 ります。|行1 列4 の本文が入 ります。|\n|行2 列1 の本文が入 ります。|行2 列2 の本文が入 ります。|行2 列3 の本文が入 ります。|行2 列4 の本文が入 ります。|\n|行3 列1 の本文が入 ります。|行3 列2 の本文が入 ります。|行3 列3 の本文が入 ります。|行3 列4 の本文が入 ります。|\n\n表1. 表1 の名前が入ります。\n\n列1 列2 列3 列4\n\n行1 列1 の本文が 行1 列2 の本文が 行1 列3 の本文が 行1 列4 の本文が\n\n入ります。 入ります。 入ります。 入ります。\n\n行2 列1 の本文が 行2 列2 の本文が 行2 列3 の本文が 行2 列4 の本文が\n\n入ります。 入ります。 入ります。 入ります。\n\n表2. 表2 の名前が入ります。\n\n### 見出し1-4\n\nここには見出し1-4 の本文が入ります。ここには見出し1-4 の本文が入ります。ここには見\n\n3\n\n|列1|列2|列3|列4|\n|---|---|---|---|\n|行 1 列 1 の本文が 入ります。|行1 列 2 の本文が 入ります。|行1 列 3 の本文が 入ります。|行1 列 4 の本文が 入ります。|\n|行 2 列 1 の本文が 入ります。|行2 列 2 の本文が 入ります。|行2 列 3 の本文が 入ります。|行2 列 4 の本文が 入ります。|\n\n-----\n\n出し1-4 の本文が入ります。ここには見出し1-4 の本文が入ります。ここには見出し1-4 の\n\n本文が入ります。ここには見出し1-4 の本文が入ります。ここには見出し1-4 の本文が入り\n\nます。ここには見出し1-4 の本文が入ります。ここには見出し1-4 の本文が入ります。ここ\n\nには見出し1-4 の本文が入ります。\n\n4\n\n-----\n\n## 見出し2\n\n(項目名が入ります)\n\n### 見出し2-1 ここには見出し2-1 の本文が入ります。ここには見出し2-1 の本文が入り\n\nます。ここには見出し2-1 の本文が入ります。ここには見出し2-1 の本文が入ります。ここ\n\nには見出し2-1 の本文が入ります。ここには見出し2-1 の本文が入ります。ここには見出し\n\n2-1 の本文が入ります。ここには見出し2-1 の本文が入ります。\n\n(項目名が入ります)\n\n### 見出し2-2 ここには見出し2-2 の本文が入ります。ここには見出し2-2 の本文が入り\n\nます。ここには見出し2-2 の本文が入ります。ここには見出し2-2 の本文が入ります。ここ\n\nには見出し2-2 の本文が入ります。ここには見出し2-2 の本文が入ります。ここには見出し\n\n2-2 の本文が入ります。\n\nここには見出し2-2 の本文が入ります。\n\n以上\n\n5\n\n-----\n\n```\n\n---\n\n## PyMuPDFのメリットと活用方法\n\n- **テキストと表を統合的に扱える**。\n- **高速かつ効率的**に処理可能。\n- **Markdown形式での出力**に対応しており、RAGやLLMに最適。\n\nPyMuPDFを活用して、PDFデータの前処理を効率化し、プロジェクトの生産性を向上させましょう！\n\n---\n\n","createdAt":"2025-05-19T08:50:58.180Z","updatedAt":"2025-06-02T02:49:26.645Z","publishedAt":"2025-06-02T02:49:26.662Z","docId":"rk1h39ybmhc4dqtmxcavaw3w","tags":[{"id":20,"documentId":"fbllyhmskvu2l7wbg5dzpkri","createdAt":"2025-05-19T09:48:50.341Z","updatedAt":"2025-05-19T09:48:50.341Z","publishedAt":"2025-05-19T09:48:50.348Z","name":"LLM"},{"id":22,"documentId":"enpfq0z697dadtxijwpwwrsv","createdAt":"2025-05-19T09:49:17.862Z","updatedAt":"2025-05-19T09:49:17.862Z","publishedAt":"2025-05-19T09:49:17.870Z","name":"Python"},{"id":24,"documentId":"l1dya7wtq2ct0n1dxm41pl7j","createdAt":"2025-05-19T09:49:40.953Z","updatedAt":"2025-05-19T09:49:40.953Z","publishedAt":"2025-05-19T09:49:40.961Z","name":"RAG"}],"thumbnail":[{"id":23,"documentId":"lcfxgy80xu29o0ot2kt8p1ac","name":"20250513-19.png","alternativeText":null,"caption":null,"width":1504,"height":844,"formats":{"thumbnail":{"name":"thumbnail_20250513-19.png","hash":"thumbnail_20250513_19_a28071974b","ext":".png","mime":"image/png","path":null,"width":245,"height":137,"size":15.19,"sizeInBytes":15193,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/thumbnail_20250513_19_a28071974b.png"},"medium":{"name":"medium_20250513-19.png","hash":"medium_20250513_19_a28071974b","ext":".png","mime":"image/png","path":null,"width":750,"height":421,"size":57.89,"sizeInBytes":57886,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_19_a28071974b.png"},"small":{"name":"small_20250513-19.png","hash":"small_20250513_19_a28071974b","ext":".png","mime":"image/png","path":null,"width":500,"height":281,"size":36.56,"sizeInBytes":36563,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/small_20250513_19_a28071974b.png"},"large":{"name":"large_20250513-19.png","hash":"large_20250513_19_a28071974b","ext":".png","mime":"image/png","path":null,"width":1000,"height":561,"size":81.1,"sizeInBytes":81104,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/large_20250513_19_a28071974b.png"}},"hash":"20250513_19_a28071974b","ext":".png","mime":"image/png","size":22.9,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/20250513_19_a28071974b.png","previewUrl":null,"provider":"@strapi/provider-upload-aws-s3","provider_metadata":null,"createdAt":"2025-05-20T07:49:55.882Z","updatedAt":"2025-05-20T07:49:55.882Z","publishedAt":"2025-05-20T07:49:55.882Z"}]}},"__N_SSG":true},"page":"/articles/[id]","query":{"id":"zpf2m4dks36ri1sxzpkhq91u"},"buildId":"QTcQf_D8J2NMGF1e92-0w","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>