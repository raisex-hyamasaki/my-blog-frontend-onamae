<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="最新の技術トレンド、プログラミング、ソフトウェア開発、ツールのレビュー、プロジェクト管理等についての考察をお届け"/><meta property="og:url" content="https://blog.raisex.jp/articles/g8z0fn5ap0si8r1iheg2iwd7"/><meta property="og:title" content="レイズクロスTechBlog | さいたま市大宮区システム会社raisex運営"/><meta property="og:description" content="最新の技術トレンド、プログラミング、ソフトウェア開発、ツールのレビュー、プロジェクト管理等についての考察をお届け"/><meta property="og:image" content="https://blog.raisex.jphttps://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_18_7f8d875b8b.png"/><meta property="og:type" content="article"/><meta name="twitter:card" content="summary_large_image"/><title>【PDF操作比較】pdfplumberでPDFからテキストも表も簡単抽出<!-- --> | レイズクロス Tech Blog</title><meta name="next-head-count" content="11"/><link rel="preload" href="/_next/static/css/7d757bdfdfb985a7.css" as="style"/><link rel="stylesheet" href="/_next/static/css/7d757bdfdfb985a7.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-2c547fd4592db0a6.js" defer=""></script><script src="/_next/static/chunks/framework-e952fed463eb8e34.js" defer=""></script><script src="/_next/static/chunks/main-72cf801a60c05482.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b6737859a806843a.js" defer=""></script><script src="/_next/static/chunks/a2bf56a3-f921f321ae1e0e8d.js" defer=""></script><script src="/_next/static/chunks/61-43a5fb199f2ef164.js" defer=""></script><script src="/_next/static/chunks/257-c12ad0b16790f4c5.js" defer=""></script><script src="/_next/static/chunks/pages/articles/%5Bid%5D-29223262aecac2b3.js" defer=""></script><script src="/_next/static/_saeqYYuk801MD-5UWwzK/_buildManifest.js" defer=""></script><script src="/_next/static/_saeqYYuk801MD-5UWwzK/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="max-w-[1024px] mx-auto px-4"><header class="sticky top-0 z-20 bg-white border-b border-gray-200 h-12 flex items-center justify-between px-4"><a class="text-blue-600 no-underline hover:text-gray-600 text-lg font-bold" href="/">📋 レイズクロス Tech Blog</a><div class="flex gap-3"><a href="https://twitter.com/share" target="_blank" rel="noopener noreferrer"><img src="/icons/x.svg" alt="Share on X" class="h-7 w-7"/></a><a href="https://www.facebook.com/sharer/sharer.php" target="_blank" rel="noopener noreferrer"><img src="/icons/facebook.svg" alt="Share on Facebook" class="h-7 w-7"/></a><a href="https://social-plugins.line.me/lineit/share" target="_blank" rel="noopener noreferrer"><img src="/icons/line.svg" alt="Share on LINE" class="h-7 w-7"/></a></div></header><article class="prose prose-slate max-w-none pt-6"><h1 class="text-3xl font-bold border-b pb-2">【PDF操作比較】pdfplumberでPDFからテキストも表も簡単抽出</h1><div class="text-sm text-gray-500 mb-4">投稿更新日: <!-- -->2025/6/6 8:59:05</div><div class="flex flex-wrap gap-2 mb-4"><span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded-full">#<!-- -->LLM</span><span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded-full">#<!-- -->Python</span><span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded-full">#<!-- -->RAG</span><span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded-full">#<!-- -->生成AI</span></div><div class="w-full flex justify-center mb-6"><img src="https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_18_7f8d875b8b.png" alt="サムネイル" class="w-full max-w-[800px] h-auto rounded"/></div><p>PDF操作ライブラリの比較検討記事の続きです。</p>
<p>前回の記事はこちら</p>
<ul>
<li><a href="https://blog.raisex.jp/articles/i402h46inwv9yzy1mgah101z" target="_blank" rel="noopener noreferrer" class="text-blue-600 underline">【PDF操作比較】pypdfでPDFからテキスト抽出を行う方法</a></li>
</ul>
<p>PDFファイルから<strong>テキスト</strong>や<strong>表データ</strong>を抽出する作業は、データ前処理において重要な役割を果たします。特に、<strong>LLM（大規模言語モデル）のチューニング</strong>や<strong>RAG（Retrieval-Augmented Generation）の文書前処理</strong>では、PDFデータの扱いやすさが効率を左右します。</p>
<p>今回ご紹介するのは、Pythonライブラリの<strong>pdfplumber</strong>を使ったテキストと表データの抽出方法です。このライブラリは、テキストだけでなく複雑な表形式データにも対応しており、非常に便利です！</p>
<hr/>
<h2>pdfplumberの概要</h2>
<p><strong>pdfplumber</strong>は、PDFから以下のようなデータを簡単に抽出できるライブラリです：</p>
<ul>
<li>テキスト</li>
<li>表（表形式データ）</li>
<li>画像や図</li>
</ul>
<hr/>
<h1>pdfplumberの基本的な使い方</h1>
<p>以下では、<strong>テキスト抽出</strong>と<strong>表抽出</strong>の方法をそれぞれ紹介します。</p>
<p>PDFは前回の記事で使ったものと同じものを使います。</p>
<hr/>
<h2>テキストの抽出</h2>
<h3>必要な準備</h3>
<p>まずは、pdfplumberをインストールします。</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-bash" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>pip </span><span class="token" style="color:hsl(207, 82%, 66%)">install</span><span> pdfplumber</span></code></pre></div></pre>
<h3>テキスト抽出のコード例</h3>
<p>以下のコードを使えば、PDFからテキストを抽出してファイルに保存できます。</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> os
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> pdfplumber
</span>
<span>input_pdf_path </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;./docs/読み取りテスト文書.pdf&quot;</span><span>
</span><span>output_txt_path </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;./output/text_extract.txt&quot;</span><span>
</span>
<span></span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">extract_text_with_pdfplumber</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>input_path</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> output_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">try</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">with</span><span> pdfplumber</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token" style="color:hsl(95, 38%, 62%)">open</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>input_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> pdf</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>            extracted_text </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;&quot;</span><span>
</span>
<span>            </span><span class="token" style="color:hsl(286, 60%, 67%)">for</span><span> page </span><span class="token" style="color:hsl(286, 60%, 67%)">in</span><span> pdf</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>pages</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>                extracted_text </span><span class="token" style="color:hsl(207, 82%, 66%)">+=</span><span> page</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>extract_text</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>        output_dir </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> os</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>path</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>dirname</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">not</span><span> os</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>path</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>exists</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_dir</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>            os</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>makedirs</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_dir</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">with</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">open</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_path</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;w&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> encoding</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;utf-8&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> f</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>            f</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>write</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>extracted_text</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token string-interpolation" style="color:hsl(95, 38%, 62%)">f&quot;テキストが正常に抽出され、以下のファイルに保存されました: </span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">{</span><span class="token string-interpolation interpolation">output_path</span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">}</span><span class="token string-interpolation" style="color:hsl(95, 38%, 62%)">&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">except</span><span> Exception </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> e</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token string-interpolation" style="color:hsl(95, 38%, 62%)">f&quot;エラーが発生しました: </span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">}</span><span class="token string-interpolation" style="color:hsl(95, 38%, 62%)">&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span></span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> __name__ </span><span class="token" style="color:hsl(207, 82%, 66%)">==</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;__main__&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>    extract_text_with_pdfplumber</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>input_pdf_path</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> output_txt_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span></code></pre></div></pre>
<h3>実行方法</h3>
<p>コードを <code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">text_extract.py</code> というファイル名で保存し、以下のコマンドで実行します：</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-bash" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>python3 text_extract.py</span></code></pre></div></pre>
<h3>結果</h3>
<p>実際にPDFから抽出したテキストは以下のようになります：</p>
<pre><code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">文書のタイトル
見出し 1
見出し 1-1
ここには見出し1-1の本文が入ります。ここには見出し1-1の本文が入ります。ここには見
出し1-1の本文が入ります。ここには見出し1-1の本文が入ります。ここには見出し1-1の
本文が入ります。ここには見出し1-1の本文が入ります。ここには見出し1-1の本文が入り
ます。ここには見出し1-1の本文が入ります。ここには見出し1-1の本文が入ります。ここ
には見出し1-1の本文が入ります。ここには見出し1-1の本文が入ります。
見出し 1-2
ここには見出し1-2の本文が入ります。ここには見出し1-2の本文が入ります。ここには見
出し1-2の本文が入ります。ここには見出し1-2の本文が入ります。ここには見出し1-2の
本文が入ります。ここには見出し1-2の本文が入ります。ここには見出し1-2の本文が入り
ます。
ここには見出し1-2の本文が入ります。ここには見出し1-2の本文が入ります。
1ここには見出し1-2の本文が入ります。ここには見出し1-2の本文が入ります。
見出し 1-3
ここには見出し1-3の本文が入ります。ここには見出し1-3の本文が入ります。
ここには見出し1-3の本文が入ります。ここには見出し1-3の本文が入ります。ここには見
出し1-3の本文が入ります。ここには見出し1-3の本文が入ります。ここには見出し1-3の
本文が入ります。ここには見出し1-3の本文が入ります。
2列1 列2 列3 列4
行1列1の本文が入 行1列2の本文が入 行1列3の本文が入 行1列4の本文が入
ります。 ります。 ります。 ります。
行2列1の本文が入 行2列2の本文が入 行2列3の本文が入 行2列4の本文が入
ります。 ります。 ります。 ります。
行3列1の本文が入 行3列2の本文が入 行3列3の本文が入 行3列4の本文が入
ります。 ります。 ります。 ります。
表1. 表1の名前が入ります。
列1 列2 列3 列4
行 1列 1の本文が 行1列 2の本文が 行1列 3の本文が 行1列 4の本文が
入ります。 入ります。 入ります。 入ります。
行 2列 1の本文が 行2列 2の本文が 行2列 3の本文が 行2列 4の本文が
入ります。 入ります。 入ります。 入ります。
表2. 表2の名前が入ります。
見出し 1-4
ここには見出し1-4の本文が入ります。ここには見出し1-4の本文が入ります。ここには見
3出し1-4の本文が入ります。ここには見出し1-4の本文が入ります。ここには見出し1-4の
本文が入ります。ここには見出し1-4の本文が入ります。ここには見出し1-4の本文が入り
ます。ここには見出し1-4の本文が入ります。ここには見出し1-4の本文が入ります。ここ
には見出し1-4の本文が入ります。
4見出し 2
(項目名が入ります)
見出し 2-1
ここには見出し2-1の本文が入ります。ここには見出し2-1の本文が入り
ます。ここには見出し2-1の本文が入ります。ここには見出し2-1の本文が入ります。ここ
には見出し2-1の本文が入ります。ここには見出し2-1の本文が入ります。ここには見出し
2-1の本文が入ります。ここには見出し2-1の本文が入ります。
(項目名が入ります)
見出し 2-2
ここには見出し2-2の本文が入ります。ここには見出し2-2の本文が入り
ます。ここには見出し2-2の本文が入ります。ここには見出し2-2の本文が入ります。ここ
には見出し2-2の本文が入ります。ここには見出し2-2の本文が入ります。ここには見出し
2-2の本文が入ります。
ここには見出し2-2の本文が入ります。
以上
5
</code></pre>
<p>このように、PDFのレイアウトに沿ったテキストが抽出されます。</p>
<hr/>
<h2>表の抽出</h2>
<p>pdfplumberでは表の内容をリスト形式で取り出せるため、後続処理が簡単です。</p>
<h3>表抽出のコード例</h3>
<p>次のコードは、PDFから表を抽出し、タブ区切り形式でファイルに保存する例です。</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> os
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> pdfplumber
</span>
<span>input_pdf_path </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;./docs/読み取りテスト文書.pdf&quot;</span><span>
</span><span>output_txt_path </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;./output/table_extract.txt&quot;</span><span>
</span>
<span></span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">extract_tables_with_pdfplumber</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>input_path</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> output_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">try</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">with</span><span> pdfplumber</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token" style="color:hsl(95, 38%, 62%)">open</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>input_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> pdf</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>            extracted_table </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;&quot;</span><span>
</span>
<span>            </span><span class="token" style="color:hsl(286, 60%, 67%)">for</span><span> i</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> page </span><span class="token" style="color:hsl(286, 60%, 67%)">in</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">enumerate</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>pdf</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>pages</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> start</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>                tables </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> page</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>extract_tables</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>                </span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> tables</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>                    </span><span class="token" style="color:hsl(286, 60%, 67%)">for</span><span> table </span><span class="token" style="color:hsl(286, 60%, 67%)">in</span><span> tables</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>                        </span><span class="token" style="color:hsl(286, 60%, 67%)">for</span><span> row </span><span class="token" style="color:hsl(286, 60%, 67%)">in</span><span> table</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>                            extracted_table </span><span class="token" style="color:hsl(207, 82%, 66%)">+=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;\t&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>join</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>row</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">+</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;\n&quot;</span><span>
</span><span>                        extracted_table </span><span class="token" style="color:hsl(207, 82%, 66%)">+=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;\n&quot;</span><span>  </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># テーブル間に空行を追加</span><span>
</span>
<span>        output_dir </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> os</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>path</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>dirname</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">not</span><span> os</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>path</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>exists</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_dir</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>            os</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>makedirs</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_dir</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">with</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">open</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_path</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;w&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> encoding</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;utf-8&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> f</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>            f</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>write</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>extracted_table</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token string-interpolation" style="color:hsl(95, 38%, 62%)">f&quot;テーブルデータが正常に抽出され、以下のファイルに保存されました: </span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">{</span><span class="token string-interpolation interpolation">output_path</span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">}</span><span class="token string-interpolation" style="color:hsl(95, 38%, 62%)">&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">except</span><span> Exception </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> e</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token string-interpolation" style="color:hsl(95, 38%, 62%)">f&quot;エラーが発生しました: </span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation" style="color:hsl(220, 14%, 71%)">}</span><span class="token string-interpolation" style="color:hsl(95, 38%, 62%)">&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># 実行</span><span>
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> __name__ </span><span class="token" style="color:hsl(207, 82%, 66%)">==</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;__main__&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>    extract_tables_with_pdfplumber</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>input_pdf_path</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> output_txt_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span></code></pre></div></pre>
<h3>実行方法</h3>
<p>コードを <code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">table_extract.py</code> として保存し、以下のコマンドで実行します：</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-bash" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>python3 table_extract.py</span></code></pre></div></pre>
<h3>結果</h3>
<p>抽出した表の例：</p>
<pre><code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">列1	列2	列3	列4
行1列1の本文が入
ります。	行1列2の本文が入
ります。	行1列3の本文が入
ります。	行1列4の本文が入
ります。
行2列1の本文が入
ります。	行2列2の本文が入
ります。	行2列3の本文が入
ります。	行2列4の本文が入
ります。
行3列1の本文が入
ります。	行3列2の本文が入
ります。	行3列3の本文が入
ります。	行3列4の本文が入
ります。

列1	列2	列3	列4
行 1列 1の本文が
入ります。	行1列 2の本文が
入ります。	行1列 3の本文が
入ります。	行1列 4の本文が
入ります。
行 2列 1の本文が
入ります。	行2列 2の本文が
入ります。	行2列 3の本文が
入ります。	行2列 4の本文が
入ります。

</code></pre>
<p>このように、PDFの表が整った形式で抽出されます。</p>
<hr/>
<h3>3. 抽出データの後処理</h3>
<p>pdfplumberで抽出した表データは、リスト形式で取得されます。このデータをさらに加工する場合、<strong>pandas</strong>を活用すると便利です。</p>
<h3>PandasでのExcel出力例</h3>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> pandas </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> pd
</span>
<span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># 抽出した表データをリスト形式にする（例）</span><span>
</span><span>data </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span>
</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;列1&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;列2&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;列3&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;列4&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;行1列1&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;行1列2&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;行1列3&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;行1列4&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;行2列1&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;行2列2&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;行2列3&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;行2列4&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span>
<span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># データフレームとして作成</span><span>
</span><span>df </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> pd</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>DataFrame</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>data</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> columns</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>data</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">0</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># Excelファイルとして保存</span><span>
</span><span>df</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>to_excel</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;./output/extracted_table.xlsx&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> index</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">False</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;表データがExcelファイルに保存されました！&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span></code></pre></div></pre>
<hr/>
<h2>pdfplumberの活用ポイント</h2>
<ol>
<li><strong>テキスト抽出に加え、表データも簡単に処理可能</strong>。</li>
<li><strong>後続処理との組み合わせが簡単</strong>（例：pandasでExcel出力）。</li>
<li><strong>複雑なレイアウトでも精度高く抽出</strong>。</li>
</ol>
<hr/>
<p>これで、PDFからテキストや表を抽出する方法はバッチリです！ぜひ、pdfplumberを使って、プロジェクトの効率化に役立ててください。</p>
<p>次はPyMuPDFのライブラリについても調べていきます。更新をお楽しみに！</p>
<hr/><div class="text-center mt-8"><a class="inline-block bg-gray-800 text-white no-underline px-4 py-2 rounded hover:bg-gray-700" href="/">← 記事一覧に戻る</a></div><div class="my-12 text-center"><p class="font-bold text-gray-800">合同会社raisexでは一緒に働く仲間を募集中です。</p><p class="text-sm text-gray-600 mb-4">ご興味のある方は以下の採用情報をご確認ください。</p><div class="flex justify-center"><div class="engage-recruit-widget" data-height="300" data-width="500" data-url="https://en-gage.net/raisex_jobs/widget/?banner=1"></div></div></div></article></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"id":266,"documentId":"g8z0fn5ap0si8r1iheg2iwd7","title":"【PDF操作比較】pdfplumberでPDFからテキストも表も簡単抽出","content":"PDF操作ライブラリの比較検討記事の続きです。\n\n前回の記事はこちら\n\n- [【PDF操作比較】pypdfでPDFからテキスト抽出を行う方法](https://blog.raisex.jp/articles/i402h46inwv9yzy1mgah101z)\n\nPDFファイルから**テキスト**や**表データ**を抽出する作業は、データ前処理において重要な役割を果たします。特に、**LLM（大規模言語モデル）のチューニング**や**RAG（Retrieval-Augmented Generation）の文書前処理**では、PDFデータの扱いやすさが効率を左右します。\n\n今回ご紹介するのは、Pythonライブラリの**pdfplumber**を使ったテキストと表データの抽出方法です。このライブラリは、テキストだけでなく複雑な表形式データにも対応しており、非常に便利です！\n\n---\n\n## pdfplumberの概要\n\n**pdfplumber**は、PDFから以下のようなデータを簡単に抽出できるライブラリです：\n\n- テキスト\n- 表（表形式データ）\n- 画像や図\n\n---\n\n# pdfplumberの基本的な使い方\n\n以下では、**テキスト抽出**と**表抽出**の方法をそれぞれ紹介します。\n\nPDFは前回の記事で使ったものと同じものを使います。\n\n---\n\n## テキストの抽出\n\n### 必要な準備\n\nまずは、pdfplumberをインストールします。\n\n```bash\npip install pdfplumber\n```\n\n### テキスト抽出のコード例\n\n以下のコードを使えば、PDFからテキストを抽出してファイルに保存できます。\n\n```python\nimport os\nimport pdfplumber\n\ninput_pdf_path = \"./docs/読み取りテスト文書.pdf\"\noutput_txt_path = \"./output/text_extract.txt\"\n\ndef extract_text_with_pdfplumber(input_path, output_path):\n    try:\n        with pdfplumber.open(input_path) as pdf:\n            extracted_text = \"\"\n\n            for page in pdf.pages:\n                extracted_text += page.extract_text()\n\n        output_dir = os.path.dirname(output_path)\n        if not os.path.exists(output_dir):\n            os.makedirs(output_dir)\n\n        with open(output_path, \"w\", encoding=\"utf-8\") as f:\n            f.write(extracted_text)\n\n        print(f\"テキストが正常に抽出され、以下のファイルに保存されました: {output_path}\")\n    except Exception as e:\n        print(f\"エラーが発生しました: {e}\")\n\nif __name__ == \"__main__\":\n    extract_text_with_pdfplumber(input_pdf_path, output_txt_path)\n\n```\n\n### 実行方法\n\nコードを `text_extract.py` というファイル名で保存し、以下のコマンドで実行します：\n\n```bash\npython3 text_extract.py\n```\n\n### 結果\n\n実際にPDFから抽出したテキストは以下のようになります：\n\n```\n文書のタイトル\n見出し 1\n見出し 1-1\nここには見出し1-1の本文が入ります。ここには見出し1-1の本文が入ります。ここには見\n出し1-1の本文が入ります。ここには見出し1-1の本文が入ります。ここには見出し1-1の\n本文が入ります。ここには見出し1-1の本文が入ります。ここには見出し1-1の本文が入り\nます。ここには見出し1-1の本文が入ります。ここには見出し1-1の本文が入ります。ここ\nには見出し1-1の本文が入ります。ここには見出し1-1の本文が入ります。\n見出し 1-2\nここには見出し1-2の本文が入ります。ここには見出し1-2の本文が入ります。ここには見\n出し1-2の本文が入ります。ここには見出し1-2の本文が入ります。ここには見出し1-2の\n本文が入ります。ここには見出し1-2の本文が入ります。ここには見出し1-2の本文が入り\nます。\nここには見出し1-2の本文が入ります。ここには見出し1-2の本文が入ります。\n1ここには見出し1-2の本文が入ります。ここには見出し1-2の本文が入ります。\n見出し 1-3\nここには見出し1-3の本文が入ります。ここには見出し1-3の本文が入ります。\nここには見出し1-3の本文が入ります。ここには見出し1-3の本文が入ります。ここには見\n出し1-3の本文が入ります。ここには見出し1-3の本文が入ります。ここには見出し1-3の\n本文が入ります。ここには見出し1-3の本文が入ります。\n2列1 列2 列3 列4\n行1列1の本文が入 行1列2の本文が入 行1列3の本文が入 行1列4の本文が入\nります。 ります。 ります。 ります。\n行2列1の本文が入 行2列2の本文が入 行2列3の本文が入 行2列4の本文が入\nります。 ります。 ります。 ります。\n行3列1の本文が入 行3列2の本文が入 行3列3の本文が入 行3列4の本文が入\nります。 ります。 ります。 ります。\n表1. 表1の名前が入ります。\n列1 列2 列3 列4\n行 1列 1の本文が 行1列 2の本文が 行1列 3の本文が 行1列 4の本文が\n入ります。 入ります。 入ります。 入ります。\n行 2列 1の本文が 行2列 2の本文が 行2列 3の本文が 行2列 4の本文が\n入ります。 入ります。 入ります。 入ります。\n表2. 表2の名前が入ります。\n見出し 1-4\nここには見出し1-4の本文が入ります。ここには見出し1-4の本文が入ります。ここには見\n3出し1-4の本文が入ります。ここには見出し1-4の本文が入ります。ここには見出し1-4の\n本文が入ります。ここには見出し1-4の本文が入ります。ここには見出し1-4の本文が入り\nます。ここには見出し1-4の本文が入ります。ここには見出し1-4の本文が入ります。ここ\nには見出し1-4の本文が入ります。\n4見出し 2\n(項目名が入ります)\n見出し 2-1\nここには見出し2-1の本文が入ります。ここには見出し2-1の本文が入り\nます。ここには見出し2-1の本文が入ります。ここには見出し2-1の本文が入ります。ここ\nには見出し2-1の本文が入ります。ここには見出し2-1の本文が入ります。ここには見出し\n2-1の本文が入ります。ここには見出し2-1の本文が入ります。\n(項目名が入ります)\n見出し 2-2\nここには見出し2-2の本文が入ります。ここには見出し2-2の本文が入り\nます。ここには見出し2-2の本文が入ります。ここには見出し2-2の本文が入ります。ここ\nには見出し2-2の本文が入ります。ここには見出し2-2の本文が入ります。ここには見出し\n2-2の本文が入ります。\nここには見出し2-2の本文が入ります。\n以上\n5\n```\n\nこのように、PDFのレイアウトに沿ったテキストが抽出されます。\n\n---\n\n## 表の抽出\n\npdfplumberでは表の内容をリスト形式で取り出せるため、後続処理が簡単です。\n\n### 表抽出のコード例\n\n次のコードは、PDFから表を抽出し、タブ区切り形式でファイルに保存する例です。\n\n```python\nimport os\nimport pdfplumber\n\ninput_pdf_path = \"./docs/読み取りテスト文書.pdf\"\noutput_txt_path = \"./output/table_extract.txt\"\n\ndef extract_tables_with_pdfplumber(input_path, output_path):\n    try:\n        with pdfplumber.open(input_path) as pdf:\n            extracted_table = \"\"\n\n            for i, page in enumerate(pdf.pages, start=1):\n                tables = page.extract_tables()\n                if tables:\n                    for table in tables:\n                        for row in table:\n                            extracted_table += \"\\t\".join(row) + \"\\n\"\n                        extracted_table += \"\\n\"  # テーブル間に空行を追加\n\n        output_dir = os.path.dirname(output_path)\n        if not os.path.exists(output_dir):\n            os.makedirs(output_dir)\n\n        with open(output_path, \"w\", encoding=\"utf-8\") as f:\n            f.write(extracted_table)\n\n        print(f\"テーブルデータが正常に抽出され、以下のファイルに保存されました: {output_path}\")\n    except Exception as e:\n        print(f\"エラーが発生しました: {e}\")\n\n# 実行\nif __name__ == \"__main__\":\n    extract_tables_with_pdfplumber(input_pdf_path, output_txt_path)\n\n```\n\n### 実行方法\n\nコードを `table_extract.py` として保存し、以下のコマンドで実行します：\n\n```bash\npython3 table_extract.py\n```\n\n### 結果\n\n抽出した表の例：\n\n```\n列1\t列2\t列3\t列4\n行1列1の本文が入\nります。\t行1列2の本文が入\nります。\t行1列3の本文が入\nります。\t行1列4の本文が入\nります。\n行2列1の本文が入\nります。\t行2列2の本文が入\nります。\t行2列3の本文が入\nります。\t行2列4の本文が入\nります。\n行3列1の本文が入\nります。\t行3列2の本文が入\nります。\t行3列3の本文が入\nります。\t行3列4の本文が入\nります。\n\n列1\t列2\t列3\t列4\n行 1列 1の本文が\n入ります。\t行1列 2の本文が\n入ります。\t行1列 3の本文が\n入ります。\t行1列 4の本文が\n入ります。\n行 2列 1の本文が\n入ります。\t行2列 2の本文が\n入ります。\t行2列 3の本文が\n入ります。\t行2列 4の本文が\n入ります。\n\n```\n\nこのように、PDFの表が整った形式で抽出されます。\n\n---\n\n### 3. 抽出データの後処理\n\npdfplumberで抽出した表データは、リスト形式で取得されます。このデータをさらに加工する場合、**pandas**を活用すると便利です。\n\n### PandasでのExcel出力例\n\n```python\nimport pandas as pd\n\n# 抽出した表データをリスト形式にする（例）\ndata = [\n    [\"列1\", \"列2\", \"列3\", \"列4\"],\n    [\"行1列1\", \"行1列2\", \"行1列3\", \"行1列4\"],\n    [\"行2列1\", \"行2列2\", \"行2列3\", \"行2列4\"]\n]\n\n# データフレームとして作成\ndf = pd.DataFrame(data[1:], columns=data[0])\n\n# Excelファイルとして保存\ndf.to_excel(\"./output/extracted_table.xlsx\", index=False)\nprint(\"表データがExcelファイルに保存されました！\")\n\n```\n\n---\n\n## pdfplumberの活用ポイント\n\n1. **テキスト抽出に加え、表データも簡単に処理可能**。\n2. **後続処理との組み合わせが簡単**（例：pandasでExcel出力）。\n3. **複雑なレイアウトでも精度高く抽出**。\n\n---\n\nこれで、PDFからテキストや表を抽出する方法はバッチリです！ぜひ、pdfplumberを使って、プロジェクトの効率化に役立ててください。\n\n次はPyMuPDFのライブラリについても調べていきます。更新をお楽しみに！\n\n---\n\n","createdAt":"2025-05-19T08:50:58.120Z","updatedAt":"2025-06-05T23:59:05.281Z","publishedAt":"2025-06-05T23:59:05.295Z","docId":"jqd87p72n6wi5tl8ozlslk1c","tags":[{"id":20,"documentId":"fbllyhmskvu2l7wbg5dzpkri","createdAt":"2025-05-19T09:48:50.341Z","updatedAt":"2025-05-19T09:48:50.341Z","publishedAt":"2025-05-19T09:48:50.348Z","name":"LLM"},{"id":22,"documentId":"enpfq0z697dadtxijwpwwrsv","createdAt":"2025-05-19T09:49:17.862Z","updatedAt":"2025-05-19T09:49:17.862Z","publishedAt":"2025-05-19T09:49:17.870Z","name":"Python"},{"id":24,"documentId":"l1dya7wtq2ct0n1dxm41pl7j","createdAt":"2025-05-19T09:49:40.953Z","updatedAt":"2025-05-19T09:49:40.953Z","publishedAt":"2025-05-19T09:49:40.961Z","name":"RAG"},{"id":30,"documentId":"d99cu6c3t9hgwynppb92lhph","createdAt":"2025-05-19T09:50:59.080Z","updatedAt":"2025-05-19T09:50:59.080Z","publishedAt":"2025-05-19T09:50:59.086Z","name":"生成AI"}],"thumbnail":[{"id":22,"documentId":"ij9nja1kx09vm7wy95yn20di","name":"20250513-18.png","alternativeText":null,"caption":null,"width":1504,"height":844,"formats":{"thumbnail":{"name":"thumbnail_20250513-18.png","hash":"thumbnail_20250513_18_7f8d875b8b","ext":".png","mime":"image/png","path":null,"width":245,"height":137,"size":16.11,"sizeInBytes":16105,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/thumbnail_20250513_18_7f8d875b8b.png"},"medium":{"name":"medium_20250513-18.png","hash":"medium_20250513_18_7f8d875b8b","ext":".png","mime":"image/png","path":null,"width":750,"height":421,"size":62.76,"sizeInBytes":62757,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_18_7f8d875b8b.png"},"small":{"name":"small_20250513-18.png","hash":"small_20250513_18_7f8d875b8b","ext":".png","mime":"image/png","path":null,"width":500,"height":281,"size":39.22,"sizeInBytes":39220,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/small_20250513_18_7f8d875b8b.png"},"large":{"name":"large_20250513-18.png","hash":"large_20250513_18_7f8d875b8b","ext":".png","mime":"image/png","path":null,"width":1000,"height":561,"size":86.16,"sizeInBytes":86156,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/large_20250513_18_7f8d875b8b.png"}},"hash":"20250513_18_7f8d875b8b","ext":".png","mime":"image/png","size":22.86,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/20250513_18_7f8d875b8b.png","previewUrl":null,"provider":"@strapi/provider-upload-aws-s3","provider_metadata":null,"createdAt":"2025-05-20T07:49:35.401Z","updatedAt":"2025-05-20T07:49:35.401Z","publishedAt":"2025-05-20T07:49:35.401Z"}]}},"__N_SSG":true},"page":"/articles/[id]","query":{"id":"g8z0fn5ap0si8r1iheg2iwd7"},"buildId":"_saeqYYuk801MD-5UWwzK","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>