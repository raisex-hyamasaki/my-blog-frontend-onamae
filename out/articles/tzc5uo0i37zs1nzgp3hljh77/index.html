<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="最新の技術トレンド、プログラミング、ソフトウェア開発、ツールのレビュー、プロジェクト管理等についての考察をお届け"/><meta property="og:url" content="https://blog.raisex.jp/articles/tzc5uo0i37zs1nzgp3hljh77"/><meta property="og:title" content="レイズクロスTechBlog | さいたま市大宮区システム会社raisex運営"/><meta property="og:description" content="最新の技術トレンド、プログラミング、ソフトウェア開発、ツールのレビュー、プロジェクト管理等についての考察をお届け"/><meta property="og:image" content="https://blog.raisex.jphttps://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_09_0f6287835c.png"/><meta property="og:type" content="article"/><meta name="twitter:card" content="summary_large_image"/><title>DynamoDB Scan vs Query: パフォーマンスとコストの比較<!-- --> | レイズクロス Tech Blog</title><meta name="next-head-count" content="11"/><link rel="preload" href="/_next/static/css/7d757bdfdfb985a7.css" as="style"/><link rel="stylesheet" href="/_next/static/css/7d757bdfdfb985a7.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-2c547fd4592db0a6.js" defer=""></script><script src="/_next/static/chunks/framework-e952fed463eb8e34.js" defer=""></script><script src="/_next/static/chunks/main-72cf801a60c05482.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b6737859a806843a.js" defer=""></script><script src="/_next/static/chunks/a2bf56a3-f921f321ae1e0e8d.js" defer=""></script><script src="/_next/static/chunks/61-43a5fb199f2ef164.js" defer=""></script><script src="/_next/static/chunks/257-c12ad0b16790f4c5.js" defer=""></script><script src="/_next/static/chunks/pages/articles/%5Bid%5D-c5730984a51dce88.js" defer=""></script><script src="/_next/static/QFbkZlg1wljFeRkEGmC7O/_buildManifest.js" defer=""></script><script src="/_next/static/QFbkZlg1wljFeRkEGmC7O/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="max-w-[1024px] mx-auto px-4"><header class="sticky top-0 z-20 bg-white border-b border-gray-200 h-12 flex items-center justify-between px-4"><a class="text-blue-600 no-underline hover:text-gray-600 text-lg font-bold" href="/">📋 レイズクロス Tech Blog</a><div class="flex gap-3"><a href="https://twitter.com/share" target="_blank" rel="noopener noreferrer"><img src="/icons/x.svg" alt="Share on X" class="h-7 w-7"/></a><a href="https://www.facebook.com/sharer/sharer.php" target="_blank" rel="noopener noreferrer"><img src="/icons/facebook.svg" alt="Share on Facebook" class="h-7 w-7"/></a><a href="https://social-plugins.line.me/lineit/share" target="_blank" rel="noopener noreferrer"><img src="/icons/line.svg" alt="Share on LINE" class="h-7 w-7"/></a></div></header><article class="prose prose-slate max-w-none pt-6"><h1 class="text-3xl font-bold border-b pb-2">DynamoDB Scan vs Query: パフォーマンスとコストの比較</h1><div class="text-sm text-gray-500 mb-4">投稿更新日: <!-- -->2025/6/6 8:54:12</div><div class="flex flex-wrap gap-2 mb-4"><span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded-full">#<!-- -->AWS</span><span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded-full">#<!-- -->Backend</span></div><div class="w-full flex justify-center mb-6"><img src="https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_09_0f6287835c.png" alt="サムネイル" class="w-full max-w-[800px] h-auto rounded"/></div><p>弊社では、API Gateway + Lambda + DynamoDBを利用したサーバーレスアーキテクチャでの開発を多く行っています。</p>
<p>その中で、度々パフォーマンス問題が発生する事がありますが、特にDynamoDBのScan操作に起因するケースが目立ちます。</p>
<p>この記事では、<strong>Scan</strong>と<strong>Query</strong>のパフォーマンスとコストの違いについて、実際のデータを用いた検証結果をもとに解説します。</p>
<hr/>
<h2>事前準備</h2>
<p>DynamoDBに10万件のサンプルデータを投入し、ScanとQueryの動作を比較します。</p>
<h3>データ準備手順</h3>
<ol>
<li>
<p><strong>CSVからデータ投入</strong>:</p>
<p>AWS公式サンプルリポジトリ <a href="https://github.com/aws-samples/csv-to-dynamodb" target="_blank" rel="noopener noreferrer" class="text-blue-600 underline">aws-samples/csv-to-dynamodb</a> を利用。</p>
<p>投入手順は <a href="https://dev.classmethod.jp/articles/csv-import-to-dynamodb-table/" target="_blank" rel="noopener noreferrer" class="text-blue-600 underline">こちらの記事</a> を参照。</p>
</li>
<li>
<p><strong>データ件数確認</strong>:
DynamoDB CLIを用いてデータ件数を確認します。</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-bash" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>aws dynamodb scan --table-name test_datas --select COUNT
</span></code></pre></div></pre>
<p>結果:</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-json" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span>    </span><span class="token" style="color:hsl(355, 65%, 65%)">&quot;Count&quot;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">100000</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>    </span><span class="token" style="color:hsl(355, 65%, 65%)">&quot;ScannedCount&quot;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">100000</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>    </span><span class="token" style="color:hsl(355, 65%, 65%)">&quot;ConsumedCapacity&quot;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">null</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">}</span></code></pre></div></pre>
<p>10万件のデータが投入されました。</p>
</li>
</ol>
<hr/>
<h2>実験1: Scan</h2>
<h3>実装コード</h3>
<p>以下のLambda関数を使用してDynamoDBのScan操作を実行します。</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> boto3
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">from</span><span> boto3</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>dynamodb</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>conditions </span><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> Attr
</span>
<span></span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">lambda_handler</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>event</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> context</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>    table_name </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;test_datas&#x27;</span><span>
</span><span>    region </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;us-east-1&#x27;</span><span>
</span>
<span>    dynamodb </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> boto3</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>resource</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;dynamodb&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> region_name</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>region</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>    table </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> dynamodb</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>Table</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>table_name</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>    filter_expression </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> Attr</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;Country&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>eq</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">try</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>        options </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span>            </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;FilterExpression&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> filter_expression</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>            </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;Limit&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1000</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>            </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;ReturnConsumedCapacity&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;TOTAL&#x27;</span><span>
</span><span>        </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">while</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">True</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>            response </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> table</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>scan</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">**</span><span>options</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>            </span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>response</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;Items&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>            </span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>response</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;ConsumedCapacity&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>            next_token </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> response</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>get</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;LastEvaluatedKey&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">None</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>            </span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>next_token</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>            </span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> next_token</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>                options</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;ExclusiveStartKey&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> next_token
</span><span>            </span><span class="token" style="color:hsl(286, 60%, 67%)">else</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>                </span><span class="token" style="color:hsl(286, 60%, 67%)">break</span><span>
</span>
<span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">return</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;statusCode&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">200</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">except</span><span> Exception </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> e</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;エラー:&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> e</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">return</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;statusCode&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">500</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;body&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;サーバーエラーが発生しました&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span></code></pre></div></pre>
<h3>実行結果</h3>
<p>ウォームスタートでの実行結果:</p>
<ul>
<li><strong>実行時間</strong>: 約5秒</li>
<li><strong>消費キャパシティユニット</strong>: 62</li>
</ul>
<p>ログの一部:</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-json" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>Function Logs</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span>
</span><span>&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">30</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">15</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">58517.76</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">8</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">15</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Offline&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">6.92</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">757149684</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">43402.24</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Snacks&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">206885.28</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">3752</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">152.58</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;C&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">19</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">10</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">572480.16</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">6</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">10</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Offline&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">97.44</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">340443837</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">365594.88</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Snacks&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">313912.02</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5693</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">152.58</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;M&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">9</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">12</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">12</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">868637.94</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">10</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">27</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">12</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Online&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">97.44</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">892960441</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">554725.92</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Meat&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">462061.6</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">8078</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">421.89</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;M&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">8</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">23</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">13</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">3408027.42</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">8</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">27</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">13</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Offline&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">364.69</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">543180644</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">2945965.82</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Beverages&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">152559.72</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">9742</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">47.45</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;L&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">27</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">16</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">462257.9</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">14</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">16</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Offline&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">31.79</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">671733558</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">309698.18</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;TableName&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;test_datas&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;CapacityUnits&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">28.5</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">147039830</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Cosmetics&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">919076.82</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5286</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">437.2</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;M&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">12</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">14</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">2311039.2</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">31</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">14</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Online&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">263.33</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">746805799</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1391962.38</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Vegetables&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">273731.68</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">4336</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">154.06</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;L&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">11</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">20</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">15</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">668004.16</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">12</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">21</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">15</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Online&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">90.93</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">964156997</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">394272.48</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Cosmetics&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">734253.01</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">4223</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">437.2</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;C&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">30</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">10</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1846295.6</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">7</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">12</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">10</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Offline&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">263.33</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">182464730</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1112042.59</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Cosmetics&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">398683.91</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">2293</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">437.2</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;C&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">24</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">15</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1002499.6</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">25</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">15</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Offline&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">263.33</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">841381347</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">603815.69</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Household&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">251743.87</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1519</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">668.27</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;C&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">14</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1015102.13</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">25</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">14</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Online&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">502.54</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">351520287</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">763358.26</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Household&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1447485.82</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">8734</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">668.27</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;C&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">29</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">14</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5836670.18</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">14</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Offline&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">502.54</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">391825520</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">4389184.36</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;TableName&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;test_datas&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;CapacityUnits&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">28.5</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">690726172</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;TableName&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;test_datas&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;CapacityUnits&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">0.5</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span>None
<span>END RequestId</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> f6e29395-105a</span><span class="token" style="color:hsl(29, 54%, 61%)">-4388</span><span>-ae4b-a15905769f51
</span><span>REPORT RequestId</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> f6e29395-105a</span><span class="token" style="color:hsl(29, 54%, 61%)">-4388</span><span>-ae4b-a15905769f51	Duration</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">4904.22</span><span> ms	Billed Duration</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">4905</span><span> ms	Memory Size</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">128</span><span> MB	Max Memory Used</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">77</span><span> MB</span></code></pre></div></pre>
<hr/>
<h2>実験2: Query</h2>
<h3>GSI（グローバルセカンダリインデックス）作成</h3>
<p><code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">Country</code> を条件にQueryを実行するため、以下の条件でGSIを作成しました。</p>
<ul>
<li><strong>GSI名</strong>: Country-index</li>
<li><strong>パーティションキー</strong>: Country（文字列）</li>
</ul>
<h3>実装コード</h3>
<p>以下のLambda関数を使用してDynamoDBのQuery操作を実行します。</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> boto3
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">from</span><span> boto3</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>dynamodb</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>conditions </span><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> Key
</span>
<span></span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">lambda_handler</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>event</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> context</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>    table_name </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;test_datas&#x27;</span><span>
</span><span>    region </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;us-east-1&#x27;</span><span>
</span>
<span>    dynamodb </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> boto3</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>resource</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;dynamodb&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> region_name</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>region</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>    table </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> dynamodb</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>Table</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>table_name</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>    key_condition_expression </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> Key</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;Country&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>eq</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">try</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>        options </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span>            </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;KeyConditionExpression&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> key_condition_expression</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>            </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;Limit&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1000</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>            </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;ReturnConsumedCapacity&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;TOTAL&#x27;</span><span>
</span><span>        </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">while</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">True</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>            response </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> table</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>query</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">**</span><span>options</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>            </span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>response</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;Items&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>            </span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>response</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;ConsumedCapacity&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>            next_token </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> response</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>get</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;LastEvaluatedKey&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">None</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>            </span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>next_token</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>            </span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> next_token</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>                options</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;ExclusiveStartKey&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> next_token
</span><span>            </span><span class="token" style="color:hsl(286, 60%, 67%)">else</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>                </span><span class="token" style="color:hsl(286, 60%, 67%)">break</span><span>
</span>
<span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">return</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;statusCode&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">200</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">except</span><span> Exception </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> e</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;エラー:&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> e</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">return</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;statusCode&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">500</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;body&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;サーバーエラーが発生しました&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span></code></pre></div></pre>
<h3>実行結果</h3>
<p>ウォームスタートでの実行結果:</p>
<ul>
<li><strong>実行時間</strong>: 約1.1秒</li>
<li><strong>消費キャパシティユニット</strong>: 16.5</li>
</ul>
<p>ログの一部:</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-json" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>Function Logs</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span>
</span><span>ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Fruits&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">15115.52</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">6272</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">9.33</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;H&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">30</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">15</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">58517.76</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">8</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">15</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Offline&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">6.92</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">757149684</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">43402.24</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Snacks&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">206885.28</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">3752</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">152.58</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;C&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">19</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">10</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">572480.16</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">6</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">10</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Offline&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">97.44</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">340443837</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">365594.88</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Snacks&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">313912.02</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5693</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">152.58</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;M&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">9</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">12</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">12</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">868637.94</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">10</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">27</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">12</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Online&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">97.44</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">892960441</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">554725.92</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Meat&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">462061.6</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">8078</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">421.89</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;M&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">8</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">23</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">13</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">3408027.42</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">8</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">27</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">13</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Offline&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">364.69</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">543180644</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">2945965.82</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Beverages&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">152559.72</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">9742</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">47.45</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;L&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">27</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">16</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">462257.9</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">14</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">16</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Offline&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">31.79</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">671733558</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">309698.18</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Cosmetics&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">919076.82</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5286</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">437.2</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;M&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">12</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">14</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">2311039.2</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">31</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">14</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Online&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">263.33</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">746805799</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1391962.38</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Vegetables&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">273731.68</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">4336</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">154.06</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;L&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">11</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">20</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">15</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">668004.16</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">12</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">21</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">15</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Online&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">90.93</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">964156997</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">394272.48</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Cosmetics&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">734253.01</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">4223</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">437.2</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;C&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">30</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">10</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1846295.6</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">7</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">12</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">10</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Offline&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">263.33</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">182464730</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1112042.59</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Cosmetics&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">398683.91</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">2293</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">437.2</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;C&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">24</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">15</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1002499.6</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">25</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">15</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Offline&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">263.33</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">841381347</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">603815.69</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Household&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">251743.87</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1519</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">668.27</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;C&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">14</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1015102.13</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">25</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">14</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Online&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">502.54</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">351520287</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">763358.26</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;ItemType&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Household&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalProfit&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1447485.82</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitsSold&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">8734</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Country&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitPrice&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">668.27</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderPriority&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;C&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;OrderDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">29</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">14</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;Region&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Australia and Oceania&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalRevenue&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">5836670.18</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;ShipDate&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span>/</span><span class="token" style="color:hsl(29, 54%, 61%)">14</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;SalesChannel&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;Offline&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;UnitCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">502.54</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;uuid&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">391825520</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;TotalCost&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">4389184.36</span><span>&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>&#x27;TableName&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> &#x27;test_datas&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> &#x27;CapacityUnits&#x27;</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">16.5</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span>None
<span>END RequestId</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">902e8513</span><span>-28db</span><span class="token" style="color:hsl(29, 54%, 61%)">-4e25</span><span>-9a4e-df9cba5f9410
</span><span>REPORT RequestId</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">902e8513</span><span>-28db</span><span class="token" style="color:hsl(29, 54%, 61%)">-4e25</span><span>-9a4e-df9cba5f9410	Duration</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1158.68</span><span> ms	Billed Duration</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1159</span><span> ms	Memory Size</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">128</span><span> MB	Max Memory Used</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">82</span><span> MB</span></code></pre></div></pre>
<hr/>
<h2>比較結果</h2>




















<table class="border border-gray-400 w-full text-sm my-4 whitespace-pre-wrap table-fixed"><thead class="bg-cyan-100 text-black"><tr><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">操作方法</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">実行時間</th><th class="w-1/4 border border-gray-400 px-2 py-1 text-left font-medium whitespace-pre-wrap">消費キャパシティユニット</th></tr></thead><tbody><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">Scan</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">約5秒</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">62</td></tr><tr><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">Query</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">約1.1秒</td><td class="w-1/4 border border-gray-300 px-2 py-1 whitespace-pre-wrap">16.5</td></tr></tbody></table>
<h3>考察</h3>
<ol>
<li><strong>パフォーマンス</strong>:
QueryはScanよりも4倍以上高速。指定したパーティションキーに基づいて効率的にデータを取得できるためです。</li>
<li><strong>コスト効率</strong>:
消費キャパシティユニットもScanの約4分の1。大量データの操作では大幅なコスト削減が見込めます。</li>
<li><strong>使用ケース</strong>:
データを効率的に取得したい場合や条件検索が必要な場合は<strong>Query</strong>を使用すべき。一方、条件に合致するパーティションキーがない場合や全件検索が必要な場合に限り、<strong>Scan</strong>を検討します。</li>
</ol>
<hr/>
<h2>まとめ</h2>
<p>データ件数10万件の実験結果から、<strong>Query</strong>は<strong>Scan</strong>よりも圧倒的に高速かつ低コストであることが確認できました。</p>
<p><strong>結論</strong>:</p>
<ul>
<li>DynamoDBのパフォーマンス最適化を考えるなら、<strong>Queryを優先的に使用</strong>。</li>
<li>特に、必要なデータに応じたパーティションキーやGSI設計を行うことが重要です。</li>
</ul>
<p>これからDynamoDBを使った開発を行う方は、この結果を参考に、効率的なデータ操作を実現してください。</p>
<hr/><div class="text-center mt-8"><a class="inline-block bg-gray-800 text-white no-underline px-4 py-2 rounded hover:bg-gray-700" href="/">← 記事一覧に戻る</a></div><div class="my-12 text-center"><p class="font-bold text-gray-800">合同会社raisexでは一緒に働く仲間を募集中です。</p><p class="text-sm text-gray-600 mb-4">ご興味のある方は以下の採用情報をご確認ください。</p><div class="flex justify-center"><div class="engage-recruit-widget" data-height="300" data-width="500" data-url="https://en-gage.net/raisex_jobs/widget/?banner=1"></div></div></div></article></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"id":257,"documentId":"tzc5uo0i37zs1nzgp3hljh77","title":"DynamoDB Scan vs Query: パフォーマンスとコストの比較","content":"弊社では、API Gateway + Lambda + DynamoDBを利用したサーバーレスアーキテクチャでの開発を多く行っています。\n\nその中で、度々パフォーマンス問題が発生する事がありますが、特にDynamoDBのScan操作に起因するケースが目立ちます。\n\nこの記事では、**Scan**と**Query**のパフォーマンスとコストの違いについて、実際のデータを用いた検証結果をもとに解説します。\n\n---\n\n## 事前準備\n\nDynamoDBに10万件のサンプルデータを投入し、ScanとQueryの動作を比較します。\n\n### データ準備手順\n\n1. **CSVからデータ投入**:\n    \n    AWS公式サンプルリポジトリ [aws-samples/csv-to-dynamodb](https://github.com/aws-samples/csv-to-dynamodb) を利用。\n    \n    投入手順は [こちらの記事](https://dev.classmethod.jp/articles/csv-import-to-dynamodb-table/) を参照。\n    \n2. **データ件数確認**:\nDynamoDB CLIを用いてデータ件数を確認します。\n    \n    ```bash\n    aws dynamodb scan --table-name test_datas --select COUNT\n    \n    ```\n    \n    結果:\n    \n    ```json\n    {\n        \"Count\": 100000,\n        \"ScannedCount\": 100000,\n        \"ConsumedCapacity\": null\n    }\n    ```\n    \n    10万件のデータが投入されました。\n    \n\n---\n\n## 実験1: Scan\n\n### 実装コード\n\n以下のLambda関数を使用してDynamoDBのScan操作を実行します。\n\n```python\nimport boto3\nfrom boto3.dynamodb.conditions import Attr\n\ndef lambda_handler(event, context):\n    table_name = 'test_datas'\n    region = 'us-east-1'\n\n    dynamodb = boto3.resource('dynamodb', region_name=region)\n    table = dynamodb.Table(table_name)\n\n    filter_expression = Attr('Country').eq('Australia')\n\n    try:\n        options = {\n            'FilterExpression': filter_expression,\n            'Limit': 1000,\n            'ReturnConsumedCapacity': 'TOTAL'\n        }\n        while True:\n            response = table.scan(**options)\n            print(response['Items'])\n            print(response['ConsumedCapacity'])\n            next_token = response.get('LastEvaluatedKey', None)\n            print(next_token)\n\n            if next_token:\n                options['ExclusiveStartKey'] = next_token\n            else:\n                break\n\n        return {'statusCode': 200}\n    except Exception as e:\n        print('エラー:', e)\n        return {'statusCode': 500, 'body': 'サーバーエラーが発生しました'}\n\n```\n\n### 実行結果\n\nウォームスタートでの実行結果:\n\n- **実行時間**: 約5秒\n- **消費キャパシティユニット**: 62\n\nログの一部:\n\n```json\nFunction Logs:\n'3/30/15', 'Region': 'Australia and Oceania', 'TotalRevenue': '58517.76', 'ShipDate': '5/8/15', 'SalesChannel': 'Offline', 'UnitCost': '6.92', 'uuid': '757149684', 'TotalCost': '43402.24'}, {'ItemType': 'Snacks', 'TotalProfit': '206885.28', 'UnitsSold': '3752', 'UnitPrice': '152.58', 'Country': 'Australia', 'OrderPriority': 'C', 'OrderDate': '4/19/10', 'Region': 'Australia and Oceania', 'TotalRevenue': '572480.16', 'ShipDate': '6/5/10', 'SalesChannel': 'Offline', 'UnitCost': '97.44', 'uuid': '340443837', 'TotalCost': '365594.88'}, {'ItemType': 'Snacks', 'TotalProfit': '313912.02', 'UnitsSold': '5693', 'UnitPrice': '152.58', 'Country': 'Australia', 'OrderPriority': 'M', 'OrderDate': '9/12/12', 'Region': 'Australia and Oceania', 'TotalRevenue': '868637.94', 'ShipDate': '10/27/12', 'SalesChannel': 'Online', 'UnitCost': '97.44', 'uuid': '892960441', 'TotalCost': '554725.92'}, {'ItemType': 'Meat', 'TotalProfit': '462061.6', 'UnitsSold': '8078', 'UnitPrice': '421.89', 'Country': 'Australia', 'OrderPriority': 'M', 'OrderDate': '8/23/13', 'Region': 'Australia and Oceania', 'TotalRevenue': '3408027.42', 'ShipDate': '8/27/13', 'SalesChannel': 'Offline', 'UnitCost': '364.69', 'uuid': '543180644', 'TotalCost': '2945965.82'}, {'ItemType': 'Beverages', 'TotalProfit': '152559.72', 'UnitsSold': '9742', 'UnitPrice': '47.45', 'Country': 'Australia', 'OrderPriority': 'L', 'OrderDate': '1/27/16', 'Region': 'Australia and Oceania', 'TotalRevenue': '462257.9', 'ShipDate': '2/14/16', 'SalesChannel': 'Offline', 'UnitCost': '31.79', 'uuid': '671733558', 'TotalCost': '309698.18'}]\n{'TableName': 'test_datas', 'CapacityUnits': 28.5}\n{'uuid': '147039830'}\n[{'ItemType': 'Cosmetics', 'TotalProfit': '919076.82', 'UnitsSold': '5286', 'UnitPrice': '437.2', 'Country': 'Australia', 'OrderPriority': 'M', 'OrderDate': '5/12/14', 'Region': 'Australia and Oceania', 'TotalRevenue': '2311039.2', 'ShipDate': '5/31/14', 'SalesChannel': 'Online', 'UnitCost': '263.33', 'uuid': '746805799', 'TotalCost': '1391962.38'}, {'ItemType': 'Vegetables', 'TotalProfit': '273731.68', 'UnitsSold': '4336', 'UnitPrice': '154.06', 'Country': 'Australia', 'OrderPriority': 'L', 'OrderDate': '11/20/15', 'Region': 'Australia and Oceania', 'TotalRevenue': '668004.16', 'ShipDate': '12/21/15', 'SalesChannel': 'Online', 'UnitCost': '90.93', 'uuid': '964156997', 'TotalCost': '394272.48'}, {'ItemType': 'Cosmetics', 'TotalProfit': '734253.01', 'UnitsSold': '4223', 'UnitPrice': '437.2', 'Country': 'Australia', 'OrderPriority': 'C', 'OrderDate': '5/30/10', 'Region': 'Australia and Oceania', 'TotalRevenue': '1846295.6', 'ShipDate': '7/12/10', 'SalesChannel': 'Offline', 'UnitCost': '263.33', 'uuid': '182464730', 'TotalCost': '1112042.59'}, {'ItemType': 'Cosmetics', 'TotalProfit': '398683.91', 'UnitsSold': '2293', 'UnitPrice': '437.2', 'Country': 'Australia', 'OrderPriority': 'C', 'OrderDate': '5/24/15', 'Region': 'Australia and Oceania', 'TotalRevenue': '1002499.6', 'ShipDate': '5/25/15', 'SalesChannel': 'Offline', 'UnitCost': '263.33', 'uuid': '841381347', 'TotalCost': '603815.69'}, {'ItemType': 'Household', 'TotalProfit': '251743.87', 'UnitsSold': '1519', 'UnitPrice': '668.27', 'Country': 'Australia', 'OrderPriority': 'C', 'OrderDate': '1/3/14', 'Region': 'Australia and Oceania', 'TotalRevenue': '1015102.13', 'ShipDate': '1/25/14', 'SalesChannel': 'Online', 'UnitCost': '502.54', 'uuid': '351520287', 'TotalCost': '763358.26'}, {'ItemType': 'Household', 'TotalProfit': '1447485.82', 'UnitsSold': '8734', 'UnitPrice': '668.27', 'Country': 'Australia', 'OrderPriority': 'C', 'OrderDate': '1/29/14', 'Region': 'Australia and Oceania', 'TotalRevenue': '5836670.18', 'ShipDate': '2/2/14', 'SalesChannel': 'Offline', 'UnitCost': '502.54', 'uuid': '391825520', 'TotalCost': '4389184.36'}]\n{'TableName': 'test_datas', 'CapacityUnits': 28.5}\n{'uuid': '690726172'}\n[]\n{'TableName': 'test_datas', 'CapacityUnits': 0.5}\nNone\nEND RequestId: f6e29395-105a-4388-ae4b-a15905769f51\nREPORT RequestId: f6e29395-105a-4388-ae4b-a15905769f51\tDuration: 4904.22 ms\tBilled Duration: 4905 ms\tMemory Size: 128 MB\tMax Memory Used: 77 MB\n```\n\n---\n\n## 実験2: Query\n\n### GSI（グローバルセカンダリインデックス）作成\n\n`Country` を条件にQueryを実行するため、以下の条件でGSIを作成しました。\n\n- **GSI名**: Country-index\n- **パーティションキー**: Country（文字列）\n\n### 実装コード\n\n以下のLambda関数を使用してDynamoDBのQuery操作を実行します。\n\n```python\nimport boto3\nfrom boto3.dynamodb.conditions import Key\n\ndef lambda_handler(event, context):\n    table_name = 'test_datas'\n    region = 'us-east-1'\n\n    dynamodb = boto3.resource('dynamodb', region_name=region)\n    table = dynamodb.Table(table_name)\n\n    key_condition_expression = Key('Country').eq('Australia')\n\n    try:\n        options = {\n            'KeyConditionExpression': key_condition_expression,\n            'Limit': 1000,\n            'ReturnConsumedCapacity': 'TOTAL'\n        }\n        while True:\n            response = table.query(**options)\n            print(response['Items'])\n            print(response['ConsumedCapacity'])\n            next_token = response.get('LastEvaluatedKey', None)\n            print(next_token)\n\n            if next_token:\n                options['ExclusiveStartKey'] = next_token\n            else:\n                break\n\n        return {'statusCode': 200}\n    except Exception as e:\n        print('エラー:', e)\n        return {'statusCode': 500, 'body': 'サーバーエラーが発生しました'}\n\n```\n\n### 実行結果\n\nウォームスタートでの実行結果:\n\n- **実行時間**: 約1.1秒\n- **消費キャパシティユニット**: 16.5\n\nログの一部:\n\n```json\nFunction Logs:\nItemType': 'Fruits', 'TotalProfit': '15115.52', 'UnitsSold': '6272', 'Country': 'Australia', 'UnitPrice': '9.33', 'OrderPriority': 'H', 'OrderDate': '3/30/15', 'Region': 'Australia and Oceania', 'TotalRevenue': '58517.76', 'ShipDate': '5/8/15', 'SalesChannel': 'Offline', 'UnitCost': '6.92', 'uuid': '757149684', 'TotalCost': '43402.24'}, {'ItemType': 'Snacks', 'TotalProfit': '206885.28', 'UnitsSold': '3752', 'Country': 'Australia', 'UnitPrice': '152.58', 'OrderPriority': 'C', 'OrderDate': '4/19/10', 'Region': 'Australia and Oceania', 'TotalRevenue': '572480.16', 'ShipDate': '6/5/10', 'SalesChannel': 'Offline', 'UnitCost': '97.44', 'uuid': '340443837', 'TotalCost': '365594.88'}, {'ItemType': 'Snacks', 'TotalProfit': '313912.02', 'UnitsSold': '5693', 'Country': 'Australia', 'UnitPrice': '152.58', 'OrderPriority': 'M', 'OrderDate': '9/12/12', 'Region': 'Australia and Oceania', 'TotalRevenue': '868637.94', 'ShipDate': '10/27/12', 'SalesChannel': 'Online', 'UnitCost': '97.44', 'uuid': '892960441', 'TotalCost': '554725.92'}, {'ItemType': 'Meat', 'TotalProfit': '462061.6', 'UnitsSold': '8078', 'Country': 'Australia', 'UnitPrice': '421.89', 'OrderPriority': 'M', 'OrderDate': '8/23/13', 'Region': 'Australia and Oceania', 'TotalRevenue': '3408027.42', 'ShipDate': '8/27/13', 'SalesChannel': 'Offline', 'UnitCost': '364.69', 'uuid': '543180644', 'TotalCost': '2945965.82'}, {'ItemType': 'Beverages', 'TotalProfit': '152559.72', 'UnitsSold': '9742', 'Country': 'Australia', 'UnitPrice': '47.45', 'OrderPriority': 'L', 'OrderDate': '1/27/16', 'Region': 'Australia and Oceania', 'TotalRevenue': '462257.9', 'ShipDate': '2/14/16', 'SalesChannel': 'Offline', 'UnitCost': '31.79', 'uuid': '671733558', 'TotalCost': '309698.18'}, {'ItemType': 'Cosmetics', 'TotalProfit': '919076.82', 'UnitsSold': '5286', 'Country': 'Australia', 'UnitPrice': '437.2', 'OrderPriority': 'M', 'OrderDate': '5/12/14', 'Region': 'Australia and Oceania', 'TotalRevenue': '2311039.2', 'ShipDate': '5/31/14', 'SalesChannel': 'Online', 'UnitCost': '263.33', 'uuid': '746805799', 'TotalCost': '1391962.38'}, {'ItemType': 'Vegetables', 'TotalProfit': '273731.68', 'UnitsSold': '4336', 'Country': 'Australia', 'UnitPrice': '154.06', 'OrderPriority': 'L', 'OrderDate': '11/20/15', 'Region': 'Australia and Oceania', 'TotalRevenue': '668004.16', 'ShipDate': '12/21/15', 'SalesChannel': 'Online', 'UnitCost': '90.93', 'uuid': '964156997', 'TotalCost': '394272.48'}, {'ItemType': 'Cosmetics', 'TotalProfit': '734253.01', 'UnitsSold': '4223', 'Country': 'Australia', 'UnitPrice': '437.2', 'OrderPriority': 'C', 'OrderDate': '5/30/10', 'Region': 'Australia and Oceania', 'TotalRevenue': '1846295.6', 'ShipDate': '7/12/10', 'SalesChannel': 'Offline', 'UnitCost': '263.33', 'uuid': '182464730', 'TotalCost': '1112042.59'}, {'ItemType': 'Cosmetics', 'TotalProfit': '398683.91', 'UnitsSold': '2293', 'Country': 'Australia', 'UnitPrice': '437.2', 'OrderPriority': 'C', 'OrderDate': '5/24/15', 'Region': 'Australia and Oceania', 'TotalRevenue': '1002499.6', 'ShipDate': '5/25/15', 'SalesChannel': 'Offline', 'UnitCost': '263.33', 'uuid': '841381347', 'TotalCost': '603815.69'}, {'ItemType': 'Household', 'TotalProfit': '251743.87', 'UnitsSold': '1519', 'Country': 'Australia', 'UnitPrice': '668.27', 'OrderPriority': 'C', 'OrderDate': '1/3/14', 'Region': 'Australia and Oceania', 'TotalRevenue': '1015102.13', 'ShipDate': '1/25/14', 'SalesChannel': 'Online', 'UnitCost': '502.54', 'uuid': '351520287', 'TotalCost': '763358.26'}, {'ItemType': 'Household', 'TotalProfit': '1447485.82', 'UnitsSold': '8734', 'Country': 'Australia', 'UnitPrice': '668.27', 'OrderPriority': 'C', 'OrderDate': '1/29/14', 'Region': 'Australia and Oceania', 'TotalRevenue': '5836670.18', 'ShipDate': '2/2/14', 'SalesChannel': 'Offline', 'UnitCost': '502.54', 'uuid': '391825520', 'TotalCost': '4389184.36'}]\n{'TableName': 'test_datas', 'CapacityUnits': 16.5}\nNone\nEND RequestId: 902e8513-28db-4e25-9a4e-df9cba5f9410\nREPORT RequestId: 902e8513-28db-4e25-9a4e-df9cba5f9410\tDuration: 1158.68 ms\tBilled Duration: 1159 ms\tMemory Size: 128 MB\tMax Memory Used: 82 MB\n```\n\n---\n\n## 比較結果\n\n| 操作方法 | 実行時間 | 消費キャパシティユニット |\n| --- | --- | --- |\n| Scan | 約5秒 | 62 |\n| Query | 約1.1秒 | 16.5 |\n\n### 考察\n\n1. **パフォーマンス**:\nQueryはScanよりも4倍以上高速。指定したパーティションキーに基づいて効率的にデータを取得できるためです。\n2. **コスト効率**:\n消費キャパシティユニットもScanの約4分の1。大量データの操作では大幅なコスト削減が見込めます。\n3. **使用ケース**:\nデータを効率的に取得したい場合や条件検索が必要な場合は**Query**を使用すべき。一方、条件に合致するパーティションキーがない場合や全件検索が必要な場合に限り、**Scan**を検討します。\n\n---\n\n## まとめ\n\nデータ件数10万件の実験結果から、**Query**は**Scan**よりも圧倒的に高速かつ低コストであることが確認できました。\n\n**結論**:\n\n- DynamoDBのパフォーマンス最適化を考えるなら、**Queryを優先的に使用**。\n- 特に、必要なデータに応じたパーティションキーやGSI設計を行うことが重要です。\n\nこれからDynamoDBを使った開発を行う方は、この結果を参考に、効率的なデータ操作を実現してください。\n\n---\n\n","createdAt":"2025-05-19T08:50:57.493Z","updatedAt":"2025-06-05T23:54:12.945Z","publishedAt":"2025-06-05T23:54:12.955Z","docId":"za9s1y1l3ml93qjgosr1vlhy","tags":[{"id":10,"documentId":"cxt2tbnsy05cazm17p3pp1a3","createdAt":"2025-05-19T09:46:58.860Z","updatedAt":"2025-05-19T09:46:58.860Z","publishedAt":"2025-05-19T09:46:58.868Z","name":"AWS"},{"id":12,"documentId":"c3lesvkdvjiq7y5zfx9mx0tu","createdAt":"2025-05-19T09:47:14.973Z","updatedAt":"2025-05-19T09:47:14.973Z","publishedAt":"2025-05-19T09:47:14.980Z","name":"Backend"}],"thumbnail":[{"id":13,"documentId":"i7hnmvhawpdgyops4ew36guj","name":"20250513-09.png","alternativeText":null,"caption":null,"width":1503,"height":844,"formats":{"thumbnail":{"name":"thumbnail_20250513-09.png","hash":"thumbnail_20250513_09_0f6287835c","ext":".png","mime":"image/png","path":null,"width":245,"height":138,"size":14.36,"sizeInBytes":14359,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/thumbnail_20250513_09_0f6287835c.png"},"medium":{"name":"medium_20250513-09.png","hash":"medium_20250513_09_0f6287835c","ext":".png","mime":"image/png","path":null,"width":750,"height":421,"size":57.07,"sizeInBytes":57073,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_09_0f6287835c.png"},"small":{"name":"small_20250513-09.png","hash":"small_20250513_09_0f6287835c","ext":".png","mime":"image/png","path":null,"width":500,"height":281,"size":34.88,"sizeInBytes":34880,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/small_20250513_09_0f6287835c.png"},"large":{"name":"large_20250513-09.png","hash":"large_20250513_09_0f6287835c","ext":".png","mime":"image/png","path":null,"width":1000,"height":562,"size":80.44,"sizeInBytes":80435,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/large_20250513_09_0f6287835c.png"}},"hash":"20250513_09_0f6287835c","ext":".png","mime":"image/png","size":23.72,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/20250513_09_0f6287835c.png","previewUrl":null,"provider":"@strapi/provider-upload-aws-s3","provider_metadata":null,"createdAt":"2025-05-20T07:44:09.283Z","updatedAt":"2025-05-20T07:44:09.283Z","publishedAt":"2025-05-20T07:44:09.284Z"}]}},"__N_SSG":true},"page":"/articles/[id]","query":{"id":"tzc5uo0i37zs1nzgp3hljh77"},"buildId":"QFbkZlg1wljFeRkEGmC7O","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>