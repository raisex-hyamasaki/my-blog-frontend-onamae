<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="æœ€æ–°ã®æŠ€è¡“ãƒˆãƒ¬ãƒ³ãƒ‰ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã€ãƒ„ãƒ¼ãƒ«ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ç­‰ã«ã¤ã„ã¦ã®è€ƒå¯Ÿã‚’ãŠå±Šã‘"/><meta property="og:url" content="https://blog.raisex.jp/articles/nyg7h5f0xw60bpk88glrh4zo"/><meta property="og:title" content="LLMãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ« | ãƒ¬ã‚¤ã‚ºã‚¯ãƒ­ã‚¹TechBlog"/><meta property="og:description" content="æœ€æ–°ã®æŠ€è¡“ãƒˆãƒ¬ãƒ³ãƒ‰ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã€ãƒ„ãƒ¼ãƒ«ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ç­‰ã«ã¤ã„ã¦ã®è€ƒå¯Ÿã‚’ãŠå±Šã‘"/><meta property="og:image" content="https://blog.raisex.jphttps://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_15_a017e8a63e.png"/><meta property="og:type" content="article"/><meta name="twitter:card" content="summary_large_image"/><title>LLMãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«<!-- --> | ãƒ¬ã‚¤ã‚ºã‚¯ãƒ­ã‚¹ Tech Blog</title><meta name="next-head-count" content="11"/><link rel="preload" href="/_next/static/css/7d757bdfdfb985a7.css" as="style"/><link rel="stylesheet" href="/_next/static/css/7d757bdfdfb985a7.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-2c547fd4592db0a6.js" defer=""></script><script src="/_next/static/chunks/framework-e952fed463eb8e34.js" defer=""></script><script src="/_next/static/chunks/main-72cf801a60c05482.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b6737859a806843a.js" defer=""></script><script src="/_next/static/chunks/a2bf56a3-f921f321ae1e0e8d.js" defer=""></script><script src="/_next/static/chunks/61-43a5fb199f2ef164.js" defer=""></script><script src="/_next/static/chunks/257-c12ad0b16790f4c5.js" defer=""></script><script src="/_next/static/chunks/pages/articles/%5Bid%5D-1f9ae5c384ab52dd.js" defer=""></script><script src="/_next/static/wdcbjCbp8DYGqTQVAi4UF/_buildManifest.js" defer=""></script><script src="/_next/static/wdcbjCbp8DYGqTQVAi4UF/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="max-w-[1024px] mx-auto px-4"><header class="sticky top-0 z-20 bg-white border-b border-gray-200 h-12 flex items-center justify-between px-4"><a class="text-blue-600 no-underline hover:text-gray-600 text-lg font-bold" href="/">ğŸ“‹ ãƒ¬ã‚¤ã‚ºã‚¯ãƒ­ã‚¹ Tech Blog</a><div class="flex gap-3"><a href="https://twitter.com/share" target="_blank" rel="noopener noreferrer"><img src="/icons/x.svg" alt="Share on X" class="h-7 w-7"/></a><a href="https://www.facebook.com/sharer/sharer.php" target="_blank" rel="noopener noreferrer"><img src="/icons/facebook.svg" alt="Share on Facebook" class="h-7 w-7"/></a><a href="https://social-plugins.line.me/lineit/share" target="_blank" rel="noopener noreferrer"><img src="/icons/line.svg" alt="Share on LINE" class="h-7 w-7"/></a></div></header><article class="prose prose-slate max-w-none pt-6"><h1 class="text-3xl font-bold border-b pb-2">LLMãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«</h1><div class="text-sm text-gray-500 mb-4">æŠ•ç¨¿æ›´æ–°æ—¥: <!-- -->2025/6/6 8:56:30</div><div class="flex flex-wrap gap-2 mb-4"><span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded-full">#<!-- -->LLM</span><span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded-full">#<!-- -->Tutorial</span><span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded-full">#<!-- -->ç”ŸæˆAI</span></div><div class="w-full flex justify-center mb-6"><img src="https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_15_a017e8a63e.png" alt="ã‚µãƒ ãƒã‚¤ãƒ«" class="w-full max-w-[800px] h-auto rounded"/></div><p>è¿‘å¹´ã€è‡ªç„¶è¨€èªå‡¦ç†ï¼ˆNLPï¼‰ã®åˆ†é‡ã§ã¯å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ï¼ˆLLMï¼‰ã®æ´»ç”¨ãŒæ€¥é€Ÿã«é€²ã‚“ã§ã„ã¾ã™ã€‚ç‰¹ã«ã€ç‰¹å®šã®ã‚¿ã‚¹ã‚¯å‘ã‘ã«ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚’å‘ä¸Šã•ã›ã‚‹ã€Œãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã€ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã®éœ€è¦ãŒå¢—ãˆã¤ã¤ã‚ã‚Šã¾ã™ã€‚</p>
<p>æœ¬è¨˜äº‹ã§ã¯ã€åˆå¿ƒè€…ã®æ–¹ã§ã‚‚ç†è§£ã—ã‚„ã™ã„ã‚ˆã†ã«ã€ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®åŸºæœ¬çš„ãªæµã‚Œã‚’ä½“é¨“ã§ãã‚‹ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’ç”¨æ„ã—ã¾ã—ãŸã€‚</p>
<hr/>
<h1>ç’°å¢ƒè¨­å®šã¨äº‹å‰æº–å‚™</h1>
<p>ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã¯ã€macOSç’°å¢ƒï¼ˆä¾‹: M2 MacBook Proï¼‰ã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ã¦ã„ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ä»®æƒ³ç’°å¢ƒã‚’ä½œæˆã—ã€å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã—ã‚‡ã†ã€‚</p>
<h3>ä»®æƒ³ç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</h3>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-bash" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>python -m venv .env
</span><span></span><span class="token" style="color:hsl(29, 54%, 61%)">source</span><span> .env/bin/activate</span></code></pre></div></pre>
<h3>å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h3>
<p>ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€å¿…è¦ãªPythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-bash" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>pip </span><span class="token" style="color:hsl(207, 82%, 66%)">install</span><span> transformers datasets evaluate accelerate scikit-learn torch
</span></code></pre></div></pre>
<h3>å‹•ä½œç¢ºèª</h3>
<p>ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒæ­£ã—ãã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸã‹ç¢ºèªã™ã‚‹ãŸã‚ã«ã€ä»¥ä¸‹ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-bash" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>python -c </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;from transformers import pipeline; print(pipeline(&#x27;sentiment-analysis&#x27;)(&#x27;we love you&#x27;))&quot;</span><span>
</span></code></pre></div></pre>
<p>æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›ï¼š</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-bash" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;label&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;POSITIVE&#x27;</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;score&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">0.9998704195022583</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span></code></pre></div></pre>
<hr/>
<h1>ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä½œæˆã¨å®Ÿè¡Œ</h1>
<p>ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®æ‰‹é †ã‚’ç¤ºã—ãŸPythonã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆ<code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">finetune.py</code>ï¼‰ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã¯ã€<a href="https://huggingface.co/datasets/Yelp/yelp_review_full" target="_blank" rel="noopener noreferrer" class="text-blue-600 underline">Yelpãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ</a>ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</p>
<h3><code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">finetune.py</code></h3>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(286, 60%, 67%)">from</span><span> datasets </span><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> load_dataset
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">from</span><span> transformers </span><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> AutoTokenizer</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> AutoModelForSequenceClassification</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> TrainingArguments</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> Trainer
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> numpy </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> np
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> evaluate
</span>
<span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®æº–å‚™</span><span>
</span><span>dataset </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> load_dataset</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;yelp_review_full&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã«ã‚ˆã‚‹ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚º</span><span>
</span><span>tokenizer </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> AutoTokenizer</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>from_pretrained</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;google-bert/bert-base-cased&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">tokenize_function</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>examples</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">return</span><span> tokenizer</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>examples</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;text&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> padding</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;max_length&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> truncation</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">True</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>tokenized_datasets </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> dataset</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token" style="color:hsl(95, 38%, 62%)">map</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>tokenize_function</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> batched</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">True</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆ</span><span>
</span><span>small_train_dataset </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> tokenized_datasets</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;train&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>shuffle</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>seed</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">42</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>select</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">range</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">500</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>small_eval_dataset </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> tokenized_datasets</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;test&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>shuffle</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>seed</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">42</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>select</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">range</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">500</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># ãƒ¢ãƒ‡ãƒ«ã®ãƒ­ãƒ¼ãƒ‰</span><span>
</span><span>model </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> AutoModelForSequenceClassification</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>from_pretrained</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;google-bert/bert-base-cased&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> num_labels</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> torch_dtype</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;auto&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># è©•ä¾¡é–¢æ•°</span><span>
</span><span>metric </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> evaluate</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>load</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;accuracy&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">compute_metrics</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>eval_pred</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>    logits</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> labels </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> eval_pred
</span><span>    predictions </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> np</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>argmax</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>logits</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> axis</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">return</span><span> metric</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>compute</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>predictions</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>predictions</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> references</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>labels</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># å­¦ç¿’è¨­å®š</span><span>
</span><span>training_args </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> TrainingArguments</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>output_dir</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;test_trainer&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> eval_strategy</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;epoch&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>trainer </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> Trainer</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>
</span><span>    model</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>model</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>    args</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>training_args</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>    train_dataset</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>small_train_dataset</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>    eval_dataset</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>small_eval_dataset</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>    compute_metrics</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>compute_metrics</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># å­¦ç¿’ã®å®Ÿè¡Œ</span><span>
</span><span>trainer</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>train</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># ãƒ¢ãƒ‡ãƒ«ã¨ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã®ä¿å­˜</span><span>
</span><span>save_dir </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;./finetuned/bert-base-cased&#x27;</span><span>
</span><span>tokenizer</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>save_pretrained</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>save_dir</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>model</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>save_pretrained</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>save_dir</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre></div></pre>
<h3>å®Ÿè¡Œçµæœ</h3>
<p>ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªè©•ä¾¡çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-bash" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>python3 finetune.py
</span>
<span></span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;eval_loss&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1.5970934629440308</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;eval_accuracy&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">0.242</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;eval_runtime&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">39.0603</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;eval_samples_per_second&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">12.801</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;eval_steps_per_second&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1.613</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;epoch&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1.0</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>                                                                               
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;eval_loss&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1.468526840209961</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;eval_accuracy&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">0.346</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;eval_runtime&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">36.1194</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;eval_samples_per_second&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">13.843</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;eval_steps_per_second&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1.744</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;epoch&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2.0</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>                                                                                
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;eval_loss&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1.4037985801696777</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;eval_accuracy&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">0.368</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;eval_runtime&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">35.7517</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;eval_samples_per_second&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">13.985</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;eval_steps_per_second&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1.762</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;epoch&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">3.0</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>                                                                               
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;train_runtime&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">467.6126</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;train_samples_per_second&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">3.208</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;train_steps_per_second&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">0.404</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;train_loss&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1.5324497121982474</span><span>, </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;epoch&#x27;</span><span class="token" style="color:hsl(29, 54%, 61%)">:</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">3.0</span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>                                                                                                   
</span><span></span><span class="token" style="color:hsl(29, 54%, 61%)">100</span><span>%</span><span class="token" style="color:hsl(207, 82%, 66%)">|</span><span>â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span><span class="token" style="color:hsl(207, 82%, 66%)">|</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">189</span><span>/189 </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span>07:4</span><span class="token file-descriptor" style="color:hsl(355, 65%, 65%)">7</span><span class="token" style="color:hsl(207, 82%, 66%)">&lt;</span><span>00:00,  </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span>.47s/it</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span></code></pre></div></pre>
<hr/>
<h2>ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è§£èª¬</h2>
<p>ä»¥ä¸‹ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚¹ã‚¯ãƒªãƒ—ãƒˆ <code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">finetune.py</code> ã®å„ãƒ‘ãƒ¼ãƒˆã‚’è©³ã—ãè§£èª¬ã—ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚</p>
<hr/>
<h3>1. ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ãƒ­ãƒ¼ãƒ‰</h3>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>dataset </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> load_dataset</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;yelp_review_full&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre></div></pre>
<h3>è§£èª¬ï¼š</h3>
<ul>
<li>Hugging Faceã®<code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">datasets</code>ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ã€Yelpã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¯ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆã¨1~5ã®è©•ä¾¡ã‚¹ã‚³ã‚¢ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚</li>
</ul>
<h3>ãƒã‚¤ãƒ³ãƒˆï¼š</h3>
<ul>
<li><strong>ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ç¨®é¡</strong>ï¼šHugging Faceã®<code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">load_dataset</code>ã‚’ä½¿ãˆã°ã€è±Šå¯Œãªäº‹å‰æ§‹ç¯‰ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ç°¡å˜ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã€‚</li>
<li><strong>ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ãƒ¼ã‚¿ã®åˆ©ç”¨</strong>ï¼šè‡ªåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã„ãŸã„å ´åˆã€CSVã‚„JSONå½¢å¼ã§èª­ã¿è¾¼ã‚€ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚</li>
</ul>
<hr/>
<h3>2. ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚º</h3>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>tokenizer </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> AutoTokenizer</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>from_pretrained</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;google-bert/bert-base-cased&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span></span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">tokenize_function</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>examples</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">return</span><span> tokenizer</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>examples</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;text&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> padding</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;max_length&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> truncation</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">True</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>tokenized_datasets </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> dataset</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token" style="color:hsl(95, 38%, 62%)">map</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>tokenize_function</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> batched</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">True</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre></div></pre>
<h3>è§£èª¬ï¼š</h3>
<ul>
<li>ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã‚’ä½¿ã£ã¦ãƒ†ã‚­ã‚¹ãƒˆã‚’æ•°å€¤ãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¢ãƒ‡ãƒ«ãŒæ‰±ãˆã‚‹å½¢å¼ã«æ•´ãˆã‚‰ã‚Œã¾ã™ã€‚</li>
<li><code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">padding=&quot;max_length&quot;</code>ã§å›ºå®šé•·ã®å…¥åŠ›ã«æƒãˆã€<code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">truncation=True</code>ã§æœ€å¤§ãƒˆãƒ¼ã‚¯ãƒ³æ•°ã‚’è¶…ãˆãŸéƒ¨åˆ†ã‚’ã‚«ãƒƒãƒˆã—ã¾ã™ã€‚</li>
</ul>
<h3>ãƒã‚¤ãƒ³ãƒˆï¼š</h3>
<ul>
<li><strong>ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã®é¸æŠ</strong>ï¼šãƒ¢ãƒ‡ãƒ«ã«å¯¾å¿œã™ã‚‹ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒé‡è¦ï¼ˆä¾‹: BERTãƒ¢ãƒ‡ãƒ«ãªã‚‰BERTç”¨ã®ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ï¼‰ã€‚</li>
<li><strong>åŠ¹ç‡åŒ–</strong>ï¼š<code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">batched=True</code>ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€åº¦ã«ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚ºã—ã¦å‡¦ç†é€Ÿåº¦ã‚’å‘ä¸Šã€‚</li>
</ul>
<hr/>
<h3>3. ãƒ‡ãƒ¼ã‚¿ã®åˆ†å‰²ã¨ç¸®å°</h3>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>small_train_dataset </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> tokenized_datasets</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;train&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>shuffle</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>seed</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">42</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>select</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">range</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">500</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>small_eval_dataset </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> tokenized_datasets</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;test&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>shuffle</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>seed</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">42</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>select</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">range</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">500</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span></code></pre></div></pre>
<h3>è§£èª¬ï¼š</h3>
<ul>
<li>è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨è©•ä¾¡ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†å‰²ã—ã€ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ç”¨ã«ã‚µãƒ–ã‚»ãƒƒãƒˆï¼ˆ500ä»¶ï¼‰ã‚’ä½œæˆã—ã¾ã™ã€‚</li>
<li><code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">shuffle(seed=42)</code>ã¯ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ä¸¦ã³æ›¿ãˆã¾ã™ãŒã€åŒã˜çµæœã‚’å†ç¾ã™ã‚‹ãŸã‚ã‚·ãƒ¼ãƒ‰å€¤ã‚’è¨­å®šã—ã¦ã„ã¾ã™ã€‚</li>
</ul>
<h3>ãƒã‚¤ãƒ³ãƒˆï¼š</h3>
<ul>
<li><strong>ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã®èª¿æ•´</strong>ï¼šå­¦ç¿’æ™‚é–“ã‚„ãƒªã‚½ãƒ¼ã‚¹ã®åˆ¶ç´„ã«åˆã‚ã›ã¦ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã‚’é¸æŠã§ãã¾ã™ã€‚</li>
<li><strong>å°è¦æ¨¡å­¦ç¿’ã®ãƒ¡ãƒªãƒƒãƒˆ</strong>ï¼šå°è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã§ã‚‚ãƒ¢ãƒ‡ãƒ«ã®å‹•ä½œç¢ºèªã‚„ç†è§£ãŒå¯èƒ½ã€‚</li>
</ul>
<hr/>
<h3>4. ãƒ¢ãƒ‡ãƒ«ã®ãƒ­ãƒ¼ãƒ‰</h3>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>model </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> AutoModelForSequenceClassification</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>from_pretrained</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>
</span><span>    </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;google-bert/bert-base-cased&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>    num_labels</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>    torch_dtype</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;auto&quot;</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre></div></pre>
<h3>è§£èª¬ï¼š</h3>
<ul>
<li>Hugging Faceã‹ã‚‰äº‹å‰å­¦ç¿’æ¸ˆã¿ã®BERTãƒ¢ãƒ‡ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã€åˆ†é¡ã‚¿ã‚¹ã‚¯ç”¨ã«èª¿æ•´ã—ã¾ã™ã€‚</li>
<li><code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">num_labels=5</code>ã¯åˆ†é¡ã‚¯ãƒ©ã‚¹ã®æ•°ï¼ˆYelpã®è©•ä¾¡ã‚¹ã‚³ã‚¢1~5ï¼‰ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚</li>
</ul>
<h3>ãƒã‚¤ãƒ³ãƒˆï¼š</h3>
<ul>
<li><strong>äº‹å‰å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®å†åˆ©ç”¨</strong>ï¼šå¤§è¦æ¨¡ãªäº‹å‰å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€å°‘ãªã„ãƒ‡ãƒ¼ã‚¿ã§ã‚‚è‰¯ã„çµæœãŒå¾—ã‚‰ã‚Œã‚‹ã€‚</li>
<li><strong>ãƒ¢ãƒ‡ãƒ«ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º</strong>ï¼šåˆ†é¡ã‚¯ãƒ©ã‚¹æ•°ã‚„å‡ºåŠ›å±¤ã‚’èª¿æ•´ã—ã¦ç‰¹å®šã®ã‚¿ã‚¹ã‚¯ã«é©å¿œã€‚</li>
</ul>
<hr/>
<h3>5. è©•ä¾¡é–¢æ•°ã®è¨­å®š</h3>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>metric </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> evaluate</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>load</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;accuracy&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">compute_metrics</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>eval_pred</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span>    logits</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> labels </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> eval_pred
</span><span>    predictions </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> np</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>argmax</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>logits</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> axis</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">return</span><span> metric</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>compute</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>predictions</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>predictions</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> references</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>labels</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre></div></pre>
<h3>è§£èª¬ï¼š</h3>
<ul>
<li><code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">evaluate</code>ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ã€ãƒ¢ãƒ‡ãƒ«ã®ç²¾åº¦ï¼ˆaccuracyï¼‰ã‚’è©•ä¾¡ã™ã‚‹é–¢æ•°ã‚’å®šç¾©ã—ã¦ã„ã¾ã™ã€‚</li>
<li>æ¨è«–çµæœï¼ˆ<code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">logits</code>ï¼‰ã‚’<code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">argmax</code>ã§äºˆæ¸¬ãƒ©ãƒ™ãƒ«ã«å¤‰æ›ã—ã€å®Ÿéš›ã®ãƒ©ãƒ™ãƒ«ã¨æ¯”è¼ƒã—ã¦ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã—ã¾ã™ã€‚</li>
</ul>
<h3>ãƒã‚¤ãƒ³ãƒˆï¼š</h3>
<ul>
<li><strong>è©•ä¾¡æŒ‡æ¨™ã®é¸æŠ</strong>ï¼šåˆ†é¡ã‚¿ã‚¹ã‚¯ã§ã¯<code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">accuracy</code>ãŒä¸€èˆ¬çš„ã§ã™ãŒã€ã‚¿ã‚¹ã‚¯ã«å¿œã˜ã¦<code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">precision</code>ã‚„<code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">recall</code>ã‚‚æ¤œè¨ã™ã¹ãã§ã™ã€‚</li>
<li><strong>ç°¡å˜ãªå®Ÿè£…</strong>ï¼š<code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">evaluate</code>ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†ã¨ã€ä¸€èˆ¬çš„ãªè©•ä¾¡æŒ‡æ¨™ã‚’ç°¡å˜ã«åˆ©ç”¨å¯èƒ½ã€‚</li>
</ul>
<hr/>
<h3>6. å­¦ç¿’è¨­å®š</h3>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>training_args </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> TrainingArguments</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>
</span><span>    output_dir</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;test_trainer&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>    eval_strategy</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;epoch&quot;</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>trainer </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> Trainer</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>
</span><span>    model</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>model</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>    args</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>training_args</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>    train_dataset</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>small_train_dataset</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>    eval_dataset</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>small_eval_dataset</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>    compute_metrics</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>compute_metrics</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span></code></pre></div></pre>
<h3>è§£èª¬ï¼š</h3>
<ul>
<li><code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">TrainingArguments</code>ã§å­¦ç¿’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã“ã§ã¯ã€ãƒ¢ãƒ‡ãƒ«ä¿å­˜å…ˆï¼ˆ<code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">output_dir</code>ï¼‰ã¨è©•ä¾¡ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼ˆ<code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">eval_strategy=&quot;epoch&quot;</code>ï¼‰ã‚’è¨­å®šã€‚</li>
<li><code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">Trainer</code>ã‚¯ãƒ©ã‚¹ã¯ã€å­¦ç¿’ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç°¡ç•¥åŒ–ã™ã‚‹ãŸã‚ã®é«˜ãƒ¬ãƒ™ãƒ«APIã§ã™ã€‚</li>
</ul>
<h3>ãƒã‚¤ãƒ³ãƒˆï¼š</h3>
<ul>
<li><strong>ç°¡å˜ãªå­¦ç¿’ç®¡ç†</strong>ï¼š<code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">Trainer</code>ã‚’ä½¿ã†ã¨ã€ãƒ«ãƒ¼ãƒ—ã®ä½œæˆã‚„å‹¾é…è¨ˆç®—ã®å®Ÿè£…ã‚’æ°—ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</li>
<li><strong>è¨­å®šã®æŸ”è»Ÿæ€§</strong>ï¼šå­¦ç¿’ç‡ã‚„ãƒãƒƒãƒã‚µã‚¤ã‚ºãªã©ã®è©³ç´°è¨­å®šã‚‚å¯èƒ½ã§ã™ã€‚</li>
</ul>
<hr/>
<h3>7. ãƒ¢ãƒ‡ãƒ«ã®ä¿å­˜</h3>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>tokenizer</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>save_pretrained</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;./finetuned/bert-base-cased&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>model</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>save_pretrained</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;./finetuned/bert-base-cased&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre></div></pre>
<h3>è§£èª¬ï¼š</h3>
<ul>
<li>ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°å¾Œã®ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã¨ãƒ¢ãƒ‡ãƒ«ã‚’ä¿å­˜ã—ã¾ã™ã€‚ã“ã®ä¿å­˜æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã¯ã€å°†æ¥çš„ã«æ¨è«–ã‚„ã•ã‚‰ãªã‚‹èª¿æ•´ã«ä½¿ç”¨ã§ãã¾ã™ã€‚</li>
</ul>
<h3>ãƒã‚¤ãƒ³ãƒˆï¼š</h3>
<ul>
<li><strong>å†åˆ©ç”¨æ€§ã®å‘ä¸Š</strong>ï¼šãƒ¢ãƒ‡ãƒ«ã‚’ä¿å­˜ã—ã¦ãŠãã“ã¨ã§ã€ä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚„ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã«æ´»ç”¨å¯èƒ½ã€‚</li>
<li><strong>Hugging Faceäº’æ›</strong>ï¼šä¿å­˜å½¢å¼ã¯Hugging Faceãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã®å†åˆ©ç”¨ã«æœ€é©åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚</li>
</ul>
<hr/>
<h2>ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°å‰å¾Œã®ãƒ¢ãƒ‡ãƒ«æ€§èƒ½æ¯”è¼ƒ</h2>
<p>ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã«ã‚ˆã‚‹åŠ¹æœã‚’ç¢ºèªã™ã‚‹ãŸã‚ã€åŒã˜å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ãƒ¢ãƒ‡ãƒ«ã®äºˆæ¸¬çµæœã‚’æ¯”è¼ƒã—ã¾ã™ã€‚</p>
<h3>ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°å‰ã®ãƒ¢ãƒ‡ãƒ«ã§æ¨è«–</h3>
<p>ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§æ¨è«–ã‚’è¡Œã„ã¾ã™ã€‚</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(286, 60%, 67%)">from</span><span> transformers </span><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> AutoTokenizer</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> AutoModelForSequenceClassification
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">import</span><span> numpy </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> np
</span>
<span>model_path </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;google-bert/bert-base-cased&#x27;</span><span>
</span><span>tokenizer </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> AutoTokenizer</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>from_pretrained</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>model_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>model </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> AutoModelForSequenceClassification</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>from_pretrained</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>model_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>text </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;I visit this bar at first time. Service is good. Making drinks and talking with Bartender is also good. I spend good 2 hours. I will come again next month.&quot;</span><span>
</span><span>inputs </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> tokenizer</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>text</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> return_tensors</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;pt&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> padding</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">True</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> truncation</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">True</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>outputs </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> model</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">**</span><span>inputs</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>predicted_class </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> np</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>argmax</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>outputs</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>logits</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>detach</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>numpy</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> axis</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>predicted_class</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span></code></pre></div></pre>
<p>å‡ºåŠ›çµæœï¼š</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-bash" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">0</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># é…åˆ—ãªã®ã§0å§‹ã¾ã‚Šã€‚0ã¯è©•ä¾¡1ã€‚</span></code></pre></div></pre>
<p>inputã®textã‹ã‚‰ã¯4ã‹5ã®é«˜è©•ä¾¡ã‚’æœŸå¾…ã—ã¾ã™ãŒã€è©•ä¾¡ãŒã€Œ1ã€ã¨ãªã‚Šã¾ã—ãŸã€‚</p>
<h3>ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°å¾Œã®ãƒ¢ãƒ‡ãƒ«ã§æ¨è«–</h3>
<p>åŒã˜ãƒ†ã‚­ã‚¹ãƒˆã‚’ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§æ¨è«–ã—ã¾ã™ã€‚</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-python" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>model_path </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;./finetuned/bert-base-cased&#x27;</span><span>
</span><span>tokenizer </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> AutoTokenizer</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>from_pretrained</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>model_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>model </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> AutoModelForSequenceClassification</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>from_pretrained</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>model_path</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span>
<span>text </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;I visit this bar at first time. Service is good. Making drinks and talking with Bartender is also good. I spend good 2 hours. I will come again next month.&quot;</span><span>
</span><span>inputs </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> tokenizer</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>text</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> return_tensors</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;pt&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> padding</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">True</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> truncation</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(29, 54%, 61%)">True</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>outputs </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> model</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">**</span><span>inputs</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>predicted_class </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> np</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>argmax</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>outputs</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>logits</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>detach</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>numpy</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> axis</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">print</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>predicted_class</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span></code></pre></div></pre>
<p>å‡ºåŠ›çµæœï¼š</p>
<pre><div class="relative my-4"><button class="absolute top-2 right-2 text-xs bg-gray-700 text-white px-2 py-1 rounded hover:bg-gray-600">Copy</button><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:break-word;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0.75rem;margin:0;overflow:auto;border-radius:0.5rem;overflow-x:auto"><code class="language-bash" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>ã€€</span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># é…åˆ—ãªã®ã§0å§‹ã¾ã‚Šã€‚4ã¯è©•ä¾¡5ã€‚</span></code></pre></div></pre>
<p>ã“ã®çµæœã¯ã€ã‚ˆã‚Šæ­£ç¢ºãªè©•ä¾¡ã¨ãªã£ã¦ãŠã‚Šã€ãƒ¢ãƒ‡ãƒ«ãŒæ”¹å–„ã•ã‚ŒãŸã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚</p>
<h2>ã¾ã¨ã‚</h2>
<p>ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã¯ã€<code class="bg-yellow-200 font-mono px-[0.3rem] py-[0.1rem] rounded whitespace-nowrap text-inherit">transformers</code>ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦LLMã®ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’è¡Œã„ã€ã‚ãšã‹500ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã§ã‚‚ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ãŒå‘ä¸Šã™ã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã¾ã—ãŸã€‚</p>
<p>æœ¬è¨˜äº‹ã§ç´¹ä»‹ã—ãŸæ‰‹é †ã¯ã€ã‚ãã¾ã§å­¦ç¿’ç›®çš„ã§ã™ã€‚</p>
<p>æœ¬æ ¼çš„ãªæ¡ˆä»¶ã§ã¯ã€ã‚ˆã‚Šå¤§è¦æ¨¡ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚„é«˜æ€§èƒ½ãªãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚</p>
<h3>å­¦ã³ã®ãƒã‚¤ãƒ³ãƒˆ</h3>
<ol>
<li>LLMã®åŸºæœ¬æ“ä½œã¨ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚ºã®ä»•çµ„ã¿ãŒç†è§£ã§ãã‚‹ã€‚</li>
<li>Hugging Faceã®ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã‚’æ´»ç”¨ã™ã‚‹æ–¹æ³•ãŒç¿’å¾—ã§ãã‚‹ã€‚</li>
<li>ç°¡å˜ãªãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã«ã‚ˆã‚‹ãƒ¢ãƒ‡ãƒ«ã®æ”¹å–„åŠ¹æœã‚’ç¢ºèªã§ãã‚‹ã€‚</li>
</ol>
<p>ä»Šå¾Œã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚„å€‹äººå­¦ç¿’ã«ãœã²å½¹ç«‹ã¦ã¦ãã ã•ã„ã€‚</p>
<hr/>
<h1>å‚è€ƒ</h1>
<ul>
<li><a href="https://huggingface.co/docs/transformers/training" target="_blank" rel="noopener noreferrer" class="text-blue-600 underline">https://huggingface.co/docs/transformers/training</a></li>
<li><a href="https://huggingface.co/docs/transformers/installation" target="_blank" rel="noopener noreferrer" class="text-blue-600 underline">https://huggingface.co/docs/transformers/installation</a></li>
<li><a href="https://huggingface.co/datasets/Yelp/yelp_review_full" target="_blank" rel="noopener noreferrer" class="text-blue-600 underline">https://huggingface.co/datasets/Yelp/yelp_review_full</a></li>
</ul>
<hr/><div class="text-center mt-8"><a class="inline-block bg-gray-800 text-white no-underline px-4 py-2 rounded hover:bg-gray-700" href="/">â† è¨˜äº‹ä¸€è¦§ã«æˆ»ã‚‹</a></div><div class="my-12 text-center"><p class="font-bold text-gray-800">åˆåŒä¼šç¤¾raisexã§ã¯ä¸€ç·’ã«åƒãä»²é–“ã‚’å‹Ÿé›†ä¸­ã§ã™ã€‚</p><p class="text-sm text-gray-600 mb-4">ã”èˆˆå‘³ã®ã‚ã‚‹æ–¹ã¯ä»¥ä¸‹ã®æ¡ç”¨æƒ…å ±ã‚’ã”ç¢ºèªãã ã•ã„ã€‚</p><div class="flex justify-center"><div class="engage-recruit-widget" data-height="300" data-width="500" data-url="https://en-gage.net/raisex_jobs/widget/?banner=1"></div></div></div></article></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"id":263,"documentId":"nyg7h5f0xw60bpk88glrh4zo","title":"LLMãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«","content":"è¿‘å¹´ã€è‡ªç„¶è¨€èªå‡¦ç†ï¼ˆNLPï¼‰ã®åˆ†é‡ã§ã¯å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ï¼ˆLLMï¼‰ã®æ´»ç”¨ãŒæ€¥é€Ÿã«é€²ã‚“ã§ã„ã¾ã™ã€‚ç‰¹ã«ã€ç‰¹å®šã®ã‚¿ã‚¹ã‚¯å‘ã‘ã«ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚’å‘ä¸Šã•ã›ã‚‹ã€Œãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã€ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã®éœ€è¦ãŒå¢—ãˆã¤ã¤ã‚ã‚Šã¾ã™ã€‚\n\næœ¬è¨˜äº‹ã§ã¯ã€åˆå¿ƒè€…ã®æ–¹ã§ã‚‚ç†è§£ã—ã‚„ã™ã„ã‚ˆã†ã«ã€ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®åŸºæœ¬çš„ãªæµã‚Œã‚’ä½“é¨“ã§ãã‚‹ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’ç”¨æ„ã—ã¾ã—ãŸã€‚\n\n---\n\n# ç’°å¢ƒè¨­å®šã¨äº‹å‰æº–å‚™\n\nã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã¯ã€macOSç’°å¢ƒï¼ˆä¾‹: M2 MacBook Proï¼‰ã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ã¦ã„ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ä»®æƒ³ç’°å¢ƒã‚’ä½œæˆã—ã€å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã—ã‚‡ã†ã€‚\n\n### ä»®æƒ³ç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—\n\n```bash\npython -m venv .env\nsource .env/bin/activate\n```\n\n### å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«\n\nä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€å¿…è¦ãªPythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚\n\n```bash\npip install transformers datasets evaluate accelerate scikit-learn torch\n\n```\n\n### å‹•ä½œç¢ºèª\n\nãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒæ­£ã—ãã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸã‹ç¢ºèªã™ã‚‹ãŸã‚ã«ã€ä»¥ä¸‹ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚\n\n```bash\npython -c \"from transformers import pipeline; print(pipeline('sentiment-analysis')('we love you'))\"\n\n```\n\næœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›ï¼š\n\n```bash\n[{'label': 'POSITIVE', 'score': 0.9998704195022583}]\n\n```\n---\n\n# ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä½œæˆã¨å®Ÿè¡Œ\n\nãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®æ‰‹é †ã‚’ç¤ºã—ãŸPythonã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆ`finetune.py`ï¼‰ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã¯ã€[Yelpãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ](https://huggingface.co/datasets/Yelp/yelp_review_full)ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚\n\n### `finetune.py`\n\n```python\nfrom datasets import load_dataset\nfrom transformers import AutoTokenizer, AutoModelForSequenceClassification, TrainingArguments, Trainer\nimport numpy as np\nimport evaluate\n\n# ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®æº–å‚™\ndataset = load_dataset(\"yelp_review_full\")\n\n# ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã«ã‚ˆã‚‹ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚º\ntokenizer = AutoTokenizer.from_pretrained(\"google-bert/bert-base-cased\")\ndef tokenize_function(examples):\n    return tokenizer(examples[\"text\"], padding=\"max_length\", truncation=True)\ntokenized_datasets = dataset.map(tokenize_function, batched=True)\n\n# å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆ\nsmall_train_dataset = tokenized_datasets[\"train\"].shuffle(seed=42).select(range(500))\nsmall_eval_dataset = tokenized_datasets[\"test\"].shuffle(seed=42).select(range(500))\n\n# ãƒ¢ãƒ‡ãƒ«ã®ãƒ­ãƒ¼ãƒ‰\nmodel = AutoModelForSequenceClassification.from_pretrained(\"google-bert/bert-base-cased\", num_labels=5, torch_dtype=\"auto\")\n\n# è©•ä¾¡é–¢æ•°\nmetric = evaluate.load(\"accuracy\")\ndef compute_metrics(eval_pred):\n    logits, labels = eval_pred\n    predictions = np.argmax(logits, axis=-1)\n    return metric.compute(predictions=predictions, references=labels)\n\n# å­¦ç¿’è¨­å®š\ntraining_args = TrainingArguments(output_dir=\"test_trainer\", eval_strategy=\"epoch\")\ntrainer = Trainer(\n    model=model,\n    args=training_args,\n    train_dataset=small_train_dataset,\n    eval_dataset=small_eval_dataset,\n    compute_metrics=compute_metrics,\n)\n\n# å­¦ç¿’ã®å®Ÿè¡Œ\ntrainer.train()\n\n# ãƒ¢ãƒ‡ãƒ«ã¨ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã®ä¿å­˜\nsave_dir = './finetuned/bert-base-cased'\ntokenizer.save_pretrained(save_dir)\nmodel.save_pretrained(save_dir)\n```\n\n### å®Ÿè¡Œçµæœ\n\nã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªè©•ä¾¡çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\n\n```bash\npython3 finetune.py\n\n{'eval_loss': 1.5970934629440308, 'eval_accuracy': 0.242, 'eval_runtime': 39.0603, 'eval_samples_per_second': 12.801, 'eval_steps_per_second': 1.613, 'epoch': 1.0}                                                                               \n{'eval_loss': 1.468526840209961, 'eval_accuracy': 0.346, 'eval_runtime': 36.1194, 'eval_samples_per_second': 13.843, 'eval_steps_per_second': 1.744, 'epoch': 2.0}                                                                                \n{'eval_loss': 1.4037985801696777, 'eval_accuracy': 0.368, 'eval_runtime': 35.7517, 'eval_samples_per_second': 13.985, 'eval_steps_per_second': 1.762, 'epoch': 3.0}                                                                               \n{'train_runtime': 467.6126, 'train_samples_per_second': 3.208, 'train_steps_per_second': 0.404, 'train_loss': 1.5324497121982474, 'epoch': 3.0}                                                                                                   \n100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 189/189 [07:47\u003c00:00,  2.47s/it]\n```\n\n---\n\n## ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è§£èª¬\n\nä»¥ä¸‹ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚¹ã‚¯ãƒªãƒ—ãƒˆ `finetune.py` ã®å„ãƒ‘ãƒ¼ãƒˆã‚’è©³ã—ãè§£èª¬ã—ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚\n\n---\n\n### 1. ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ãƒ­ãƒ¼ãƒ‰\n\n```python\ndataset = load_dataset(\"yelp_review_full\")\n```\n\n### è§£èª¬ï¼š\n\n- Hugging Faceã®`datasets`ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ã€Yelpã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¯ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆã¨1~5ã®è©•ä¾¡ã‚¹ã‚³ã‚¢ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚\n\n### ãƒã‚¤ãƒ³ãƒˆï¼š\n\n- **ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ç¨®é¡**ï¼šHugging Faceã®`load_dataset`ã‚’ä½¿ãˆã°ã€è±Šå¯Œãªäº‹å‰æ§‹ç¯‰ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ç°¡å˜ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã€‚\n- **ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ãƒ¼ã‚¿ã®åˆ©ç”¨**ï¼šè‡ªåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã„ãŸã„å ´åˆã€CSVã‚„JSONå½¢å¼ã§èª­ã¿è¾¼ã‚€ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚\n\n---\n\n### 2. ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚º\n\n```python\ntokenizer = AutoTokenizer.from_pretrained(\"google-bert/bert-base-cased\")\n\ndef tokenize_function(examples):\n    return tokenizer(examples[\"text\"], padding=\"max_length\", truncation=True)\ntokenized_datasets = dataset.map(tokenize_function, batched=True)\n```\n\n### è§£èª¬ï¼š\n\n- ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã‚’ä½¿ã£ã¦ãƒ†ã‚­ã‚¹ãƒˆã‚’æ•°å€¤ãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¢ãƒ‡ãƒ«ãŒæ‰±ãˆã‚‹å½¢å¼ã«æ•´ãˆã‚‰ã‚Œã¾ã™ã€‚\n- `padding=\"max_length\"`ã§å›ºå®šé•·ã®å…¥åŠ›ã«æƒãˆã€`truncation=True`ã§æœ€å¤§ãƒˆãƒ¼ã‚¯ãƒ³æ•°ã‚’è¶…ãˆãŸéƒ¨åˆ†ã‚’ã‚«ãƒƒãƒˆã—ã¾ã™ã€‚\n\n### ãƒã‚¤ãƒ³ãƒˆï¼š\n\n- **ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã®é¸æŠ**ï¼šãƒ¢ãƒ‡ãƒ«ã«å¯¾å¿œã™ã‚‹ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒé‡è¦ï¼ˆä¾‹: BERTãƒ¢ãƒ‡ãƒ«ãªã‚‰BERTç”¨ã®ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ï¼‰ã€‚\n- **åŠ¹ç‡åŒ–**ï¼š`batched=True`ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€åº¦ã«ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚ºã—ã¦å‡¦ç†é€Ÿåº¦ã‚’å‘ä¸Šã€‚\n\n---\n\n### 3. ãƒ‡ãƒ¼ã‚¿ã®åˆ†å‰²ã¨ç¸®å°\n\n```python\nsmall_train_dataset = tokenized_datasets[\"train\"].shuffle(seed=42).select(range(500))\nsmall_eval_dataset = tokenized_datasets[\"test\"].shuffle(seed=42).select(range(500))\n\n```\n\n### è§£èª¬ï¼š\n\n- è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨è©•ä¾¡ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†å‰²ã—ã€ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ç”¨ã«ã‚µãƒ–ã‚»ãƒƒãƒˆï¼ˆ500ä»¶ï¼‰ã‚’ä½œæˆã—ã¾ã™ã€‚\n- `shuffle(seed=42)`ã¯ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ä¸¦ã³æ›¿ãˆã¾ã™ãŒã€åŒã˜çµæœã‚’å†ç¾ã™ã‚‹ãŸã‚ã‚·ãƒ¼ãƒ‰å€¤ã‚’è¨­å®šã—ã¦ã„ã¾ã™ã€‚\n\n### ãƒã‚¤ãƒ³ãƒˆï¼š\n\n- **ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã®èª¿æ•´**ï¼šå­¦ç¿’æ™‚é–“ã‚„ãƒªã‚½ãƒ¼ã‚¹ã®åˆ¶ç´„ã«åˆã‚ã›ã¦ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã‚’é¸æŠã§ãã¾ã™ã€‚\n- **å°è¦æ¨¡å­¦ç¿’ã®ãƒ¡ãƒªãƒƒãƒˆ**ï¼šå°è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã§ã‚‚ãƒ¢ãƒ‡ãƒ«ã®å‹•ä½œç¢ºèªã‚„ç†è§£ãŒå¯èƒ½ã€‚\n\n---\n\n### 4. ãƒ¢ãƒ‡ãƒ«ã®ãƒ­ãƒ¼ãƒ‰\n\n```python\nmodel = AutoModelForSequenceClassification.from_pretrained(\n    \"google-bert/bert-base-cased\",\n    num_labels=5,\n    torch_dtype=\"auto\"\n)\n```\n\n### è§£èª¬ï¼š\n\n- Hugging Faceã‹ã‚‰äº‹å‰å­¦ç¿’æ¸ˆã¿ã®BERTãƒ¢ãƒ‡ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã€åˆ†é¡ã‚¿ã‚¹ã‚¯ç”¨ã«èª¿æ•´ã—ã¾ã™ã€‚\n- `num_labels=5`ã¯åˆ†é¡ã‚¯ãƒ©ã‚¹ã®æ•°ï¼ˆYelpã®è©•ä¾¡ã‚¹ã‚³ã‚¢1~5ï¼‰ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚\n\n### ãƒã‚¤ãƒ³ãƒˆï¼š\n\n- **äº‹å‰å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®å†åˆ©ç”¨**ï¼šå¤§è¦æ¨¡ãªäº‹å‰å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€å°‘ãªã„ãƒ‡ãƒ¼ã‚¿ã§ã‚‚è‰¯ã„çµæœãŒå¾—ã‚‰ã‚Œã‚‹ã€‚\n- **ãƒ¢ãƒ‡ãƒ«ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º**ï¼šåˆ†é¡ã‚¯ãƒ©ã‚¹æ•°ã‚„å‡ºåŠ›å±¤ã‚’èª¿æ•´ã—ã¦ç‰¹å®šã®ã‚¿ã‚¹ã‚¯ã«é©å¿œã€‚\n\n---\n\n### 5. è©•ä¾¡é–¢æ•°ã®è¨­å®š\n\n```python\nmetric = evaluate.load(\"accuracy\")\ndef compute_metrics(eval_pred):\n    logits, labels = eval_pred\n    predictions = np.argmax(logits, axis=-1)\n    return metric.compute(predictions=predictions, references=labels)\n```\n\n### è§£èª¬ï¼š\n\n- `evaluate`ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ã€ãƒ¢ãƒ‡ãƒ«ã®ç²¾åº¦ï¼ˆaccuracyï¼‰ã‚’è©•ä¾¡ã™ã‚‹é–¢æ•°ã‚’å®šç¾©ã—ã¦ã„ã¾ã™ã€‚\n- æ¨è«–çµæœï¼ˆ`logits`ï¼‰ã‚’`argmax`ã§äºˆæ¸¬ãƒ©ãƒ™ãƒ«ã«å¤‰æ›ã—ã€å®Ÿéš›ã®ãƒ©ãƒ™ãƒ«ã¨æ¯”è¼ƒã—ã¦ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã—ã¾ã™ã€‚\n\n### ãƒã‚¤ãƒ³ãƒˆï¼š\n\n- **è©•ä¾¡æŒ‡æ¨™ã®é¸æŠ**ï¼šåˆ†é¡ã‚¿ã‚¹ã‚¯ã§ã¯`accuracy`ãŒä¸€èˆ¬çš„ã§ã™ãŒã€ã‚¿ã‚¹ã‚¯ã«å¿œã˜ã¦`precision`ã‚„`recall`ã‚‚æ¤œè¨ã™ã¹ãã§ã™ã€‚\n- **ç°¡å˜ãªå®Ÿè£…**ï¼š`evaluate`ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†ã¨ã€ä¸€èˆ¬çš„ãªè©•ä¾¡æŒ‡æ¨™ã‚’ç°¡å˜ã«åˆ©ç”¨å¯èƒ½ã€‚\n\n---\n\n### 6. å­¦ç¿’è¨­å®š\n\n```python\ntraining_args = TrainingArguments(\n    output_dir=\"test_trainer\",\n    eval_strategy=\"epoch\"\n)\n\ntrainer = Trainer(\n    model=model,\n    args=training_args,\n    train_dataset=small_train_dataset,\n    eval_dataset=small_eval_dataset,\n    compute_metrics=compute_metrics,\n)\n\n```\n\n### è§£èª¬ï¼š\n\n- `TrainingArguments`ã§å­¦ç¿’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã“ã§ã¯ã€ãƒ¢ãƒ‡ãƒ«ä¿å­˜å…ˆï¼ˆ`output_dir`ï¼‰ã¨è©•ä¾¡ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼ˆ`eval_strategy=\"epoch\"`ï¼‰ã‚’è¨­å®šã€‚\n- `Trainer`ã‚¯ãƒ©ã‚¹ã¯ã€å­¦ç¿’ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç°¡ç•¥åŒ–ã™ã‚‹ãŸã‚ã®é«˜ãƒ¬ãƒ™ãƒ«APIã§ã™ã€‚\n\n### ãƒã‚¤ãƒ³ãƒˆï¼š\n\n- **ç°¡å˜ãªå­¦ç¿’ç®¡ç†**ï¼š`Trainer`ã‚’ä½¿ã†ã¨ã€ãƒ«ãƒ¼ãƒ—ã®ä½œæˆã‚„å‹¾é…è¨ˆç®—ã®å®Ÿè£…ã‚’æ°—ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã›ã‚“ã€‚\n- **è¨­å®šã®æŸ”è»Ÿæ€§**ï¼šå­¦ç¿’ç‡ã‚„ãƒãƒƒãƒã‚µã‚¤ã‚ºãªã©ã®è©³ç´°è¨­å®šã‚‚å¯èƒ½ã§ã™ã€‚\n\n---\n\n### 7. ãƒ¢ãƒ‡ãƒ«ã®ä¿å­˜\n\n```python\ntokenizer.save_pretrained('./finetuned/bert-base-cased')\nmodel.save_pretrained('./finetuned/bert-base-cased')\n```\n\n### è§£èª¬ï¼š\n\n- ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°å¾Œã®ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã¨ãƒ¢ãƒ‡ãƒ«ã‚’ä¿å­˜ã—ã¾ã™ã€‚ã“ã®ä¿å­˜æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã¯ã€å°†æ¥çš„ã«æ¨è«–ã‚„ã•ã‚‰ãªã‚‹èª¿æ•´ã«ä½¿ç”¨ã§ãã¾ã™ã€‚\n\n### ãƒã‚¤ãƒ³ãƒˆï¼š\n\n- **å†åˆ©ç”¨æ€§ã®å‘ä¸Š**ï¼šãƒ¢ãƒ‡ãƒ«ã‚’ä¿å­˜ã—ã¦ãŠãã“ã¨ã§ã€ä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚„ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã«æ´»ç”¨å¯èƒ½ã€‚\n- **Hugging Faceäº’æ›**ï¼šä¿å­˜å½¢å¼ã¯Hugging Faceãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã®å†åˆ©ç”¨ã«æœ€é©åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚\n\n---\n\n## ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°å‰å¾Œã®ãƒ¢ãƒ‡ãƒ«æ€§èƒ½æ¯”è¼ƒ\n\nãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã«ã‚ˆã‚‹åŠ¹æœã‚’ç¢ºèªã™ã‚‹ãŸã‚ã€åŒã˜å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ãƒ¢ãƒ‡ãƒ«ã®äºˆæ¸¬çµæœã‚’æ¯”è¼ƒã—ã¾ã™ã€‚\n\n### ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°å‰ã®ãƒ¢ãƒ‡ãƒ«ã§æ¨è«–\n\nä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§æ¨è«–ã‚’è¡Œã„ã¾ã™ã€‚\n\n```python\nfrom transformers import AutoTokenizer, AutoModelForSequenceClassification\nimport numpy as np\n\nmodel_path = 'google-bert/bert-base-cased'\ntokenizer = AutoTokenizer.from_pretrained(model_path)\nmodel = AutoModelForSequenceClassification.from_pretrained(model_path)\n\ntext = \"I visit this bar at first time. Service is good. Making drinks and talking with Bartender is also good. I spend good 2 hours. I will come again next month.\"\ninputs = tokenizer(text, return_tensors=\"pt\", padding=True, truncation=True)\noutputs = model(**inputs)\npredicted_class = np.argmax(outputs.logits.detach().numpy(), axis=-1)\nprint(predicted_class)\n\n```\n\nå‡ºåŠ›çµæœï¼š\n\n```bash\n[0] # é…åˆ—ãªã®ã§0å§‹ã¾ã‚Šã€‚0ã¯è©•ä¾¡1ã€‚\n```\n\ninputã®textã‹ã‚‰ã¯4ã‹5ã®é«˜è©•ä¾¡ã‚’æœŸå¾…ã—ã¾ã™ãŒã€è©•ä¾¡ãŒã€Œ1ã€ã¨ãªã‚Šã¾ã—ãŸã€‚\n\n### ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°å¾Œã®ãƒ¢ãƒ‡ãƒ«ã§æ¨è«–\n\nåŒã˜ãƒ†ã‚­ã‚¹ãƒˆã‚’ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§æ¨è«–ã—ã¾ã™ã€‚\n\n```python\nmodel_path = './finetuned/bert-base-cased'\ntokenizer = AutoTokenizer.from_pretrained(model_path)\nmodel = AutoModelForSequenceClassification.from_pretrained(model_path)\n\ntext = \"I visit this bar at first time. Service is good. Making drinks and talking with Bartender is also good. I spend good 2 hours. I will come again next month.\"\ninputs = tokenizer(text, return_tensors=\"pt\", padding=True, truncation=True)\noutputs = model(**inputs)\npredicted_class = np.argmax(outputs.logits.detach().numpy(), axis=-1)\nprint(predicted_class)\n\n```\n\nå‡ºåŠ›çµæœï¼š\n\n```bash\n[4]ã€€# é…åˆ—ãªã®ã§0å§‹ã¾ã‚Šã€‚4ã¯è©•ä¾¡5ã€‚\n```\n\nã“ã®çµæœã¯ã€ã‚ˆã‚Šæ­£ç¢ºãªè©•ä¾¡ã¨ãªã£ã¦ãŠã‚Šã€ãƒ¢ãƒ‡ãƒ«ãŒæ”¹å–„ã•ã‚ŒãŸã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚\n\n## ã¾ã¨ã‚\n\nã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã¯ã€`transformers`ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦LLMã®ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’è¡Œã„ã€ã‚ãšã‹500ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã§ã‚‚ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ãŒå‘ä¸Šã™ã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã¾ã—ãŸã€‚\n\næœ¬è¨˜äº‹ã§ç´¹ä»‹ã—ãŸæ‰‹é †ã¯ã€ã‚ãã¾ã§å­¦ç¿’ç›®çš„ã§ã™ã€‚\n\næœ¬æ ¼çš„ãªæ¡ˆä»¶ã§ã¯ã€ã‚ˆã‚Šå¤§è¦æ¨¡ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚„é«˜æ€§èƒ½ãªãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚\n\n### å­¦ã³ã®ãƒã‚¤ãƒ³ãƒˆ\n\n1. LLMã®åŸºæœ¬æ“ä½œã¨ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚ºã®ä»•çµ„ã¿ãŒç†è§£ã§ãã‚‹ã€‚\n2. Hugging Faceã®ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã‚’æ´»ç”¨ã™ã‚‹æ–¹æ³•ãŒç¿’å¾—ã§ãã‚‹ã€‚\n3. ç°¡å˜ãªãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã«ã‚ˆã‚‹ãƒ¢ãƒ‡ãƒ«ã®æ”¹å–„åŠ¹æœã‚’ç¢ºèªã§ãã‚‹ã€‚\n\nä»Šå¾Œã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚„å€‹äººå­¦ç¿’ã«ãœã²å½¹ç«‹ã¦ã¦ãã ã•ã„ã€‚\n\n---\n\n# å‚è€ƒ\n\n- https://huggingface.co/docs/transformers/training\n- https://huggingface.co/docs/transformers/installation\n- https://huggingface.co/datasets/Yelp/yelp_review_full\n\n---\n\n","createdAt":"2025-05-19T08:50:57.925Z","updatedAt":"2025-06-05T23:56:30.135Z","publishedAt":"2025-06-05T23:56:30.144Z","docId":"y98x06tmbaz9hb7fleb7jpiq","tags":[{"id":20,"documentId":"fbllyhmskvu2l7wbg5dzpkri","createdAt":"2025-05-19T09:48:50.341Z","updatedAt":"2025-05-19T09:48:50.341Z","publishedAt":"2025-05-19T09:48:50.348Z","name":"LLM"},{"id":4,"documentId":"zc573y83cxbfql2umdwbhot9","createdAt":"2025-05-19T09:44:33.028Z","updatedAt":"2025-05-19T09:44:33.028Z","publishedAt":"2025-05-19T09:44:33.035Z","name":"Tutorial"},{"id":30,"documentId":"d99cu6c3t9hgwynppb92lhph","createdAt":"2025-05-19T09:50:59.080Z","updatedAt":"2025-05-19T09:50:59.080Z","publishedAt":"2025-05-19T09:50:59.086Z","name":"ç”ŸæˆAI"}],"thumbnail":[{"id":19,"documentId":"qqgjmycd7ycoo6gwkv2zp97w","name":"20250513-15.png","alternativeText":null,"caption":null,"width":1504,"height":844,"formats":{"thumbnail":{"name":"thumbnail_20250513-15.png","hash":"thumbnail_20250513_15_a017e8a63e","ext":".png","mime":"image/png","path":null,"width":245,"height":137,"size":10.45,"sizeInBytes":10451,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/thumbnail_20250513_15_a017e8a63e.png"},"large":{"name":"large_20250513-15.png","hash":"large_20250513_15_a017e8a63e","ext":".png","mime":"image/png","path":null,"width":1000,"height":561,"size":53.11,"sizeInBytes":53109,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/large_20250513_15_a017e8a63e.png"},"medium":{"name":"medium_20250513-15.png","hash":"medium_20250513_15_a017e8a63e","ext":".png","mime":"image/png","path":null,"width":750,"height":421,"size":38.07,"sizeInBytes":38070,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_15_a017e8a63e.png"},"small":{"name":"small_20250513-15.png","hash":"small_20250513_15_a017e8a63e","ext":".png","mime":"image/png","path":null,"width":500,"height":281,"size":23.51,"sizeInBytes":23510,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/small_20250513_15_a017e8a63e.png"}},"hash":"20250513_15_a017e8a63e","ext":".png","mime":"image/png","size":16.18,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/20250513_15_a017e8a63e.png","previewUrl":null,"provider":"@strapi/provider-upload-aws-s3","provider_metadata":null,"createdAt":"2025-05-20T07:47:33.931Z","updatedAt":"2025-05-20T07:47:33.931Z","publishedAt":"2025-05-20T07:47:33.931Z"}]}},"__N_SSG":true},"page":"/articles/[id]","query":{"id":"nyg7h5f0xw60bpk88glrh4zo"},"buildId":"wdcbjCbp8DYGqTQVAi4UF","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>