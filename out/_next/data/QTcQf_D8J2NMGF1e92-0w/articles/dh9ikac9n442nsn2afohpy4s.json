{"pageProps":{"article":{"id":195,"documentId":"dh9ikac9n442nsn2afohpy4s","title":"AWS CLIでのSSO認証","content":"企業におけるクラウド活用が一般化する中、適切なユーザ管理とセキュアな認証の仕組みが重要になっています。\n\nAWSのIAM Identity Centerを利用すると、効率的にユーザ管理とシングルサインオン（SSO）認証を実現できます。\n\n本記事では、IAM Identity Centerを使ったユーザ管理、AWS CLIでのSSO設定手順を詳しく解説します。\n\n---\n\n# IAM Identity Centerとは？\n\nIAM Identity Center（旧AWS SSO）は、AWSの各種サービスやアカウントへのアクセスを一元管理できるサービスです。以下のような特徴があります：\n\n- ユーザとグループの管理を一元化\n- アクセス許可の簡易設定\n- AWSアカウントやサードパーティアプリケーションへのSSOをサポート\n\nこれにより、ユーザ体験を向上させるとともに、セキュリティリスクを軽減することができます。\n\n---\n\n# ユーザ登録とSSO準備\n\nIAM Identity Centerを使用するには、まずユーザ登録が必要です。\n\nユーザ登録が完了すると、AWSアクセスポータルにログインできる状態になります。このポータルを通じて、各AWSアカウントへのアクセスがシームレスになります。\n\n---\n\n# AWS CLIでのSSO設定\n\nAWS CLIを利用して業務を効率化する場合、CLIにSSOを設定する必要があります。以下に手順を示します。\n\n## 1. 認証情報の確認\n\nAWSアクセスポータルにログインし、自分の認証情報を確認します。この情報は設定ファイル作成時に必要です。\n\n![スクリーンショット 2024-12-02 17.48.50.png](https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/2024_12_02_17_48_50_d8a6782947.png\n)\n\n---\n\n## 2. `~/.aws/config` ファイルの作成\n\n以下のように設定ファイルを作成します。エディタで`~/.aws/config`を開き、次の内容を追加してください：\n\n```bash\n[profile your_profile]\nsso_session = session_name\nsso_account_id = xxxxxxxxxx\nsso_role_name = PowerUserAccess\nregion = ap-northeast-1\noutput = json\n\n[sso-session session_name]\nsso_start_url = https://randomId.awsapps.com/start/#\nsso_region = ap-northeast-1\nsso_registration_scopes = sso:account:access\n\n```\n\n### ポイント\n\n- `profile` 名は分かりやすい名前にしましょう（例：アカウント名やロール名を基にする）。\n- `sso_start_url` はIAM Identity Centerで設定されたURLを指定します。\n\n---\n\n## 3. SSOログイン\n\n1. ターミナルで次のコマンドを実行し、SSOログインを行います：\n\n```bash\naws sso login --profile your_profile\n```\n\nコマンド実行後、ブラウザが自動で開き、AWSアクセスポータルへ移動します。\n\nターミナルではこのような内容が出力されます。\n\n```bash\nAttempting to automatically open the SSO authorization page in your default browser.\nIf the browser does not open or you wish to use a different device to authorize this request, open the following URL:\n\nhttps://device.sso.ap-northeast-1.amazonaws.com/\n\nThen enter the code:\n\nMJKM-RHLP\n```\n\n1. AWSアクセスポータルで認証が開始、ターミナルに出力されたコードと一致しているかを確認します。\n    \n    ![スクリーンショット 2024-12-02 17.29.37.png](https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/2024_12_02_17_29_37_f54c533215.png)\n    \n2. Confirm and continueをクリックします。\n    \n    ![スクリーンショット 2024-12-02 17.29.55.png](https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/2024_12_02_17_29_55_d1a031be60.png)\n    \n3. アクセス許可をクリックします。\n    \n    ![スクリーンショット 2024-12-02 17.30.06.png](https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/2024_12_02_17_30_06_ac709b6131.png)\n    \n\n認証が完了しました。\n\n1. ターミナルに以下のメッセージが表示されればSSOログイン完了です:\n\n```bash\nSuccessfully logged into Start URL: https://randomId.awsapps.com/start/#\n```\n\n---\n\n## 4. AWS CLIコマンドの実行\n\nSSOで認証されたプロファイルを利用してAWS CLIコマンドを実行できます。例えば、S3バケットを確認する場合：\n\n```bash\naws s3 ls --profile your_profile\n\n```\n\nこれで、設定したSSOプロファイルを利用してAWSサービスにアクセスできます。\n\n---\n\n# まとめ\n\nIAM Identity Centerを利用する事で、複数アカウントやユーザのアクセス管理が大幅に簡素化されます。特にAWS CLIと組み合わせることで、業務効率の向上が期待できます。設定に少し手間はかかりますが、一度設定すれば簡単にSSO認証を利用できるようになります。\n\nこれを機に、IAM Identity Centerを活用してセキュアで効率的な環境を構築してみてはいかがですか？\n\n---\n","createdAt":"2025-05-19T08:50:57.366Z","updatedAt":"2025-06-01T23:29:39.390Z","publishedAt":"2025-06-01T23:29:39.403Z","docId":"v7135wdf58ypdxtfuh6dhpb4","tags":[{"id":10,"documentId":"cxt2tbnsy05cazm17p3pp1a3","createdAt":"2025-05-19T09:46:58.860Z","updatedAt":"2025-05-19T09:46:58.860Z","publishedAt":"2025-05-19T09:46:58.868Z","name":"AWS"}],"thumbnail":[{"id":11,"documentId":"gluteme29k36im7b37dzb4q2","name":"20250513-07.png","alternativeText":null,"caption":null,"width":1503,"height":844,"formats":{"thumbnail":{"name":"thumbnail_20250513-07.png","hash":"thumbnail_20250513_07_7d3532e9bb","ext":".png","mime":"image/png","path":null,"width":245,"height":138,"size":9.14,"sizeInBytes":9144,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/thumbnail_20250513_07_7d3532e9bb.png"},"large":{"name":"large_20250513-07.png","hash":"large_20250513_07_7d3532e9bb","ext":".png","mime":"image/png","path":null,"width":1000,"height":562,"size":50.36,"sizeInBytes":50361,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/large_20250513_07_7d3532e9bb.png"},"medium":{"name":"medium_20250513-07.png","hash":"medium_20250513_07_7d3532e9bb","ext":".png","mime":"image/png","path":null,"width":750,"height":421,"size":35.53,"sizeInBytes":35535,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_07_7d3532e9bb.png"},"small":{"name":"small_20250513-07.png","hash":"small_20250513_07_7d3532e9bb","ext":".png","mime":"image/png","path":null,"width":500,"height":281,"size":21.4,"sizeInBytes":21402,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/small_20250513_07_7d3532e9bb.png"}},"hash":"20250513_07_7d3532e9bb","ext":".png","mime":"image/png","size":15.22,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/20250513_07_7d3532e9bb.png","previewUrl":null,"provider":"@strapi/provider-upload-aws-s3","provider_metadata":null,"createdAt":"2025-05-20T07:43:09.231Z","updatedAt":"2025-05-20T07:43:09.231Z","publishedAt":"2025-05-20T07:43:09.232Z"}]}},"__N_SSG":true}