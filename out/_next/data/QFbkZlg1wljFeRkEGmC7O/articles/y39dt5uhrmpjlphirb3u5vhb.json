{"pageProps":{"article":{"id":270,"documentId":"y39dt5uhrmpjlphirb3u5vhb","title":"Docker Composeè¶…å…¥é–€ åˆå¿ƒè€…ã§ã‚‚ã™ãã«ä½¿ãˆã‚‹åŸºç¤ã‚¬ã‚¤ãƒ‰","content":"Dockerã‚’ä½¿ã†ã¨ã‚¢ãƒ—ãƒªã®ç’°å¢ƒã‚’ç°¡å˜ã«æ§‹ç¯‰å‡ºæ¥ã¾ã™ãŒã€è¤‡æ•°ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’æ‰±ã†å ´åˆã€ã‚³ãƒãƒ³ãƒ‰ãŒå¢—ãˆã¦é¢å€’ã«ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãã‚“ãªã¨ãã«å½¹ç«‹ã¤ã®ãŒ **Docker Compose** ã§ã™ï¼\n\næœ¬è¨˜äº‹ã§ã¯ã€Docker Composeã®åŸºæœ¬ã‹ã‚‰ã€ã‚ˆãä½¿ã†ã‚³ãƒãƒ³ãƒ‰ã€å®Ÿéš›ã«Nginxã¨Express.jsã‚’çµ„ã¿åˆã‚ã›ãŸã‚¢ãƒ—ãƒªã®ä½œæˆã¾ã§ã€ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã§è§£èª¬ã—ã¾ã™ã€‚\n\n---\n\n## 1. äº‹å‰æº–å‚™ï¼šDockerã¨Docker Composeã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«\n\nDocker Composeã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€ã¾ãš **Docker Desktop** ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\n\n### **Dockerã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**\n\nå…¬å¼ã‚µã‚¤ãƒˆã‹ã‚‰Dockerã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚\n\nğŸ”— [Dockerå…¬å¼ã‚µã‚¤ãƒˆ](https://www.docker.com/products/docker-desktop/)\n\n---\n\n## 2. `docker-compose.yml` ã‚’ä½œæˆã—ã¦ã¿ã‚ˆã†\n\nã¾ãšã¯ç°¡å˜ãª `docker-compose.yml` ã‚’ä½œæˆã—ã€ã‚³ãƒ³ãƒ†ãƒŠã‚’ç®¡ç†ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã—ã‚‡ã†ã€‚\n\n### **1ã¤ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’å®šç¾©**\n\nä»¥ä¸‹ã®YAMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€nginxã®Webã‚µãƒ¼ãƒãƒ¼ã‚’å‹•ã‹ã—ã¦ã¿ã¾ã™ã€‚\n\n```yaml\nversion: '3'\n\nservices:\n  web:\n    image: nginx\n    ports:\n      - \"80:80\"\n\n```\n\nã“ã®ä¾‹ã§ã¯ `web` ãŒã‚µãƒ¼ãƒ“ã‚¹åã«ãªã‚Šã¾ã™ã€‚\n\n### **èµ·å‹•**\n\nä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚\n\n```bash\ndocker-compose up -d\n```\n\n- `-d` ã¯ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³\n- ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://localhost` ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€Nginxã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\n\n### **çµ‚äº†**\n\n```bash\ndocker-compose down\n```\n\nã“ã‚Œã§ã‚³ãƒ³ãƒ†ãƒŠã¯åœæ­¢ãƒ»å‰Šé™¤ã•ã‚Œã¾ã™ã€‚\n\n---\n\n## 3. Docker Composeã®ã‚ˆãä½¿ã†ã‚³ãƒãƒ³ãƒ‰\n\nDocker Composeã‚’ä½¿ã†ã¨ã€è¤‡æ•°ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’ä¸€æ‹¬ã§ç®¡ç†ã§ãã¾ã™ã€‚ã“ã“ã§ã¯ã€ã‚ˆãä½¿ã†ã‚³ãƒãƒ³ãƒ‰ã‚’é †ç•ªã«ç´¹ä»‹ã—ã¾ã™ã€‚\n\n### â‘  ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•\n\n```bash\ndocker compose up\n```\n\n`docker compose up` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€`docker-compose.yml` ã«è¨˜è¼‰ã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹ï¼ˆã‚³ãƒ³ãƒ†ãƒŠï¼‰ãŒèµ·å‹•ã—ã¾ã™ã€‚\n\n### â‘¡ ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§èµ·å‹•\n\n```bash\ndocker compose up -d\n```\n\n- `-d` ã‚’ã¤ã‘ã‚‹ã¨ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§èµ·å‹•ã—ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’å æœ‰ã—ã¾ã›ã‚“ã€‚\n\n### â‘¢ ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã®ã¿èµ·å‹•\n\n```bash\ndocker compose up ã‚µãƒ¼ãƒ“ã‚¹å\n```\n\n`docker-compose.yml` ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã ã‘ã‚’èµ·å‹•ã—ãŸã„å ´åˆã¯ã€ã‚µãƒ¼ãƒ“ã‚¹åã‚’æŒ‡å®šã—ã¾ã™ã€‚\n\n### â‘£ ã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢ï¼†å‰Šé™¤\n\n```bash\ndocker compose down\n```\n\nèµ·å‹•ã—ãŸã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢ã—ã€å‰Šé™¤ã—ã¾ã™ã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚‚å‰Šé™¤ã•ã‚Œã‚‹ãŸã‚ã€å®Œå…¨ã«ã‚¯ãƒªãƒ¼ãƒ³ãªçŠ¶æ…‹ã«æˆ»ã—ãŸã„ã¨ãã«ä¾¿åˆ©ã§ã™ã€‚\n\n### â‘¤ ã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢\n\n```bash\ndocker compose stop\n```\n\nå®Ÿè¡Œä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢ã—ã¾ã™ã€‚ãŸã ã—ã€ã‚³ãƒ³ãƒ†ãƒŠè‡ªä½“ã¯å‰Šé™¤ã•ã‚Œãªã„ãŸã‚ã€å¾Œã§ `docker compose start` ã§å†é–‹ã§ãã¾ã™ã€‚\n\n### â‘¥ åœæ­¢ã—ãŸã‚³ãƒ³ãƒ†ãƒŠã‚’å†é–‹\n\n```bash\ndocker compose start\n```\n\n`docker compose stop` ã§åœæ­¢ã—ãŸã‚³ãƒ³ãƒ†ãƒŠã‚’å†ã³èµ·å‹•ã—ã¾ã™ã€‚\n\n### â‘¦ ã‚³ãƒ³ãƒ†ãƒŠã‚’å†èµ·å‹•\n\n```bash\ndocker compose restart\n```\n\nã‚³ãƒ³ãƒ†ãƒŠã‚’å†èµ·å‹•ã—ãŸã„ã¨ãã«ä½¿ã„ã¾ã™ã€‚è¨­å®šã‚’å¤‰æ›´ã—ãŸå ´åˆãªã©ã«ä¾¿åˆ©ã§ã™ã€‚\n\n### â‘§ å®Ÿè¡Œä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’ç¢ºèª\n\n```bash\ndocker compose ps\n```\n\nç¾åœ¨å‹•ä½œã—ã¦ã„ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã®çŠ¶æ…‹ã‚’ä¸€è¦§è¡¨ç¤ºã—ã¾ã™ã€‚\n\n### â‘¨ ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ã‚’è¡¨ç¤º\n\n```bash\ndocker compose logs\n```\n\nã‚³ãƒ³ãƒ†ãƒŠã®æ¨™æº–å‡ºåŠ›ï¼ˆãƒ­ã‚°ï¼‰ã‚’ç¢ºèªã§ãã¾ã™ã€‚\n\nãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ãƒ­ã‚°ã‚’è¿½ã„ãŸã„å ´åˆã¯ `-f` ã‚’ã¤ã‘ã¾ã™ã€‚\n\n```bash\ndocker compose logs -f\n```\n\n### â‘© ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’å‰Šé™¤\n\n```bash\ndocker compose rm -fsv ã‚µãƒ¼ãƒ“ã‚¹å\n```\n\nç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã®ã¿ã‚’å‰Šé™¤ã™ã‚‹ã¨ãã«ä½¿ç”¨ã—ã¾ã™ã€‚\n\nã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æ„å‘³ï¼š\n\n- `-f` å¼·åˆ¶å‰Šé™¤\n- `-s` ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚‚å‰Šé™¤\n- `-v` åå‰ä»˜ããƒœãƒªãƒ¥ãƒ¼ãƒ ã‚‚å‰Šé™¤\n\nã“ã‚Œã‚‰ã®ã‚³ãƒãƒ³ãƒ‰ã‚’è¦šãˆã¦ãŠã‘ã°ã€Docker Composeã‚’ã‚¹ãƒ ãƒ¼ã‚ºã«æ‰±ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼\n\n---\n\n## 4. Nginxã¨Express.jsã‚’çµ„ã¿åˆã‚ã›ãŸã‚¢ãƒ—ãƒªã‚’ä½œæˆ\n\nã“ã“ã‹ã‚‰ã¯ã€ã‚«ã‚¹ã‚¿ãƒ ã® `Dockerfile` ã¨ `docker-compose.yml` ã‚’ä½œæˆã—ã€ **Nginxã¨Express.jsã‚’ä½¿ã£ãŸHello Worldã‚¢ãƒ—ãƒª** ã‚’å®Ÿè£…ã—ã¾ã™ã€‚\n\n### **ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ**\n\n```bash\nmyapp/\nâ”‚â”€â”€ docker-compose.yml\nâ”‚â”€â”€ nginx/\nâ”‚   â””â”€â”€ default.conf\nâ””â”€â”€ app/\n    â”œâ”€â”€ Dockerfile\n    â”œâ”€â”€ package.json\n    â”œâ”€â”€ server.js\n```\n\n### **1. Express.jsã®æº–å‚™**\n\nã¾ãšã€`app/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã€ãã®ä¸­ã« `package.json` ã‚’ç”¨æ„ã—ã¾ã™ã€‚\n\n```json\n{\n  \"name\": \"docker-express\",\n  \"version\": \"1.0.0\",\n  \"main\": \"server.js\",\n  \"dependencies\": {\n    \"express\": \"^4.17.1\"\n  }\n}\n\n```\n\næ¬¡ã«ã€`server.js` ã‚’ä½œæˆã—ã¾ã™ã€‚\n\n```jsx\nconst express = require('express');\nconst app = express();\n\napp.get('/', (req, res) => {\n  res.send('Hello, World from Express.js!');\n});\n\napp.listen(3000, () => {\n  console.log('Server is running on port 3000');\n});\n\n```\n\n### **2. Express.jsã®Dockerfile**\n\næ¬¡ã«ã€`app/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã« `Dockerfile` ã‚’ä½œæˆã—ã¾ã™ã€‚\n\n```docker\nFROM node:14\nWORKDIR /app\nCOPY package.json ./\nRUN npm install\nCOPY . .\nCMD [\"node\", \"server.js\"]\nEXPOSE 3000\n\n```\n\n### **3. Nginxã®è¨­å®š**\n\nNginxã‚’ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã¨ã—ã¦å‹•ä½œã•ã›ã¾ã™ã€‚`nginx/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã€`default.conf` ã‚’è¿½åŠ ã—ã¾ã™ã€‚\n\n```\nserver {\n    listen 80;\n\n    location / {\n        proxy_pass http://app:3000;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n    }\n}\n```\n\n### **4. `docker-compose.yml` ã‚’ä½œæˆ**\n\næœ€å¾Œã« `docker-compose.yml` ã‚’ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä½œæˆã—ã¾ã™ã€‚\n\n```yaml\nversion: '3'\n\nservices:\n  app:\n    build: ./app\n    ports:\n      - \"3000:3000\"\n\n  web:\n    image: nginx\n    ports:\n      - \"80:80\"\n    volumes:\n      - ./nginx/default.conf:/etc/nginx/conf.d/default.conf\n    depends_on:\n      - app\n\n```\n\n### **5. ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•**\n\n```bash\ndocker-compose up -d\n```\n\n- `http://localhost` ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ `Hello, World from Express.js!` ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\n\n---\n\n## ã¾ã¨ã‚\n\nä»Šå›ã¯ **Docker Composeã®åŸºæœ¬** ã‹ã‚‰ **Nginx + Express.jsã®Webã‚¢ãƒ—ãƒª** ã‚’ä½œã‚‹ã¨ã“ã‚ã¾ã§è§£èª¬ã—ã¾ã—ãŸã€‚\n\n### **å­¦ã‚“ã ãƒã‚¤ãƒ³ãƒˆ**\n\nâœ… Docker Composeã®åŸºæœ¬çš„ãªã‚³ãƒãƒ³ãƒ‰\n\nâœ… `docker-compose.yml` ã®æ›¸ãæ–¹\n\nâœ… ã‚«ã‚¹ã‚¿ãƒ  `Dockerfile` ã®ä½œæˆ\n\nâœ… Nginxã¨Express.jsã®é€£æº\n\nDocker Composeã‚’ä½¿ãˆã°ã€ **è¤‡æ•°ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’ç°¡å˜ã«ç®¡ç†ã§ãã‚‹** ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ãœã²è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã­ã€‚ ğŸš€\n\n---\n","createdAt":"2025-05-19T08:50:58.441Z","updatedAt":"2025-06-06T00:01:42.686Z","publishedAt":"2025-06-06T00:01:42.698Z","docId":"y20328g93lc4hx15m7vjn3y4","tags":[{"id":2,"documentId":"zigqvzb0flgfexglvu0rhcai","createdAt":"2025-05-19T09:42:02.161Z","updatedAt":"2025-05-19T09:42:02.161Z","publishedAt":"2025-05-19T09:42:02.189Z","name":"Docker"}],"thumbnail":[{"id":27,"documentId":"w4z64z3qufa17y4cdia6jgyl","name":"20250513-23.png","alternativeText":null,"caption":null,"width":1503,"height":844,"formats":{"thumbnail":{"name":"thumbnail_20250513-23.png","hash":"thumbnail_20250513_23_99f792de40","ext":".png","mime":"image/png","path":null,"width":245,"height":138,"size":16.1,"sizeInBytes":16098,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/thumbnail_20250513_23_99f792de40.png"},"small":{"name":"small_20250513-23.png","hash":"small_20250513_23_99f792de40","ext":".png","mime":"image/png","path":null,"width":500,"height":281,"size":40.24,"sizeInBytes":40241,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/small_20250513_23_99f792de40.png"},"large":{"name":"large_20250513-23.png","hash":"large_20250513_23_99f792de40","ext":".png","mime":"image/png","path":null,"width":1000,"height":562,"size":92.78,"sizeInBytes":92775,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/large_20250513_23_99f792de40.png"},"medium":{"name":"medium_20250513-23.png","hash":"medium_20250513_23_99f792de40","ext":".png","mime":"image/png","path":null,"width":750,"height":421,"size":66.8,"sizeInBytes":66801,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_23_99f792de40.png"}},"hash":"20250513_23_99f792de40","ext":".png","mime":"image/png","size":24.66,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/20250513_23_99f792de40.png","previewUrl":null,"provider":"@strapi/provider-upload-aws-s3","provider_metadata":null,"createdAt":"2025-05-20T07:54:09.951Z","updatedAt":"2025-05-20T07:54:09.951Z","publishedAt":"2025-05-20T07:54:09.952Z"}]}},"__N_SSG":true}