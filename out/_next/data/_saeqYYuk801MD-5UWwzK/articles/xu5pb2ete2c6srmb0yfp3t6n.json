{"pageProps":{"article":{"id":251,"documentId":"xu5pb2ete2c6srmb0yfp3t6n","title":"AWSプロファイル切り替え","content":"AWS CLIを使用する際、複数のアカウントや環境を使い分けたい場合があります。例えば、開発環境や本番環境、もしくは異なるプロジェクトにおけるアクセスキーを使い分けたい時です。この記事では、AWS CLIでプロファイルを切り替える方法について、基本的な設定から具体的に使い分ける方法までを紹介します。\n\n---\n\n# 1. ローカルのAWSプロファイル設定\n\nまず、AWS CLIをインストールした後、初めて使用する際には`aws configure`コマンドでAWSの認証情報を設定します。このコマンドで設定されるプロファイルは、デフォルトで「`default`」という名前で保存されます。\n\n### コマンド例\n\n```bash\n$ aws configure\nAWS Access Key ID [None]: xxxxxxxxxx\nAWS Secret Access Key [None]: xxxxxxxxxx\nDefault region name [None]: ap-northeast-1\nDefault output format [None]: json\n```\n\nこの操作により、指定した認証情報が`~/.aws/credentials`ファイルに保存され、リージョン情報などが`~/.aws/config`ファイルに記録されます。\n\n### プロファイル確認\n\n設定内容は以下のようにファイルを直接確認できます。\n\n```bash\n$ cat ~/.aws/credentials\n[default]\naws_access_key_id = xxxxxxxxxx\naws_secret_access_key = xxxxxxxxxx\n```\n\n```bash\n$ cat ~/.aws/config\n[default]\nregion = ap-northeast-1\noutput = json\n```\n\n---\n\n# 2. 複数プロファイルの設定\n\n複数のAWSアカウントやプロジェクトにアクセスするためには、異なるプロファイルを設定する必要があります。これを実現するためには、`--profile`オプションを使用します。\n\n### プロファイル設定の例\n\n```bash\n$ aws configure --profile profile_name1\nAWS Access Key ID [None]: xxxxxxxxxx\nAWS Secret Access Key [None]: xxxxxxxxxx\nDefault region name [None]: ap-northeast-1\nDefault output format [None]: json\n```\n\n上記のコマンドでは、`profile_name1`という名前のプロファイルが設定されます。さらに別のプロファイルを追加したい場合は、同様に以下のコマンドを実行します。\n\n```bash\n$ aws configure --profile profile_name2\nAWS Access Key ID [None]: xxxxxxxxxx\nAWS Secret Access Key [None]: xxxxxxxxxx\nDefault region name [None]: ap-northeast-1\nDefault output format [None]: json\n```\n\nこれにより、複数のプロファイルが`~/.aws/credentials`ファイルに追加されます。\n\n---\n\n# 3. 複数プロファイルの使い分け方法\n\nAWS CLIで複数のプロファイルを設定した後、以下の2つの方法で使い分けることが可能です。\n\n## 方法1: コマンドに `-profile` オプションを付ける\n\n各コマンドに対して、使用したいプロファイルを`--profile`オプションで指定します。これにより、設定した特定のプロファイルを使用してコマンドを実行できます。\n\n```bash\n$ aws s3 ls --profile profile_name1\n```\n\nこの方法は、単一のコマンド実行時に特定のプロファイルを明示的に指定する場合に便利です。\n\n## 方法2: 環境変数を使用してプロファイルを切り替える\n\nもし、コマンドごとに`--profile`オプションを指定するのが手間だと感じる場合、環境変数`AWS_PROFILE`を設定することで、デフォルトプロファイルを一時的に変更できます。\n\n```bash\n$ export AWS_PROFILE=profile_name2\n$ aws s3 ls\n```\n\n環境変数を設定しておけば、同じシェルセッション内ではすべてのAWS CLIコマンドがそのプロファイルを使用するため、毎回`--profile`オプションを指定する必要がなくなります。\n\n---\n\n# まとめ\n\nAWS CLIを使って複数のプロファイルを使い分けることで、異なるプロジェクトや環境に簡単にアクセスできます。`--profile`オプションを使う方法と、環境変数を利用してプロファイルを切り替える方法は、それぞれの用途に応じて使い分けましょう。\n\nAWSを効果的に使いこなすためには、こうしたプロファイル管理のスキルが非常に重要です。日々の業務で複数のAWS環境を操作することが多い方は、ぜひ試してみてください。\n\n---\n\n","createdAt":"2025-05-19T08:50:57.104Z","updatedAt":"2025-06-05T23:50:59.605Z","publishedAt":"2025-06-05T23:50:59.617Z","docId":"qs7vzp8rkbzni7kjzlhgdpxa","tags":[{"id":10,"documentId":"cxt2tbnsy05cazm17p3pp1a3","createdAt":"2025-05-19T09:46:58.860Z","updatedAt":"2025-05-19T09:46:58.860Z","publishedAt":"2025-05-19T09:46:58.868Z","name":"AWS"},{"id":28,"documentId":"g250gp73dhyj31yn9639otwk","createdAt":"2025-05-19T09:50:38.186Z","updatedAt":"2025-05-19T09:50:38.186Z","publishedAt":"2025-05-19T09:50:38.193Z","name":"クラウド"}],"thumbnail":[{"id":7,"documentId":"wdpj294xz6ee0w6rmyik5b3m","name":"20250513-03.png","alternativeText":null,"caption":null,"width":1503,"height":844,"formats":{"thumbnail":{"name":"thumbnail_20250513-03.png","hash":"thumbnail_20250513_03_0767e419b3","ext":".png","mime":"image/png","path":null,"width":245,"height":138,"size":9.05,"sizeInBytes":9050,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/thumbnail_20250513_03_0767e419b3.png"},"medium":{"name":"medium_20250513-03.png","hash":"medium_20250513_03_0767e419b3","ext":".png","mime":"image/png","path":null,"width":750,"height":421,"size":34.72,"sizeInBytes":34721,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/medium_20250513_03_0767e419b3.png"},"large":{"name":"large_20250513-03.png","hash":"large_20250513_03_0767e419b3","ext":".png","mime":"image/png","path":null,"width":1000,"height":562,"size":49.29,"sizeInBytes":49287,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/large_20250513_03_0767e419b3.png"},"small":{"name":"small_20250513-03.png","hash":"small_20250513_03_0767e419b3","ext":".png","mime":"image/png","path":null,"width":500,"height":281,"size":21.04,"sizeInBytes":21038,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/small_20250513_03_0767e419b3.png"}},"hash":"20250513_03_0767e419b3","ext":".png","mime":"image/png","size":15.33,"url":"https://stg-raisex-tech-blog.s3.ap-northeast-1.amazonaws.com/20250513_03_0767e419b3.png","previewUrl":null,"provider":"@strapi/provider-upload-aws-s3","provider_metadata":null,"createdAt":"2025-05-20T07:41:18.247Z","updatedAt":"2025-05-20T07:41:18.247Z","publishedAt":"2025-05-20T07:41:18.247Z"}]}},"__N_SSG":true}